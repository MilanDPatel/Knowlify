{
    "topic": "demonstrates the Grover's algorithm for searching an unsorted database of $N",
    "code": [
        "from manim_imports_ext import *\n",
        "\n",
        "\n",
        "class GroverPreview(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Setup blocks\n",
        "        block_spacing = 1.0\n",
        "        blocks = Rectangle(12, 1).get_grid(12, 1, v_buff=block_spacing)\n",
        "        blocks.set_fill(GREY_D, 1)\n",
        "        blocks.set_stroke(BLUE, 1)\n",
        "        blocks.move_to(2.5 * UP, UP)\n",
        "\n",
        "        for block, tex, color in zip(blocks, it.cycle([\"U_k\", \"U_s\"]), it.cycle([BLUE, GREEN])):\n",
        "            label = Tex(tex)\n",
        "            label.set_color(color)\n",
        "            label.move_to(block)\n",
        "            block.set_stroke(color, 1)\n",
        "            block.add(label)\n",
        "\n",
        "        self.add(blocks)\n",
        "\n",
        "        # Wires\n",
        "        d = 100\n",
        "        wires = VGroup(\n",
        "            *Line(UP, DOWN).set_height(1).replicate(3),\n",
        "            Tex(R\"\\dots\"),\n",
        "            *Line(UP, DOWN).set_height(1).replicate(3),\n",
        "            Tex(R\"\\dots\"),\n",
        "            *Line(UP, DOWN).set_height(1).replicate(3),\n",
        "        )\n",
        "        wires.arrange(RIGHT)\n",
        "        wires.arrange_to_fit_width(11)\n",
        "        wires.next_to(blocks, UP, buff=0)\n",
        "        true_wires = VGroup(w for w in wires if isinstance(w, Line))\n",
        "        syms = [\"1\", \"2\", \"3\", \"k-1\", \"k\", \"k+1\", \"98\", \"99\", \"100\"]\n",
        "        kets = VGroup(Tex(Rf\"|{sym}\\rangle\") for sym in syms)\n",
        "        for ket, line in zip(kets, true_wires):\n",
        "            ket.set_height(0.35)\n",
        "            ket.next_to(line, UP)\n",
        "\n",
        "        key_index = 4\n",
        "        kets[key_index].set_color(YELLOW)\n",
        "\n",
        "        for block in blocks:\n",
        "            block.wires = wires.copy()\n",
        "            for wire in block.wires:\n",
        "                if isinstance(wire, Line):\n",
        "                    wire.set_height(block_spacing)\n",
        "            block.wires.next_to(block, DOWN, buff=0)\n",
        "            block.add(block.wires)\n",
        "\n",
        "        self.add(wires)\n",
        "        self.add(kets)\n",
        "\n",
        "        # Add numbers\n",
        "        amplitudes = VGroup(\n",
        "            DecimalNumber(0.1, font_size=24, include_sign=True, num_decimal_places=3).next_to(wire, LEFT, buff=0.1)\n",
        "            for wire in true_wires\n",
        "        )\n",
        "        amplitudes[key_index].set_color(YELLOW)\n",
        "\n",
        "        diag_axis = np.array([math.sqrt(0.99), 0.1, 0])\n",
        "        state_point = Point(diag_axis)\n",
        "\n",
        "        def get_new_amplitudes():\n",
        "            result = amplitudes.copy()\n",
        "            value = math.sqrt(state_point.get_x()**2 / (d - 1))\n",
        "            for dec in result:\n",
        "                dec.set_value(value)\n",
        "            result[key_index].set_value(state_point.get_y())\n",
        "            return result\n",
        "\n",
        "        self.add(amplitudes, state_point)\n",
        "\n",
        "        # Repeatedly cycle\n",
        "        curr_amplitudes = amplitudes\n",
        "        frame = self.frame\n",
        "        frame.set_y(1)\n",
        "\n",
        "        for block, axis in zip(blocks, it.cycle([RIGHT, diag_axis])):\n",
        "            state_point.flip(axis=axis, about_point=ORIGIN)\n",
        "            new_amplitudes = get_new_amplitudes()\n",
        "            new_amplitudes.match_y(block.wires)\n",
        "\n",
        "            self.play(\n",
        "                FadeOutToPoint(curr_amplitudes.copy(), block[0].get_center(), lag_ratio=0.0025, time_span=(0, 2)),\n",
        "                FadeInFromPoint(new_amplitudes, block[0].get_center(), lag_ratio=0.0025, time_span=(1, 3.0)),\n",
        "                frame.animate.set_y(min(block.wires.get_y() + 1, 1)),\n",
        "                run_time=3,\n",
        "            )\n",
        "\n",
        "            curr_amplitudes = new_amplitudes\n",
        "\n",
        "\n",
        "class ClassicalSearch(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        in_out = VGroup(ArrowTip(), ArrowTip(angle=PI))\n",
        "        in_out.arrange(RIGHT, buff=0.5)\n",
        "        in_out.set_shape(1.75, 0.75)\n",
        "        box = Square().set_shape(1.5, 1)\n",
        "        machine = Union(in_out, box)\n",
        "        machine.set_fill(GREY_E, 1).set_stroke(GREY_B, 2)\n",
        "        machine.set_z_index(1)\n",
        "        self.add(machine)\n",
        "\n",
        "        items = VGroup(Integer(n) for n in range(25))\n",
        "        items.arrange(DOWN, buff=0.5)\n",
        "        items.next_to(box, LEFT, LARGE_BUFF)\n",
        "        items.shift((box.get_y() - items[0].get_y()) * UP)\n",
        "\n",
        "        self.add(items)\n",
        "\n",
        "        # Loop through\n",
        "        key = 12\n",
        "        last_sym = VMobject()\n",
        "        for n in range(key + 1):\n",
        "            item = items[n]\n",
        "            self.play(\n",
        "                items.animate.shift((box.get_y() - item.get_y()) * UP),\n",
        "                FadeOut(last_sym)\n",
        "            )\n",
        "            sym = Checkmark().set_color(GREEN) if n == key else Exmark().set_color(RED)\n",
        "            sym.set_height(0.75)\n",
        "            sym.next_to(box, RIGHT, LARGE_BUFF)\n",
        "            self.play(\n",
        "                FadeOutToPoint(item.copy(), box.get_right(), time_span=(0, 0.7)),\n",
        "                FadeInFromPoint(sym, box.get_left(), time_span=(0.3, 1)),\n",
        "            )\n",
        "            last_sym = sym\n",
        "\n",
        "        rect = SurroundingRectangle(items[key])\n",
        "        rect.set_stroke(GREEN, 3)\n",
        "        self.play(\n",
        "            items[:n].animate.set_opacity(0.5),\n",
        "            ShowCreation(rect),\n",
        "            items[n + 1:].animate.set_opacity(0.5),\n",
        "        )\n"
    ]
}