{
    "topic": "demonstrates the concept of expected value, specifically the formula for it: E[X]",
    "code": [
        "\n",
        "from manim_imports_ext import *\n",
        "from _2018.eop.reusable_imports import *\n",
        "\n",
        "\n",
        "class IllustrateAreaModelExpectation(Scene):\n",
        "\n",
        "    def construct(self):\n",
        "\n",
        "        formula = OldTex(\"E[X] = \\sum_{i=1}^N p_i x_i\").move_to(3 * LEFT + UP)\n",
        "        self.play(Write(formula))\n",
        "\n",
        "\n",
        "        x_scale = 5.0\n",
        "        y_scale = 1.0\n",
        "\n",
        "        probabilities = np.array([1./8, 3./8, 3./8, 1./8])\n",
        "        prob_strings = [\"{1\\over 8}\",\"{3\\over 8}\",\"{3\\over 8}\",\"{1\\over 8}\"]\n",
        "        cumulative_probabilities = np.cumsum(probabilities)\n",
        "        cumulative_probabilities = np.insert(cumulative_probabilities, 0, 0)\n",
        "        y_values = np.array([0, 1, 2, 3])\n",
        "\n",
        "        hist = Histogram(probabilities, y_values,\n",
        "            mode = \"widths\",\n",
        "            x_scale = x_scale,\n",
        "            y_scale = y_scale,\n",
        "            x_labels = \"none\"\n",
        "        )\n",
        "\n",
        "        flat_hist = Histogram(probabilities, 0 * y_values,\n",
        "            mode = \"widths\",\n",
        "            x_scale = x_scale,\n",
        "            y_scale = y_scale,\n",
        "            x_labels = \"none\"\n",
        "        )\n",
        "\n",
        "        self.play(FadeIn(flat_hist))\n",
        "        self.play(\n",
        "            ReplacementTransform(flat_hist, hist)\n",
        "        )\n",
        "\n",
        "        braces = VGroup()\n",
        "        p_labels = VGroup()\n",
        "        # add x labels (braces)\n",
        "        for (p,string,bar) in zip(probabilities, prob_strings,hist.bars):\n",
        "            brace = Brace(bar, DOWN, buff = 0.1)\n",
        "            p_label = OldTex(string).next_to(brace, DOWN, buff = SMALL_BUFF).scale(0.7)\n",
        "            group = VGroup(brace, p_label)\n",
        "            braces.add(brace)\n",
        "            p_labels.add(p_label)\n",
        "            \n",
        "        self.play(\n",
        "            LaggedStartMap(FadeIn,braces),\n",
        "            LaggedStartMap(FadeIn, p_labels)\n",
        "        )\n",
        "\n",
        "\n",
        "\n",
        "        y_average = np.mean(y_values)\n",
        "        averaged_y_values = y_average * np.ones(np.shape(y_values))\n",
        "\n",
        "        averaged_hist = flat_hist = Histogram(probabilities, averaged_y_values,\n",
        "            mode = \"widths\",\n",
        "            x_scale = x_scale,\n",
        "            y_scale = y_scale,\n",
        "            x_labels = \"none\",\n",
        "            y_labels = \"none\"\n",
        "        ).fade(0.2)\n",
        "\n",
        "        ghost_hist = hist.copy().fade(0.8)\n",
        "        self.bring_to_back(ghost_hist)\n",
        "\n",
        "        self.play(Transform(hist, averaged_hist, run_time = 3))\n",
        "        self.wait()\n",
        "\n",
        "        average_brace = Brace(averaged_hist, RIGHT, buff = 0.1)\n",
        "        average_label = OldTex(str(y_average)).scale(0.7)\n",
        "        average_label.next_to(average_brace, RIGHT, SMALL_BUFF)\n",
        "        average_group = VGroup(average_brace, average_label)\n",
        "\n",
        "        one_brace = Brace(averaged_hist, DOWN, buff = 0.1)\n",
        "        one_p_label = OldTex(str(1)).next_to(one_brace, DOWN, buff = SMALL_BUFF).scale(0.7)\n",
        "        one_group = VGroup(one_brace, one_p_label)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(average_group),\n",
        "            Transform(braces, one_brace),\n",
        "            Transform(p_labels, one_p_label),\n",
        "        )\n",
        "        \n",
        "        rect = SurroundingRectangle(formula, buff = 0.5 * MED_LARGE_BUFF)\n",
        "        self.play(ShowCreation(rect))\n",
        "\n"
    ]
}