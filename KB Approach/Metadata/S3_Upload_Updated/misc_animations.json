{
    "topic": "The mathematical concept being demonstrated is the idea of submanifolds in a higher-dimensional space.",
    "code": [
        "from manim_imports_ext import *\n",
        "\n",
        "\n",
        "class WelchLabsIntroCard(InteractiveScene):\n",
        "    title_words = \"This is a guest video by Welch Labs\"\n",
        "    subtitle_words = \"\"\n",
        "    logo_file = \"WelchLabsLogo\"\n",
        "    banner_file = \"WelchLabsBanner\"\n",
        "    bottom_words = \"This is part of a series of guest videos, see the end for more details\"\n",
        "\n",
        "    def construct(self):\n",
        "        # Add title and banners\n",
        "        group = Group(\n",
        "            VGroup(\n",
        "                Text(self.title_words, font_size=48),\n",
        "                Text(self.subtitle_words, font_size=36, fill_color=GREY_A),\n",
        "            ).arrange(DOWN),\n",
        "            ImageMobject(self.banner_file).set_width(0.7 * FRAME_WIDTH),\n",
        "            Text(self.bottom_words, font_size=36),\n",
        "        )\n",
        "        group.arrange(DOWN, buff=MED_LARGE_BUFF)\n",
        "        group[2].scale(1.1, about_edge=DOWN)\n",
        "        group[-1].to_edge(DOWN, buff=MED_LARGE_BUFF)\n",
        "\n",
        "        self.play(LaggedStart(\n",
        "            Write(group[0], run_time=1, lag_ratio=5e-2),\n",
        "            FadeIn(group[1], scale=1.25),\n",
        "            FadeIn(group[2], lag_ratio=0.01),\n",
        "            lag_ratio=0.05\n",
        "        ))\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeOut, group, shift=1.0 * DOWN, lag_ratio=0.1)\n",
        "        )\n",
        "\n",
        "\n",
        "class Aleph0IntroCard(WelchLabsIntroCard):\n",
        "    name = \"Aleph 0\"\n",
        "    logo_file = \"Aleph0Logo\"\n",
        "    banner_file = \"Aleph0Banner\"\n",
        "    bottom_words = \"This is the 2nd of 5 of guest videos this summer while I'm on leave\"\n",
        "\n",
        "\n",
        "class VilasIntroCard(WelchLabsIntroCard):\n",
        "    title_words = \"This is a guest video by Vilas Winstein\"\n",
        "    subtitle_words = \"(a PhD candidate in probability at UC Berkeley)\"\n",
        "    banner_file = \"vilas_winstein\"\n",
        "    logo_file = \"SpectralCollectiveLogo\"\n",
        "    bottom_words = \"This is the 3rd of 5 of guest videos this summer while I am on leave\"\n",
        "\n",
        "\n",
        "class SubManifolds(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Set up spaces\n",
        "        blob = Circle(radius=1).stretch(2.4, 0, about_edge=LEFT)\n",
        "        blob.shift(0.5 * RIGHT)\n",
        "        blob.set_fill(BLUE, 0.5)\n",
        "        blob.set_stroke(BLUE, 1)\n",
        "        blobs = VGroup()\n",
        "        for angle in np.arange(0, TAU, TAU / 5):\n",
        "            new_blob = blob.copy()\n",
        "            new_blob.scale(random.uniform(0.5, 1), about_edge=LEFT)\n",
        "            new_blob.stretch(random.uniform(0.9, 1.3), 1)\n",
        "            new_blob.rotate(angle + random.uniform(-0.5, 0.5), about_point=ORIGIN)\n",
        "            new_blob.set_color(random_bright_color())\n",
        "            blobs.add(new_blob)\n",
        "\n",
        "        middle = Intersection(*blobs)\n",
        "        middle.match_style(blob)\n",
        "        middle.reverse_points()\n",
        "\n",
        "        big_circle = Circle(radius=3.8)\n",
        "        big_circle.stretch(1.5, 0)\n",
        "        big_circle.set_fill(TEAL, 0.2)\n",
        "        big_circle.set_stroke(TEAL, 1)\n",
        "\n",
        "        # Label all videos\n",
        "        all_videos_text = Text(\"Space of\\nall videos\")\n",
        "        all_videos_text.next_to(big_circle.pfp(0.1), UR, SMALL_BUFF)\n",
        "        self.add(all_videos_text)\n",
        "        self.add(big_circle)\n",
        "\n",
        "        # Show middle blob\n",
        "        prompt_words = TexText(R\"\"\"\n",
        "            Videos consistent with \\\\\n",
        "            ``An astronaut on the moon\\\\\n",
        "            riding a horse that turns\\\\\n",
        "            into a giant cat''\n",
        "        \"\"\", alignment=\"\", font_size=24)\n",
        "        prompt_words[len(\"Videos consistent with\".replace(\" \", \"\")):].set_color(BLUE_B)\n",
        "        prompt_words.next_to(big_circle.pfp(3 / 8), DR, SMALL_BUFF)\n",
        "        prompt_words.set_backstroke(BLACK, 5)\n",
        "        arrow = Arrow(prompt_words.get_right(), middle.get_top(), buff=0.1, path_arc=-60 * DEG)\n",
        "\n",
        "        self.play(LaggedStart(\n",
        "            FadeIn(prompt_words, lag_ratio=0.1),\n",
        "            Write(arrow),\n",
        "            TransformFromCopy(big_circle, middle, run_time=2),\n",
        "        ))\n",
        "        self.wait()\n",
        "\n",
        "        # No training data here\n",
        "        no_training_words = Text(\"No training\\ndata here\", font_size=24)\n",
        "        no_training_words.next_to(middle, RIGHT, SMALL_BUFF)\n",
        "        no_training_words.set_z_index(1)\n",
        "        no_training_words.set_backstroke(BLACK, 2)\n",
        "\n",
        "        def get_training_data_examples(n_samples, min_scale=0.2):\n",
        "            training_data = DotCloud(np.array([\n",
        "                big_circle.pfp(random.random()) * random.uniform(min_scale, 1)\n",
        "                for n in range(n_samples)\n",
        "            ]))\n",
        "            training_data.set_radius(0.04)\n",
        "            training_data.make_3d()\n",
        "            training_data.set_z_index(-1)\n",
        "            return training_data\n",
        "\n",
        "        training_data = get_training_data_examples(100)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(training_data, run_time=3),\n",
        "            Write(no_training_words, run_time=1),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show other blobs\n",
        "        blobs.set_fill(opacity=0.25)\n",
        "        more_data = get_training_data_examples(1000)\n",
        "\n",
        "        blob_words = VGroup(\n",
        "            Text(word, font_size=24) for word in [\n",
        "                \"cats\",\n",
        "                \"horses\",\n",
        "                \"astronauts\",\n",
        "                \"transformation\",\n",
        "                \"on the\\nmoon\",\n",
        "            ]\n",
        "        )\n",
        "        for word, blob in zip(blob_words, blobs):\n",
        "            word.move_to(blob.get_center() * 1.5)\n",
        "        blob_words.set_backstroke(BLACK, 2)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(more_data, run_time=6),\n",
        "            LaggedStartMap(Write, blobs),\n",
        "            LaggedStartMap(FadeIn, blob_words),\n",
        "            no_training_words.animate.scale(0.5).move_to(middle).set_backstroke(BLACK, 0).set_fill(BLACK),\n",
        "            prompt_words.animate.set_backstroke(BLACK, 10),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ComposingFeatures(InteractiveScene):\n",
        "    def construct(self):\n",
        "        pass\n",
        "\n",
        "\n",
        "class IMOGoldOrganizations(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        orgs = VGroup(\n",
        "            Text(\"Google DeepMind\"),\n",
        "            Text(\"OpenAI\"),\n",
        "            Text(\"Harmonic\"),\n",
        "            Text(\"ByteDance\"),\n",
        "        )\n",
        "        orgs.scale(1.5)\n",
        "        orgs.arrange(DOWN, buff=LARGE_BUFF, aligned_edge=LEFT)\n",
        "        orgs.to_edge(LEFT, buff=1)\n",
        "        top_brace = Brace(orgs[:2], RIGHT)\n",
        "        low_brace = Brace(orgs[2:], RIGHT)\n",
        "        top_text = top_brace.get_text(\"Natural language\", buff=0.5).set_color(BLUE_A)\n",
        "        low_text = low_brace.get_text(\"Lean\", buff=0.5).set_color(YELLOW_B)\n",
        "\n",
        "        self.play(LaggedStartMap(FadeIn, orgs, shift=DOWN, lag_ratio=0.15))\n",
        "        self.wait()\n",
        "        self.play(LaggedStart(\n",
        "            GrowFromCenter(top_brace),\n",
        "            FadeIn(top_text, RIGHT),\n",
        "            orgs[:2].animate.match_color(top_text),\n",
        "            GrowFromCenter(low_brace),\n",
        "            FadeIn(low_text, RIGHT),\n",
        "            orgs[2:].animate.match_color(low_text),\n",
        "        ))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class AlephGeometryEndScreen(PatreonEndScreen):\n",
        "    pass\n",
        "\n",
        "\n",
        "class PhaseChangeEndScreen(PatreonEndScreen):\n",
        "    def construct(self):\n",
        "        # Attribution\n",
        "        # background_color = interpolate_color(\"#FDF6E3\", BLACK, 0)\n",
        "        background_color = BLACK\n",
        "        text_color = WHITE\n",
        "\n",
        "        background_rect = FullScreenRectangle(fill_color=background_color)\n",
        "        background_rect.set_z_index(-2)\n",
        "        self.add(background_rect)\n",
        "\n",
        "        elements = VGroup(\n",
        "            ScreenRectangle(height=3),\n",
        "            Circle(radius=1),\n",
        "        )\n",
        "        elements.arrange(RIGHT, buff=0.5)\n",
        "        elements.set_width(6.5)\n",
        "        elements.to_edge(RIGHT, buff=1.0)\n",
        "        elements.set_y(1)\n",
        "        elements.set_stroke(text_color, 1)\n",
        "        # elements.insert_n_curves(100)\n",
        "\n",
        "        attribution = Text(\"This guest video was\\nproduced by Vilas Winstein\", font_size=48, fill_color=text_color)\n",
        "        watch = Text(\"Watch part 2 now on Spectral Collective\", font_size=36).set_fill(text_color, 0.95)\n",
        "        attribution.next_to(elements, DOWN, buff=MED_LARGE_BUFF)\n",
        "        watch.next_to(elements, UP, buff=MED_SMALL_BUFF)\n",
        "\n",
        "        self.add(elements, attribution, watch)\n",
        "\n",
        "        # Patron scroll\n",
        "        v_line = Line(DOWN, UP).set_height(FRAME_HEIGHT)\n",
        "        v_line.next_to(elements, LEFT, LARGE_BUFF)\n",
        "        v_line.set_y(0)\n",
        "        v_line.set_stroke(text_color, 1)\n",
        "\n",
        "        thanks = Text(\n",
        "            \"This channel is funded via Patreon\\nSpecial thanks to these supporters\",\n",
        "            alignment=\"LEFT\",\n",
        "            font_size=32,\n",
        "            fill_color=text_color\n",
        "        )\n",
        "        thanks.move_to(midpoint(v_line.get_center(), LEFT_SIDE))\n",
        "        thanks.to_edge(UP)\n",
        "\n",
        "        solid_rect = Square(side_length=8)\n",
        "        solid_rect.set_fill(background_color, 1).set_stroke(text_color, 1)\n",
        "        solid_rect.next_to(v_line, LEFT, 0)\n",
        "        solid_rect.align_to(thanks, DOWN).shift(MED_SMALL_BUFF * DOWN)\n",
        "\n",
        "        names = VGroup(map(Text, self.get_names()))\n",
        "        names.scale(0.5)\n",
        "        for name in names:\n",
        "            name.set_width(min(name.get_width(), 2.0))\n",
        "        names.set_fill(text_color)\n",
        "        names.arrange_in_grid(n_cols=2, aligned_edge=LEFT)\n",
        "        names.next_to(solid_rect, DOWN, buff=7).to_edge(LEFT)\n",
        "        names.set_z_index(-1)\n",
        "\n",
        "        self.add(solid_rect)\n",
        "        self.add(v_line)\n",
        "        self.add(thanks)\n",
        "        self.add(names)\n",
        "        self.play(\n",
        "            names.animate.to_edge(DOWN, buff=1.5).set_anim_args(run_time=25, rate_func=linear),\n",
        "            LaggedStartMap(\n",
        "                VShowPassingFlash,\n",
        "                elements.copy().set_stroke(WHITE, 5).insert_n_curves(1000),\n",
        "                time_width=2,\n",
        "                run_time=3\n",
        "            ),\n",
        "            FadeIn(elements, time_span=(1, 2))\n",
        "        )\n",
        "\n",
        "\n",
        "class EuclidEndScreen(SideScrollEndScreen):\n",
        "    scroll_time = 30\n",
        "\n",
        "\n",
        "class SeriesOfFiveVideos(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Add images\n",
        "        self.add(FullScreenRectangle(fill_color=GREY_E))\n",
        "\n",
        "        pure_images = Group(\n",
        "            ImageMobject(filename)\n",
        "            for filename in [\n",
        "                \"diffusion_TN\",\n",
        "                \"alpha_geometry_TN\",\n",
        "                \"phase_change_TN\",\n",
        "                \"incomplete_cubes_TN\",\n",
        "                \"euclid_TN\",\n",
        "            ]\n",
        "        )\n",
        "        borders = VGroup(SurroundingRectangle(image, buff=0) for image in pure_images)\n",
        "        borders.set_stroke(WHITE, 3)\n",
        "\n",
        "        images = Group(\n",
        "            Group(border, image)\n",
        "            for border, image in zip(borders, pure_images)\n",
        "        )\n",
        "\n",
        "        images.set_width(4)\n",
        "        images.arrange_in_grid(n_cols=3, buff=1)\n",
        "        images[3:].match_x(images[:3]).shift(MED_LARGE_BUFF * DOWN)\n",
        "        images.set_width(FRAME_WIDTH - 1)\n",
        "\n",
        "        # Add names\n",
        "        names = VGroup(\n",
        "            Text(f\"Guest video by {text}\", font_size=30)\n",
        "            for text in [\n",
        "                \"Welch Labs\",\n",
        "                \"Aleph0\",\n",
        "                \"Vilas Winstein\",\n",
        "                \"Paul Dancstep\",\n",
        "                \"Ben Syversen\",\n",
        "            ]\n",
        "        )\n",
        "        for name, image in zip(names, images):\n",
        "            name.next_to(image, UP, MED_SMALL_BUFF)\n",
        "            image.add(name)\n",
        "\n",
        "        # Animate in\n",
        "        frame = self.frame\n",
        "        frame.set_height(4).move_to(images[-1])\n",
        "        self.add(images[-1])\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            frame.animate.to_default_state(),\n",
        "            LaggedStartMap(FadeIn, images[3::-1], lag_ratio=0.25),\n",
        "            run_time=3,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Swap out for topics\n",
        "        titles = VGroup(\n",
        "            Text(\"Diffusion models\"),\n",
        "            Text(\"AlphaGeometry\"),\n",
        "            Text(\"Statistical Mechanics\"),\n",
        "            Text(\"Group theory\"),\n",
        "            Text(\"Euclid\"),\n",
        "        )\n",
        "        titles.scale(0.8)\n",
        "        for title, name, image in zip(titles, names, images):\n",
        "            title.move_to(name, DOWN)\n",
        "            self.play(\n",
        "                LaggedStart(FadeIn(title, 0.25 * UP), FadeOut(name, 0.25 * UP), lag_ratio=0.2),\n",
        "                pure_images.animate.set_opacity(0.25),\n",
        "                borders.animate.set_stroke(opacity=0.25),\n",
        "            )\n",
        "        self.wait()"
    ]
}