{
    "topic": "demonstrates the concept of a quiz with multiple-choice questions, where students are asked",
    "code": [
        "from manim_imports_ext import *\n",
        "from _2018.eop.reusable_imports import *\n",
        "from _2018.eop.independence import *\n",
        "\n",
        "class QuizResult(PiCreatureScene):\n",
        "    CONFIG = {\n",
        "        \"pi_creatures_start_on_screen\" : False,\n",
        "        \"random_seed\" : 0\n",
        "    }\n",
        "    def construct(self):\n",
        "\n",
        "\n",
        "        def get_example_quiz():\n",
        "            quiz = get_quiz(\n",
        "                \"Define ``Brachistochrone'' \",\n",
        "                \"Define ``Tautochrone'' \",\n",
        "                \"Define ``Cycloid'' \",\n",
        "            )\n",
        "            rect = SurroundingRectangle(quiz, buff = 0)\n",
        "            rect.set_fill(color = BLACK, opacity = 1)\n",
        "            rect.set_stroke(width = 0)\n",
        "            quiz.add_to_back(rect)\n",
        "            return quiz\n",
        "\n",
        "\n",
        "        highlight_color = WHITE\n",
        "\n",
        "        nb_students_x = 5\n",
        "        nb_students_y = 3\n",
        "        spacing_students_x = 2.0\n",
        "        spacing_students_y = 2.2\n",
        "\n",
        "        all_students = PiCreatureClass(\n",
        "            width = nb_students_x, height = nb_students_y)# Defunct()\n",
        "        student_points = []\n",
        "        grades = []\n",
        "        grades_count = []\n",
        "        hist_y_values = np.zeros(4)\n",
        "        for i in range(nb_students_x):\n",
        "            for j in range(nb_students_y):\n",
        "                x = i * spacing_students_x\n",
        "                y = j * spacing_students_y\n",
        "                #pi = PiCreature().scale(0.3)\n",
        "                #pi.move_to([x,y,0])\n",
        "                #all_students.add(pi)\n",
        "                all_students[i*nb_students_y + j].move_to([x,y,0])\n",
        "                q1 = np.random.choice([True, False])\n",
        "                q2 = np.random.choice([True, False])\n",
        "                q3 = np.random.choice([True, False])\n",
        "                student_points.append([q1, q2, q3])\n",
        "                grade = q1*1+q2*1+q3*1\n",
        "                grades.append(grade)\n",
        "                hist_y_values[grade] += 1\n",
        "                # How many times has this grade already occured?\n",
        "                grade_count = grades.count(grade)\n",
        "                grades_count.append(grade_count)\n",
        "\n",
        "\n",
        "        all_students.move_to(ORIGIN)\n",
        "        self.pi_creatures = all_students\n",
        "        self.play(FadeIn(all_students))\n",
        "\n",
        "        all_quizzes = VGroup()\n",
        "\n",
        "        quiz = get_example_quiz().scale(0.2)\n",
        "        for pi in all_students:\n",
        "            quiz_copy = quiz.copy()\n",
        "            quiz_copy.next_to(pi, UP)\n",
        "            all_quizzes.add(quiz_copy)\n",
        "\n",
        "        master_quiz = get_example_quiz()\n",
        "        self.play(Write(master_quiz), run_time = 2)\n",
        "        self.wait()\n",
        "        self.play(ReplacementTransform(\n",
        "            VGroup(master_quiz), all_quizzes,\n",
        "            run_time=2,\n",
        "            lag_ratio=0.5\n",
        "        ))\n",
        "        self.wait(2)\n",
        "\n",
        "        grades_mob = VGroup()\n",
        "        for (pi, quiz, grade) in zip(all_students, all_quizzes, grades):\n",
        "            grade_mob = OldTex(str(grade) + \"/3\")\n",
        "            grade_mob.move_to(quiz)\n",
        "            grades_mob.add(grade_mob)\n",
        "\n",
        "        self.remove(master_quiz)\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(all_quizzes),\n",
        "            FadeIn(grades_mob)\n",
        "        )\n",
        "\n",
        "        # self.play(\n",
        "        #     all_students[2:].fade, 0.8,\n",
        "        #     grades_mob[2:].fade, 0.8\n",
        "        # )\n",
        "\n",
        "        students_points_mob = VGroup()\n",
        "        for (pi, quiz, points) in zip(all_students, all_quizzes, student_points):\n",
        "            slot = get_slot_group(points, include_qs = False)\n",
        "            slot.scale(0.5).move_to(quiz)\n",
        "            students_points_mob.add(slot)\n",
        "\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            #all_students.fade, 0,\n",
        "            FadeOut(grades_mob),\n",
        "            FadeIn(students_points_mob)\n",
        "        )\n",
        "\n",
        "        all_students.save_state()\n",
        "        students_points_mob.save_state()\n",
        "        self.wait()\n",
        "        randy = all_students[0]\n",
        "        morty = all_students[nb_students_y]\n",
        "        all_other_students = VGroup(*all_students)\n",
        "        all_other_students.remove(randy, morty)\n",
        "        randy_points = students_points_mob[0]\n",
        "        morty_points = students_points_mob[nb_students_y]\n",
        "        all_other_points = VGroup(*students_points_mob)\n",
        "        all_other_points.remove(randy_points, morty_points)\n",
        "        self.play(\n",
        "            all_other_students.fade, 0.8,\n",
        "            all_other_points.fade, 0.8,\n",
        "        )\n",
        "        self.wait()\n",
        "        scale = 1.5\n",
        "        self.play(randy_points.scale,scale)\n",
        "        self.play(randy_points.scale,1.0/scale, morty_points.scale,scale)\n",
        "        self.play(morty_points.scale,1.0/scale)\n",
        "\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            all_students.restore,\n",
        "            students_points_mob.restore,\n",
        "        )\n",
        "\n",
        "        self.wait()\n",
        "        anims = []\n",
        "        for points in students_points_mob:\n",
        "            anims.append(points.scale)\n",
        "            anims.append(scale)\n",
        "        self.play(*anims)\n",
        "\n",
        "        self.wait()\n",
        "        anims = []\n",
        "        for points in students_points_mob:\n",
        "            anims.append(points.scale)\n",
        "            anims.append(1.0/scale)\n",
        "        self.play(*anims)\n",
        "\n",
        "        anims = []\n",
        "        anchor_point = 3 * DOWN + 1 * LEFT\n",
        "        for (pi, grade, grades_count) in zip(all_students, grades, grades_count):\n",
        "            anims.append(pi.move_to)\n",
        "            anims.append(anchor_point + grade * RIGHT + grades_count * UP)\n",
        "        anims.append(FadeOut(students_points_mob))\n",
        "\n",
        "        self.wait()\n",
        "        self.play(*anims)\n",
        "\n",
        "        grade_labels = VGroup()\n",
        "        for i in range(4):\n",
        "            grade_label = Integer(i, color = highlight_color)\n",
        "            grade_label.move_to(i * RIGHT)\n",
        "            grade_labels.add(grade_label)\n",
        "        grade_labels.next_to(all_students, DOWN)\n",
        "        out_of_label = OldTexText(\"out of 3\", color = highlight_color)\n",
        "        out_of_label.next_to(grade_labels, RIGHT, buff = MED_LARGE_BUFF)\n",
        "        grade_labels.add(out_of_label)\n",
        "        self.wait()\n",
        "        self.play(Write(grade_labels))\n",
        "\n",
        "        grade_hist = Histogram(\n",
        "            np.ones(4),\n",
        "            hist_y_values,\n",
        "            mode = \"widths\",\n",
        "            x_labels = \"none\",\n",
        "            y_label_position = \"center\",\n",
        "            bar_stroke_width = 0,\n",
        "            outline_stroke_width = 5\n",
        "        )\n",
        "        grade_hist.move_to(all_students)\n",
        "\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(grade_hist),\n",
        "            FadeOut(all_students)\n",
        "        )\n",
        "\n",
        "\n",
        "        nb_students_label = OldTexText(\"\\# of students\", color = highlight_color)\n",
        "        nb_students_label.move_to(5 * RIGHT + 1 * UP)\n",
        "        arrows = VGroup(*[\n",
        "            Arrow(nb_students_label.get_left(), grade_hist.bars[i].get_center(),\n",
        "                color = highlight_color)\n",
        "            for i in range(4)\n",
        "        ])\n",
        "        self.wait()\n",
        "        self.play(Write(nb_students_label), LaggedStartMap(GrowArrow,arrows))\n",
        "\n",
        "        percentage_label = OldTexText(\"\\% of students\", color = highlight_color)\n",
        "        percentage_label.move_to(nb_students_label)\n",
        "        percentages = hist_y_values / (nb_students_x * nb_students_y) * 100\n",
        "        anims = []\n",
        "        for (label, percentage) in zip(grade_hist.y_labels_group, percentages):\n",
        "            new_label = DecimalNumber(percentage,\n",
        "                num_decimal_places = 1,\n",
        "                unit = \"\\%\",\n",
        "                color = highlight_color\n",
        "            )\n",
        "            new_label.scale(0.7)\n",
        "            new_label.move_to(label)\n",
        "            anims.append(Transform(label, new_label))\n",
        "        anims.append(ReplacementTransform(nb_students_label, percentage_label))\n",
        "        self.wait()\n",
        "        self.play(*anims)\n",
        "\n",
        "        self.remove(all_quizzes)\n",
        "        # put small copy of class in corner\n",
        "        for (i,pi) in enumerate(all_students):\n",
        "            x = i % 5\n",
        "            y = i / 5\n",
        "            pi.move_to(x * RIGHT + y * UP)\n",
        "        all_students.scale(0.8)\n",
        "        all_students.to_corner(DOWN + LEFT)\n",
        "        self.wait()\n",
        "        self.play(FadeIn(all_students))\n",
        "\n",
        "        prob_label = OldTexText(\"probability\", color = highlight_color)\n",
        "        prob_label.move_to(percentage_label)\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            all_students[8].set_color, MAROON_E,\n",
        "            #all_students[:8].fade, 0.6,\n",
        "            #all_students[9:].fade, 0.6,\n",
        "            ReplacementTransform(percentage_label, prob_label)\n",
        "        )\n",
        "\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(prob_label),\n",
        "            FadeOut(arrows)\n",
        "        )\n",
        "\n",
        "        flash_hist = FlashThroughHistogram(\n",
        "                    grade_hist,\n",
        "                    direction = \"vertical\",\n",
        "                    mode = \"random\",\n",
        "                    cell_opacity = 0.5,\n",
        "                    run_time = 5,\n",
        "                    rate_func = linear\n",
        "                )\n",
        "\n",
        "        flash_class = FlashThroughClass(\n",
        "                    all_students,\n",
        "                    mode = \"random\",\n",
        "                    highlight_color = MAROON_E,\n",
        "                    run_time = 5,\n",
        "                    rate_func = linear\n",
        "                )\n",
        "\n",
        "        self.wait()\n",
        "        for i in range(3):\n",
        "            self.play(flash_hist, flash_class)\n",
        "            self.remove(flash_hist.prototype_cell)\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n"
    ]
}