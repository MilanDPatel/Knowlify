{
    "topic": "The mathematical concept being demonstrated is the visualization of a sequence of coins with different colors and symbols",
    "code": [
        "\n",
        "from mobject.geometry import *\n",
        "from mobject.svg.tex_mobject import *\n",
        "from utils.color import *\n",
        "\n",
        "from _2018.eop.reusables.eop_helpers import *\n",
        "from _2018.eop.reusables.eop_constants import *\n",
        "\n",
        "class UprightCoin(Circle):\n",
        "# For use in coin sequences\n",
        "    CONFIG = {\n",
        "        \"radius\": COIN_RADIUS,\n",
        "        \"stroke_width\": COIN_STROKE_WIDTH,\n",
        "        \"stroke_color\": WHITE,\n",
        "        \"fill_opacity\": 1,\n",
        "        \"symbol\": \"\\euro\"\n",
        "    }\n",
        "\n",
        "    def __init__(self, **kwargs):\n",
        "        Circle.__init__(self,**kwargs)\n",
        "        self.symbol_mob = OldTexText(self.symbol, stroke_color = self.stroke_color)\n",
        "        self.symbol_mob.set_height(0.5*self.get_height()).move_to(self)\n",
        "        self.add(self.symbol_mob)\n",
        "\n",
        "class UprightHeads(UprightCoin):\n",
        "    CONFIG = {\n",
        "        \"fill_color\": COLOR_HEADS_COIN,\n",
        "        \"symbol\": \"H\",\n",
        "    }\n",
        "\n",
        "class UprightTails(UprightCoin):\n",
        "    CONFIG = {\n",
        "        \"fill_color\": COLOR_TAILS_COIN,\n",
        "        \"symbol\": \"T\",\n",
        "    }\n",
        "\n",
        "class CoinSequence(VGroup):\n",
        "    CONFIG = {\n",
        "        \"sequence\": [],\n",
        "        \"radius\" : COIN_RADIUS,\n",
        "        \"spacing\": COIN_SEQUENCE_SPACING,\n",
        "        \"direction\": RIGHT\n",
        "    }\n",
        "\n",
        "    def __init__(self, sequence, **kwargs):\n",
        "        VGroup.__init__(self, **kwargs)\n",
        "        self.sequence = sequence\n",
        "        offset = 0\n",
        "        for symbol in self.sequence:\n",
        "            if symbol == \"H\":\n",
        "                new_coin = UprightHeads(radius = self.radius)\n",
        "            elif symbol == \"T\":\n",
        "                new_coin = UprightTails(radius = self.radius)\n",
        "            else:\n",
        "                new_coin = UprightCoin(symbol = symbol, radius = self.radius)\n",
        "            new_coin.shift(offset * self.direction)\n",
        "            self.add(new_coin)\n",
        "            offset += self.spacing\n",
        "\n",
        "\n",
        "class FlatCoin(UprightCoin):\n",
        "# For use in coin stacks\n",
        "    CONFIG = {\n",
        "        \"thickness\": COIN_THICKNESS,\n",
        "        \"foreshortening\": COIN_FORESHORTENING,\n",
        "        \"nb_ridges\": COIN_NB_RIDGES\n",
        "    }\n",
        "\n",
        "    def __init__(self, **kwargs):\n",
        "        UprightCoin.__init__(self, **kwargs)\n",
        "        self.symbol_mob.rotate(TAU/8)\n",
        "        self.stretch_in_place(self.foreshortening, 1)\n",
        "        \n",
        "        # draw the edge\n",
        "        control_points1 = self.get_points()[12:25].tolist()\n",
        "        control_points2 = self.copy().shift(self.thickness * DOWN).get_points()[12:25].tolist()\n",
        "        edge_anchors_and_handles = control_points1\n",
        "        edge_anchors_and_handles.append(edge_anchors_and_handles[-1] + self.thickness * DOWN)\n",
        "        edge_anchors_and_handles.append(edge_anchors_and_handles[-1] + self.thickness * UP)\n",
        "        edge_anchors_and_handles += control_points2[::-1] # list concatenation\n",
        "        edge_anchors_and_handles.append(edge_anchors_and_handles[-1] + self.thickness * UP)\n",
        "        edge_anchors_and_handles.append(edge_anchors_and_handles[-1] + self.thickness * DOWN)\n",
        "        edge_anchors_and_handles.append(control_points1[0])\n",
        "        #edge_anchors_and_handles = edge_anchors_and_handles[::-1]\n",
        "        edge = VMobject()\n",
        "        edge.set_points(edge_anchors_and_handles)\n",
        "        edge.set_fill(\n",
        "            color = self.fill_color,\n",
        "            opacity = self.fill_opacity\n",
        "        )\n",
        "        edge.set_stroke(width = self.stroke_width)\n",
        "        self.add(edge)\n",
        "\n",
        "        # draw the ridges\n",
        "        PI = TAU/2\n",
        "        dtheta = PI/self.nb_ridges\n",
        "        ridge_angles = np.arange(dtheta,PI,dtheta)\n",
        "        # add a twist onto each coin\n",
        "        ridge_angles += np.random.rand(1) * dtheta\n",
        "        # crop the angles that overshoot on either side\n",
        "        ridge_angles = ridge_angles[(ridge_angles > 0) * (ridge_angles < PI)]\n",
        "        ridge_positions = 0.5 * 2 * self.radius * np.array([\n",
        "            np.cos(theta) for theta in ridge_angles\n",
        "        ])\n",
        "        ridge_color = interpolate_color(self.stroke_color, self.fill_color, 0.7)\n",
        "        for x in ridge_positions:\n",
        "            y = -(1 - (x/self.radius)**2)**0.5 * self.foreshortening * self.radius\n",
        "            ridge = Line(\n",
        "                x * RIGHT + y * UP,\n",
        "                x * RIGHT + y * UP + self.thickness * DOWN,\n",
        "                stroke_color = ridge_color,\n",
        "                stroke_width = self.stroke_width\n",
        "            )\n",
        "            self.add(ridge)\n",
        "\n",
        "        # redraw the unfilled edge to cover the ridge ends\n",
        "        empty_edge = edge.copy()\n",
        "        empty_edge.set_fill(opacity = 0)\n",
        "        self.add(empty_edge)\n",
        "\n",
        "class FlatHeads(FlatCoin):\n",
        "    CONFIG = {\n",
        "        \"fill_color\": COLOR_HEADS_COIN,\n",
        "        \"symbol\": \"H\",\n",
        "    }\n",
        "    \n",
        "class FlatTails(FlatCoin):\n",
        "    CONFIG = {\n",
        "        \"fill_color\": COLOR_TAILS_COIN,\n",
        "        \"symbol\": \"T\",\n",
        "    }\n",
        "    "
    ]
}