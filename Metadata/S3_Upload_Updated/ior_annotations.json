{
    "topic": "demonstrates the concept of a \"hold-up\" animation, where an object is",
    "code": [
        "from manim_imports_ext import *\n",
        "\n",
        "\n",
        "\n",
        "EQUATION_T2C = {\n",
        "    R\"\\vec{\\textbf{x}}(t)\": RED,\n",
        "    R\"\\vec{\\textbf{F}}(t)\": YELLOW,\n",
        "    R\"\\vec{\\textbf{a}}(t)\": YELLOW,\n",
        "    R\"\\frac{d^2 \\vec{\\textbf{x}}}{dt^2}(t) \": YELLOW,\n",
        "    R\"\\vec{\\textbf{E}}_0\": BLUE,\n",
        "    R\"\\omega_r\": PINK,\n",
        "    R\"\\omega_l\": TEAL,\n",
        "}\n",
        "\n",
        "def get_bordered_thumbnail(path, height=3, stroke_width=3):\n",
        "    image = ImageMobject(path)\n",
        "    thumbnail = Group(\n",
        "        SurroundingRectangle(image, buff=0).set_stroke(WHITE, stroke_width),\n",
        "        image,\n",
        "    )\n",
        "    thumbnail.set_height(height)\n",
        "    return thumbnail\n",
        "\n",
        "\n",
        "class HoldUpAlbumCover(TeacherStudentsScene):\n",
        "    background_color = interpolate_color(GREY_E, BLACK, 0.5)\n",
        "\n",
        "    def construct(self):\n",
        "        # Album\n",
        "        album = ImageMobject(\"Dark-side-of-the-moon\")\n",
        "        album.set_height(3.5)\n",
        "        album.move_to(self.hold_up_spot, DOWN)\n",
        "\n",
        "        self.play(\n",
        "            self.teacher.change(\"raise_right_hand\", album),\n",
        "            self.change_students(\"hooray\", \"coin_flip_2\", \"tease\", look_at=album)\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(album),\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        # Enlarge album\n",
        "        full_rect = FullScreenRectangle()\n",
        "        full_rect.set_fill(BLACK, 1)\n",
        "        prism_image = ImageMobject(\"True-prism\")\n",
        "        true_prism = Group(\n",
        "            SurroundingRectangle(prism_image, buff=0).set_stroke(WHITE, 10),\n",
        "            prism_image\n",
        "        )\n",
        "\n",
        "        album.save_state()\n",
        "        album.target = album.generate_target()\n",
        "        album.target.set_height(5.5)\n",
        "        album.target.next_to(ORIGIN, RIGHT, buff=0.5)\n",
        "        true_prism.match_height(album.target).scale(0.98)\n",
        "        true_prism.next_to(ORIGIN, LEFT, buff=0.5)\n",
        "\n",
        "        titles = VGroup(\n",
        "            Text(\"Genuine simulation\"),\n",
        "            Text(\"Pink Floyd\"),\n",
        "        )\n",
        "        for title, mob in zip(titles, [true_prism, album.target]):\n",
        "            title.move_to(mob)\n",
        "            title.to_edge(UP, buff=0.5)\n",
        "\n",
        "\n",
        "        self.add(full_rect, album, true_prism)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(full_rect),\n",
        "            MoveToTarget(album),\n",
        "            FadeInFromPoint(true_prism, album.get_center()),\n",
        "            run_time=2,\n",
        "        )\n",
        "        self.remove(self.pi_creatures)\n",
        "        self.play(FadeIn(titles))\n",
        "        self.wait()\n",
        "\n",
        "        # Why is this white\n",
        "        white_point = np.array([3.25, 0.62, 0])\n",
        "        red_arrow = Arrow(white_point + UL, white_point, buff=0.1, stroke_width=7)\n",
        "        red_arrow.set_color(RED)\n",
        "        why_white = Text(\"Why is this white?!\")\n",
        "        why_white.next_to(red_arrow, UP, SMALL_BUFF)\n",
        "        why_white.match_x(album)\n",
        "        why_white.set_color(RED)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(why_white, lag_ratio=0.1),\n",
        "            GrowArrow(red_arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Discrete\n",
        "        roygbiv = Text(\"ROYGBV\")\n",
        "        roygbiv.rotate(-10 * DEGREES)\n",
        "        roygbiv.move_to(white_point).shift(1.5 * RIGHT + 0.25 * UP)\n",
        "        rainbow = VGroup(*(\n",
        "            Arc(PI, -PI, radius=radius, stroke_width=10)\n",
        "            for radius in np.linspace(1.5, 2.0, 6)\n",
        "        ))\n",
        "        rainbow.reverse_submobjects()\n",
        "        rainbow.move_to(album, DOWN).shift(0.05 * UP)\n",
        "        for mob in roygbiv, rainbow:\n",
        "            mob.set_submobject_colors_by_gradient(\n",
        "                RED, ORANGE, YELLOW, GREEN, BLUE, PURPLE\n",
        "            )\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(roygbiv, lag_ratio=0.5),\n",
        "            ShowCreation(rainbow, lag_ratio=0.5),\n",
        "            run_time=4\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Return\n",
        "        self.play(LaggedStartMap(\n",
        "            FadeOut, Group(\n",
        "                why_white, red_arrow,\n",
        "                roygbiv, rainbow,\n",
        "                true_prism, *titles,\n",
        "            ),\n",
        "            shift=DOWN,\n",
        "            scale=0.5,\n",
        "            lag_ratio=0.1\n",
        "        ))\n",
        "        self.add(self.pi_creatures, full_rect, album)\n",
        "        self.play(\n",
        "            Restore(album),\n",
        "            FadeOut(full_rect),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Ask question\n",
        "        question = Text(\"Why exactly does\\nthis work?\")\n",
        "        question.move_to(album, UP)\n",
        "        arrow = Arrow(question.get_bottom(), 2 * RIGHT + UP)\n",
        "        arrow.set_stroke(opacity=0)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(album, UP),\n",
        "            FadeIn(question, UP),\n",
        "            self.teacher.change(\"confused\", arrow.get_end()),\n",
        "            self.change_students(\"erm\", \"hesitant\", \"sassy\", look_at=arrow.get_end())\n",
        "        )\n",
        "        self.play(GrowArrow(arrow))\n",
        "        self.wait(5)\n",
        "\n",
        "        # Standard explanation\n",
        "        title = Text(\"Standard explanation:\", font_size=60)\n",
        "        title.to_edge(UP, buff=MED_SMALL_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            FadeTransform(question, title),\n",
        "            FadeOut(arrow, LEFT),\n",
        "            self.teacher.change(\"raise_right_hand\", look_at=3 * UP),\n",
        "            self.change_students(\"pondering\", \"pondering\", \"pondering\", look_at=3 * UP),\n",
        "        )\n",
        "        self.wait(5)\n",
        "\n",
        "\n",
        "class DefineIndexOfRefraction(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Speeds\n",
        "        ior = \"1.52\"\n",
        "        speed1 = Tex(R\"\\text{Speed} = c \\approx 3\\times 10^8 \\, {\\text{m} / \\text{s}}\")\n",
        "        speed2 = Tex(R\"\\text{Speed} \\approx c / \" + ior)\n",
        "        speed2[ior].set_color(PINK)\n",
        "        for speed, x in zip([speed1, speed2], [-1, 1]):\n",
        "            speed.set_x(x * FRAME_WIDTH / 4)\n",
        "            speed.set_y(-2)\n",
        "            self.play(FadeIn(speed, lag_ratio=0.1))\n",
        "            self.wait()\n",
        "\n",
        "        # Index of refraction\n",
        "        num_words = R\"\\text{Speed in a vacuum}\"\n",
        "        den_words = R\"\\text{Speed in a glass}\"\n",
        "        equation = Tex(\n",
        "            fR\"{{{num_words} \\over {den_words}}} \\approx {ior}\",\n",
        "            font_size=36\n",
        "        )\n",
        "        equation[den_words].set_color(BLUE)\n",
        "        equation[ior].set_color(PINK).scale(1.5, about_edge=LEFT)\n",
        "        equation.to_corner(UL)\n",
        "\n",
        "        name = TexText(\"``Index of refraction''\")\n",
        "        name.next_to(equation, DOWN, buff=LARGE_BUFF)\n",
        "        arrow = Arrow(name, equation[ior], buff=0.2)\n",
        "\n",
        "        self.play(\n",
        "            TransformMatchingShapes(speed1[\"Speed\"].copy(), equation[num_words]),\n",
        "            TransformMatchingShapes(speed2[\"Speed\"].copy(), equation[den_words]),\n",
        "            Write(equation[R\"\\over\"]),\n",
        "            Write(equation[R\"\\approx\"]),\n",
        "            TransformFromCopy(speed2[ior], equation[ior]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Write(name), GrowArrow(arrow))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class LightDoesntHaveTreads(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        stds = self.students\n",
        "        self.play(\n",
        "            stds[0].change(\"confused\", self.screen),\n",
        "            stds[1].change(\"erm\", self.screen),\n",
        "            stds[2].says(\"But, light doesn't\\nhave treads...\", mode=\"sassy\", bubble_direction=LEFT),\n",
        "            self.teacher.change(\"guilty\"),\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class LookAtScrolling(InteractiveScene):\n",
        "    random_seed = 1\n",
        "\n",
        "    def construct(self):\n",
        "        morty = Mortimer()\n",
        "        morty.set_height(3)\n",
        "        morty.to_edge(RIGHT)\n",
        "\n",
        "        self.play(morty.change(\"pondering\", 3 * DOWN))\n",
        "        for _ in range(4):\n",
        "            self.play(morty.change(\n",
        "                random.choice([\"tease\", \"pondering\"]),\n",
        "                3 * UP\n",
        "            ))\n",
        "            if random.random() < 0.3:\n",
        "                self.play(Blink(morty))\n",
        "            else:\n",
        "                self.wait()\n",
        "            self.play(morty.animate.look_at(3 * DOWN))\n",
        "            if random.random() < 0.3:\n",
        "                self.play(Blink(morty))\n",
        "            else:\n",
        "                self.wait()\n",
        "\n",
        "\n",
        "class WhySlowAtAll(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        stds = self.students\n",
        "        self.play(\n",
        "            stds[0].change(\"pondering\", self.screen),\n",
        "            stds[1].says(\"Why would light\\nslow down at all?\", mode=\"confused\", bubble_direction=LEFT, look_at=self.screen),\n",
        "            stds[2].change(\"erm\", self.screen),\n",
        "            self.teacher.change(\"tease\"),\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(self.change_students(\"hesitant\", \"maybe\", \"pondering\", look_at=self.screen))\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class TankAnnotations(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # self.add(ImageMobject(\"TankStill\").set_height(FRAME_HEIGHT))\n",
        "        point = LEFT\n",
        "        words = Text(\"First contact!\", font_size=24)\n",
        "        words.next_to(point, DOWN)\n",
        "        self.play(\n",
        "            Flash(point),\n",
        "            FadeIn(words, run_time=0.5)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ReactToStandardExplanation(InteractiveScene):\n",
        "    samples = 4\n",
        "\n",
        "    def construct(self):\n",
        "        # Phrases\n",
        "        phrases = VGroup(\n",
        "            Text(\"Light slows down in glass\\ndifferent amounts for different colors\", alignment=\"LEFT\"),\n",
        "            TexText(R\"Slowing down $\\Rightarrow$ bending\"),\n",
        "            TexText(R\"Therefore colors refract at different angles\"),\n",
        "        )\n",
        "        phrases.set_fill(border_width=0)\n",
        "\n",
        "        for phrase, y in zip(phrases, [1, 0, -1]):\n",
        "            phrase.set_y(y * FRAME_HEIGHT / 3)\n",
        "            phrase.set_x(-2.0, LEFT)\n",
        "\n",
        "        self.add(phrases)\n",
        "        self.wait()\n",
        "\n",
        "        # Ask question\n",
        "        p1 = phrases[0][\"Light slows down in glass\"]\n",
        "        p2 = phrases[0][\"different amounts for different colors\"]\n",
        "        slows_down = phrases[0][\"slows down\"]\n",
        "\n",
        "        rect = SurroundingRectangle(p1, buff=0.05)\n",
        "        rect.set_stroke(YELLOW, 2)\n",
        "\n",
        "        why = Text(\"Why?!\")\n",
        "        why.set_color(YELLOW)\n",
        "        why.next_to(rect, RIGHT)\n",
        "        how = Text(\"How?\")\n",
        "        how.match_style(why)\n",
        "        how.next_to(slows_down, UP)\n",
        "        discovered = Text(\"This should feel discovered\")\n",
        "        discovered.match_style(why)\n",
        "        discovered.next_to(phrases[0], DOWN, buff=0.5)\n",
        "\n",
        "        morty = Mortimer(height=2)\n",
        "        morty.to_edge(RIGHT)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(rect),\n",
        "            Write(why),\n",
        "            p2.animate.set_opacity(0.25),\n",
        "            phrases[1:].animate.set_opacity(0.25),\n",
        "            VFadeIn(morty),\n",
        "            morty.change(\"maybe\", rect),\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeTransform(why, how),\n",
        "            rect.animate.surround(slows_down),\n",
        "            morty.change(\"angry\", rect),\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "        why.next_to(p2, DOWN)\n",
        "        self.play(\n",
        "            rect.animate.surround(p2),\n",
        "            p2.animate.set_opacity(1),\n",
        "            p1.animate.set_opacity(0.25),\n",
        "            FadeTransform(how, why),\n",
        "            morty.change(\"confused\", rect),\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "        self.remove(why)\n",
        "        self.play(\n",
        "            rect.animate.surround(phrases[0], buff=0.25),\n",
        "            phrases[0].animate.set_opacity(1),\n",
        "            FadeTransformPieces(why.copy(), discovered, remover=True),\n",
        "            morty.change(\"tease\", rect),\n",
        "        )\n",
        "        self.add(discovered)\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "        # Ask for better explanation of bending\n",
        "        new_why = Text(\"Better explanation?\")\n",
        "        new_why.match_style(why)\n",
        "        new_why.next_to(phrases[1], UP)\n",
        "        self.play(\n",
        "            phrases[0].animate.set_opacity(0.25),\n",
        "            phrases[1].animate.set_opacity(1),\n",
        "            rect.animate.surround(phrases[1]),\n",
        "            FadeTransform(discovered, new_why),\n",
        "            morty.change(\"pondering\", phrases[1]),\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "        # Back to central question\n",
        "        why.next_to(p1, UP)\n",
        "        self.play(\n",
        "            rect.animate.surround(p1),\n",
        "            p1.animate.set_opacity(1),\n",
        "            phrases[1].animate.set_opacity(0.25),\n",
        "            FadeTransform(new_why, why),\n",
        "            morty.change(\"raise_right_hand\")\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class SnellPuzzle(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        title = Text(\"Puzzle\", font_size=60).set_color(YELLOW)\n",
        "        underline = Underline(title, stretch_factor=2, stroke_color=YELLOW)\n",
        "        puzzle = TexText(R\"\"\"\n",
        "            Can you find an equation \\\\\n",
        "            relating $\\lambda_1$, $\\lambda_2$, $\\theta_1$ and $\\theta_2$?\n",
        "        \"\"\")\n",
        "        puzzle.next_to(underline, DOWN, buff=0.5)\n",
        "        group = VGroup(title, underline, puzzle)\n",
        "        rect = SurroundingRectangle(group, buff=0.25)\n",
        "        rect.set_fill(BLACK, 1)\n",
        "        rect.set_stroke(WHITE, 0)\n",
        "        group.add_to_back(rect)\n",
        "        group.to_corner(UL)\n",
        "        self.add(group)\n",
        "\n",
        "\n",
        "class SnellComparrisonBackdrop(InteractiveScene):\n",
        "    def construct(self):\n",
        "        self.add(FullScreenRectangle().set_fill(GREY_E, 1))\n",
        "        rects = Rectangle(6, 7).replicate(2)\n",
        "        rects.set_fill(BLACK, 1)\n",
        "        rects.set_stroke(WHITE, 1)\n",
        "        rects[0].set_x(-FRAME_WIDTH / 4)\n",
        "        rects[1].set_x(FRAME_WIDTH / 4)\n",
        "        self.add(rects)\n",
        "\n",
        "\n",
        "class KeyPoints(InteractiveScene):\n",
        "    def construct(self):\n",
        "        key_points = VGroup(\n",
        "            Text(\"Key point #1: Phase kicks\"),\n",
        "            Text(\"Key point #2: Layer oscillations\"),\n",
        "            Text(\"Key point #3: Resonance\"),\n",
        "        )\n",
        "        key_points.set_submobject_colors_by_gradient(BLUE, TEAL, YELLOW)\n",
        "        key_points.scale(1.25)\n",
        "        key_points.to_edge(UP, buff=0.25)\n",
        "        key_points.set_backstroke(BLACK, 4)\n",
        "        key_points.to_edge(UP)\n",
        "\n",
        "        self.add(key_points[0])\n",
        "        self.wait()\n",
        "        for kp1, kp2 in zip(key_points, key_points[1:]):\n",
        "            self.play(\n",
        "                FadeOut(kp1, 0.5 * UP),\n",
        "                FadeIn(kp2, 0.5 * UP),\n",
        "            )\n",
        "            self.wait()\n",
        "\n",
        "\n",
        "class AsideOnWaveTerminology(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        title = Text(\"Wave terminology\", font_size=60)\n",
        "        title.to_corner(UR)\n",
        "        title.to_edge(UP, buff=0.25)\n",
        "        title.add(Underline(title))\n",
        "        title.set_color(YELLOW)\n",
        "        terms = VGroup(\n",
        "            Text(\"Phase\"),\n",
        "            Text(\"Frequency\"),\n",
        "            Text(\"Wave number\"),\n",
        "            Text(\"Amplitude\"),\n",
        "        )\n",
        "        terms.arrange(DOWN, buff=0.5, aligned_edge=LEFT)\n",
        "        terms.next_to(title, DOWN)\n",
        "        terms.shift(0.5 * LEFT)\n",
        "\n",
        "        self.add(title, terms)\n",
        "\n",
        "        self.play(\n",
        "            self.teacher.change(\"raise_right_hand\", terms),\n",
        "            self.change_students(\"pondering\", \"tease\", \"hesitant\", look_at=terms),\n",
        "            LaggedStartMap(FadeIn, terms, shift=0.25 * DOWN, lag_ratio=0.5),\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class NewQuestion(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Questions\n",
        "        text_kw = dict(font_size=48)\n",
        "        questions = VGroup(\n",
        "            Text(\"Why does light\\nslow down in glass?\", **text_kw),\n",
        "            Text(\"Why does light's interaction\\nwith a layer of glass\\nkick back its phase?\", **text_kw),\n",
        "            Text(\"How much does\\nlight slow down?\", **text_kw),\n",
        "            Text(\"How strong is\\nthe phase kick?\", **text_kw),\n",
        "        )\n",
        "        q1, q2, q3, q4 = questions\n",
        "        for question, x in zip(questions, [-1, 1, -1, 1]):\n",
        "            question.set_x(x * FRAME_WIDTH / 4)\n",
        "            question.set_y(2.75)\n",
        "\n",
        "        q3.shift(0.5 * RIGHT)\n",
        "        q4.shift(0.5 * LEFT)\n",
        "\n",
        "        bad_ap = q2[\"'\"][0]\n",
        "        good_ap = TexText(\"'\")\n",
        "        good_ap.replace(bad_ap, dim_to_match=1)\n",
        "        bad_ap.become(good_ap)\n",
        "\n",
        "        arrow1 = Arrow(q1, q2)\n",
        "        arrow2 = Arrow(q3, q4)\n",
        "\n",
        "        for question in [q1, q3]:\n",
        "            question.set_opacity(0.5)\n",
        "            question.save_state()\n",
        "            question.set_x(0)\n",
        "            question.set_opacity(1)\n",
        "\n",
        "        # First pair\n",
        "        self.play(FadeIn(q1))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            ShowCreation(arrow1),\n",
        "            Restore(q1),\n",
        "            TransformMatchingStrings(q1.copy(), q2, run_time=1),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FlashUnder(q2[\"layer of glass\"], color=BLUE),\n",
        "            q2[\"layer of glass\"].animate.set_color(BLUE)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FlashUnder(q2[\"phase\"]),\n",
        "            q2[\"phase\"].animate.set_color(YELLOW)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Second pair\n",
        "        self.play(\n",
        "            FadeOut(q1, UP),\n",
        "            FadeIn(q3, UP),\n",
        "            FadeOut(arrow1),\n",
        "            FadeOut(q2),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            ShowCreation(arrow2),\n",
        "            Restore(q3),\n",
        "            TransformMatchingStrings(q3.copy(), q4, run_time=1),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class HoldUpLastVideo(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        self.remove(self.background)\n",
        "        image = ImageMobject(\"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/Thumbnails/Part2Thumbnail4.png\")\n",
        "        tn = Group(\n",
        "            SurroundingRectangle(image, buff=0).set_stroke(WHITE, 3),\n",
        "            image,\n",
        "        )\n",
        "        tn.set_height(3)\n",
        "        tn.move_to(self.hold_up_spot, DOWN)\n",
        "        tn.shift(0.25 * DOWN)\n",
        "\n",
        "        label = Text(\"Last video\")\n",
        "        arrow = Vector(RIGHT)\n",
        "        arrow.next_to(tn, LEFT)\n",
        "        label.next_to(arrow, LEFT)\n",
        "\n",
        "        self.play(\n",
        "            self.teacher.change(\"raise_right_hand\", tn),\n",
        "            FadeIn(tn, UP),\n",
        "            self.change_students(\"pondering\", \"erm\", \"tease\", look_at=tn)\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(label, lag_ratio=0.1),\n",
        "            GrowArrow(arrow)\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class WhyDoesAddingCauseAShift(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        self.play(\n",
        "            stds[2].says(\"But, why?\", look_at=morty.eyes, mode=\"raise_left_hand\", bubble_direction=LEFT),\n",
        "            self.change_students(\"pondering\", \"pondering\", look_at=self.screen),\n",
        "            morty.change(\"guilty\", self.screen),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(stds[2].change(\"confused\", self.screen))\n",
        "        self.wait(2)\n",
        "        self.play(morty.change(\"tease\", stds[2].eyes))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\", 3 * UR),\n",
        "            stds[2].debubble(look_at=3 * UR),\n",
        "            self.change_students(\"erm\", \"hesitant\", look_at=3 * UR)\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class AnnoateWaveSumPhaseShift(InteractiveScene):\n",
        "    def construct(self):\n",
        "        image = ImageMobject(\"WaveSumPhaseShift\")\n",
        "        image.set_height(FRAME_HEIGHT).center()\n",
        "        # self.add(image)\n",
        "\n",
        "        # Test\n",
        "        wave_len = 4.0\n",
        "        point1 = (-1.31, 2.33, 0)\n",
        "        point2 = (-2.3, 0, 0)\n",
        "\n",
        "        line = DashedLine(UP, DOWN)\n",
        "        lines1 = line.get_grid(1, 6, h_buff=wave_len / 2)\n",
        "        lines1.set_height(1.0, stretch=True)\n",
        "        lines1.set_stroke(YELLOW, 3)\n",
        "        lines1.move_to(point1 + wave_len * LEFT / 2, LEFT)\n",
        "\n",
        "        lines2 = lines1.copy()\n",
        "        lines2.move_to(point2 + wave_len * LEFT / 2, LEFT)\n",
        "\n",
        "        arrow = Arrow(\n",
        "            lines2[1].get_top(),\n",
        "            lines1[1].get_bottom(),\n",
        "            buff=0.2\n",
        "        )\n",
        "        label = TexText(R\"$90^\\circ$ behind\")\n",
        "        label.next_to(arrow.get_center(), RIGHT)\n",
        "\n",
        "        self.play(LaggedStartMap(ShowCreation, lines2, lag_ratio=0, run_time=0.5))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(lines2, lines1),\n",
        "            GrowArrow(arrow),\n",
        "            FadeIn(label, lag_ratio=0.1),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class PreviewQuarterBehindReason(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Plane\n",
        "        plane = ComplexPlane(\n",
        "            (-3, 3), (-3, 3),\n",
        "            background_line_style=dict(stroke_width=2, stroke_color=BLUE),\n",
        "            faded_line_style=dict(stroke_width=1, stroke_opacity=0.3, stroke_color=BLUE),\n",
        "        )\n",
        "        plane.set_height(7)\n",
        "        self.add(plane)\n",
        "\n",
        "        # Add little vectors\n",
        "        z1 = 1 + complex(-4e-3, -0.05)\n",
        "        amp = 0.08\n",
        "        zs = np.array([amp * z1**n for n in range(1000)])\n",
        "        vects = VGroup(*(\n",
        "            Vector(plane.n2p(z), stroke_width=2)\n",
        "            for z in zs\n",
        "        ))\n",
        "        vects.set_submobject_colors_by_gradient(YELLOW, RED)\n",
        "        for v1, v2 in zip(vects, vects[1:]):\n",
        "            v2.shift(v1.get_end() - v2.get_start())\n",
        "\n",
        "        big_vect = Vector(stroke_width=5)\n",
        "        big_vect.add_updater(lambda m: m.put_start_and_end_on(\n",
        "            plane.n2p(0), vects[-1].get_end() if len(vects) > 0 else plane.n2p(amp)\n",
        "        ))\n",
        "\n",
        "        self.add(big_vect)\n",
        "        self.play(\n",
        "            ShowIncreasingSubsets(vects, rate_func=linear, run_time=8)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ElectronLabel(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        label = Text(\"An electron, say\")\n",
        "        label.set_backstroke(BLACK, 5)\n",
        "        label.next_to(ORIGIN, UR, buff=LARGE_BUFF)\n",
        "        arrow = Arrow(label, ORIGIN)\n",
        "        self.play(\n",
        "            FadeIn(label, lag_ratio=0.1),\n",
        "            GrowArrow(arrow)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class IsThatTrue(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Ask\n",
        "        stds = self.students\n",
        "        morty = self.teacher\n",
        "        law = Tex(R\"\\vec{\\textbf{F}}(t) = -k \\vec{\\textbf{x}}(t)\", t2c=EQUATION_T2C)\n",
        "        law.move_to(self.hold_up_spot, DOWN)\n",
        "        morty.change_mode(\"raise_right_hand\")\n",
        "        self.add(law)\n",
        "        self.play(\n",
        "            stds[0].change(\"pondering\", self.screen),\n",
        "            stds[1].says(\"Is that accurate?\", mode=\"sassy\", look_at=self.screen),\n",
        "            stds[2].change(\"erm\", self.screen),\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        # Answer\n",
        "        self.play(\n",
        "            morty.says(TexText(\n",
        "                R\"For small $\\vec{\\textbf{x}}$, \\\\ accurate enough\",\n",
        "                t2c={R\"$\\vec{\\textbf{x}}$\": RED}\n",
        "            )),\n",
        "            self.change_students(\"thinking\", \"erm\", \"happy\", look_at=morty.eyes),\n",
        "            law.animate.to_edge(UP),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Name restoring force\n",
        "        label = TexText(\"``Linear restoring force''\")\n",
        "        label.next_to(law, DOWN)\n",
        "        self.play(\n",
        "            FadeInFromPoint(label, morty.get_corner(UL)),\n",
        "            self.change_students(look_at=label),\n",
        "            morty.debubble(\"raise_right_hand\", look_at=label),\n",
        "            stds[1].debubble(\"pondering\", look_at=label),\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        # True law\n",
        "        group = VGroup(law, label)\n",
        "        true_law = Tex(\n",
        "            R\"\"\"\n",
        "            \\text{True force: }\n",
        "            F = -k x + c_2 x^2 + c_3 x^3 + c_4 x^4 + \\cdots\n",
        "            \"\"\",\n",
        "            t2c={\"F\": YELLOW, \"x\": RED},\n",
        "            font_size=60\n",
        "        )\n",
        "        true_law.move_to(UP)\n",
        "        rect = SurroundingRectangle(true_law[\"F = -k x\"], buff=0.25)\n",
        "        rect.set_stroke(BLUE, 1)\n",
        "\n",
        "        self.play(\n",
        "            group.animate.set_height(1).to_corner(UR),\n",
        "            FadeIn(true_law, lag_ratio=0.1, run_time=2),\n",
        "            morty.change(\"hesitant\"),\n",
        "            self.change_students(\"pondering\", \"pondering\", \"pondering\", look_at=true_law)\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            ShowCreation(rect),\n",
        "            true_law[R\" + c_2 x^2 + c_3 x^3 + c_4 x^4 + \\cdots\"].animate.set_opacity(0.2),\n",
        "            morty.change(\"tease\"),\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "\n",
        "class VelocityZero(InteractiveScene):\n",
        "    def construct(self):\n",
        "        label = Tex(R\"(\\text{Velocity} = 0)\")\n",
        "        label.set_color(PINK)\n",
        "        self.play(FadeIn(label, 0.5 * UP))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class FrequencyVsAngularFrequency(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Correction\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        rf_words = Text(\"Resonant frequency\")\n",
        "        raf_words = Text(\"Resonant angular frequency\")\n",
        "        omega = Tex(R\"\\omega_r\", font_size=72)\n",
        "        omega.set_color(PINK)\n",
        "        omega.move_to(self.hold_up_spot, DOWN)\n",
        "        for words in rf_words, raf_words:\n",
        "            words.next_to(omega, UP)\n",
        "\n",
        "        cross = Cross(rf_words)\n",
        "        self.add(rf_words, omega)\n",
        "        morty.change_mode(\"raise_right_hand\")\n",
        "        self.play(\n",
        "            ShowCreation(cross),\n",
        "            self.change_students(\"sassy\", \"hesitant\", \"angry\")\n",
        "        )\n",
        "        rf_words.add(cross)\n",
        "        rf_words.target = rf_words.generate_target()\n",
        "        rf_words.target.next_to(raf_words, UP, LARGE_BUFF)\n",
        "        rf_words.target.set_fill(opacity=0.5)\n",
        "        rf_words.target[-1].set_opacity(0)\n",
        "\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            MoveToTarget(rf_words),\n",
        "            TransformMatchingStrings(\n",
        "                rf_words.copy(), raf_words,\n",
        "                run_time=1,\n",
        "            ),\n",
        "            self.change_students(\"pondering\", \"hesitant\", \"hesitant\")\n",
        "        )\n",
        "\n",
        "        # Show cycles\n",
        "        plane = ComplexPlane(\n",
        "            (-1, 1), (-1, 1),\n",
        "            background_line_style=dict(stroke_width=1, stroke_color=BLUE),\n",
        "            faded_line_style=dict(stroke_width=0.5, stroke_opacity=0.5, stroke_color=BLUE),\n",
        "        )\n",
        "        plane.set_height(4)\n",
        "        plane.to_edge(DOWN)\n",
        "        circle = Circle(radius=plane.x_axis.get_unit_size())\n",
        "        circle.set_stroke(TEAL, 2)\n",
        "        circle.move_to(plane.get_origin())\n",
        "\n",
        "        f_words = Text(\"Frequency\", font_size=60)\n",
        "        af_words = Text(\"Angular Frequency\", font_size=60)\n",
        "        for words, x in [(f_words, -1), (af_words, 1)]:\n",
        "            words.set_x(x * FRAME_WIDTH  / 4)\n",
        "            words.to_edge(UP, buff=MED_SMALL_BUFF)\n",
        "\n",
        "        t2c = {R\"\\omega\": PINK, \"f\": TEAL}\n",
        "        f_eq = Tex(R\"f = {\\text{Cycles} \\over \\text{Seconds}}\", t2c=t2c)\n",
        "        f_eq.next_to(f_words, DOWN, MED_LARGE_BUFF)\n",
        "        f_eq[\"f\"].set_color(YELLOW)\n",
        "        af_eq = Tex(R\"\\omega = {\\text{Radians} \\over \\text{Seconds}}\", t2c=t2c)\n",
        "        af_eq.next_to(af_words, DOWN, MED_LARGE_BUFF)\n",
        "        af_eq[R\"\\omega\"].set_color(PINK)\n",
        "\n",
        "        angle_tracker = ValueTracker()\n",
        "        angle_tracker.add_updater(lambda m, dt: m.increment_value(0.25 * dt * TAU))\n",
        "        vect = Vector(RIGHT).set_color(YELLOW)\n",
        "        vect.add_updater(lambda m: m.put_start_and_end_on(\n",
        "            plane.n2p(0),\n",
        "            plane.n2p(np.exp(complex(0, angle_tracker.get_value())))\n",
        "        ))\n",
        "\n",
        "        self.add(angle_tracker)\n",
        "        self.play(\n",
        "            FadeOut(self.background),\n",
        "            LaggedStartMap(FadeOut, self.pi_creatures, shift=DOWN),\n",
        "            ShowCreation(plane, lag_ratio=0.1),\n",
        "            FadeIn(circle),\n",
        "            TransformMatchingStrings(rf_words, f_words),\n",
        "            TransformMatchingStrings(raf_words, af_words),\n",
        "            FadeTransform(omega, af_eq[R\"\\omega\"]),\n",
        "            FadeIn(af_eq[1:]),\n",
        "            FadeIn(f_eq),\n",
        "            VFadeIn(vect)\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "        # Show specific value\n",
        "        f_value_eq = Tex(\"f = 0.25\", t2c=t2c)\n",
        "        af_value_eq = Tex(R\"\\omega = 2\\pi f = 1.57\", t2c=t2c)\n",
        "        values = VGroup(f_value_eq, af_value_eq)\n",
        "        values.arrange(DOWN, buff=MED_LARGE_BUFF, aligned_edge=LEFT)\n",
        "        values.next_to(plane, LEFT, MED_LARGE_BUFF)\n",
        "\n",
        "        self.play(FadeIn(f_value_eq))\n",
        "        self.wait(8)\n",
        "        self.play(FadeIn(af_value_eq))\n",
        "\n",
        "        # Show angle label\n",
        "        arc_angle_tracker = ValueTracker()\n",
        "        get_arc_angle = arc_angle_tracker.get_value \n",
        "        arc = always_redraw(lambda: Arc(\n",
        "            0, get_arc_angle(),\n",
        "            arc_center=plane.n2p(0),\n",
        "            radius=0.5,\n",
        "        ))\n",
        "        arc_angle_label = DecimalNumber(0, unit=R\"\\text{ Radians}\")\n",
        "        arc_angle_label.add_updater(lambda m: m.set_value(get_arc_angle()))\n",
        "        arc_angle_label.add_updater(lambda m: m.next_to(arc.get_center(), UR))\n",
        "        arc_angle_label.add_updater(lambda m: m[4:].shift(SMALL_BUFF * RIGHT))\n",
        "\n",
        "\n",
        "        self.add(arc)\n",
        "        self.play(\n",
        "            arc_angle_tracker.animate.set_value(TAU / 4),\n",
        "            VFadeIn(arc_angle_label),\n",
        "        )\n",
        "        arc.clear_updaters()\n",
        "        self.wait(10)\n",
        "        self.play(\n",
        "            VFadeOut(arc),\n",
        "            VFadeOut(arc_angle_label),\n",
        "            FadeOut(values),\n",
        "        )\n",
        "\n",
        "        # Show cosine\n",
        "        plane.add(circle)\n",
        "        plane.generate_target()\n",
        "        plane.target.to_edge(LEFT)\n",
        "        axes = Axes((0, 16), (-1, 1), width=9, height=0.75 * plane.get_height())\n",
        "        axes.next_to(plane.target, RIGHT)\n",
        "        graph = axes.get_graph(lambda x: np.cos(TAU * 0.25 * x))\n",
        "        graph.set_stroke(YELLOW, 2)\n",
        "\n",
        "        cos_eq = Tex(R\"\\cos(\\omega t) = \\cos(2\\pi f t)\", t2c=t2c)\n",
        "        cos_eq.next_to(graph, UP)\n",
        "        omega_arrow = Vector(0.5 * DOWN).set_color(PINK)\n",
        "        omega_arrow.next_to(cos_eq[R\"\\omega\"], UP, SMALL_BUFF)\n",
        "\n",
        "        dot = GlowDot()\n",
        "        dot.add_updater(lambda m: m.move_to(plane.n2p(math.cos(angle_tracker.get_value()))))\n",
        "        line = Line(UP, DOWN)\n",
        "        line.set_stroke(YELLOW, 1)\n",
        "        line.add_updater(lambda m: m.put_start_and_end_on(\n",
        "            vect.get_end(), dot.get_center()\n",
        "        ))\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(plane),\n",
        "            FadeIn(axes, 2 * LEFT)\n",
        "        )\n",
        "        self.wait(4 * (1 - (angle_tracker.get_value() / TAU) % 1))\n",
        "        self.add(dot, line)\n",
        "        self.play(\n",
        "            ShowCreation(graph, rate_func=linear),\n",
        "            FadeIn(cos_eq, time_span=(0, 1)),\n",
        "            ShowCreation(omega_arrow, time_span=(4, 5)),\n",
        "            run_time=16\n",
        "        )\n",
        "\n",
        "\n",
        "class UnequalFrequencies(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        # self.add(ImageMobject(\"WaveEqStill\").set_height(FRAME_HEIGHT))\n",
        "\n",
        "        word_eq = TexText(R\"Freq. of light $\\ne$ Resonant freq.\")\n",
        "        eq = Tex(R\"\\omega_l \\ne \\omega_r\")\n",
        "        word_lhs = word_eq[\"Freq. of light\"]\n",
        "        word_rhs = word_eq[\"Resonant freq.\"]\n",
        "        word_lhs.set_color(TEAL)\n",
        "        word_rhs.set_color(PINK)\n",
        "        eq[R\"\\omega_l\"].set_color(TEAL)\n",
        "        eq[R\"\\omega_r\"].set_color(PINK)\n",
        "        equations = VGroup(word_eq, eq)\n",
        "        equations.arrange(DOWN)\n",
        "        equations.to_corner(UR)\n",
        "\n",
        "        oml_point = np.array([-1.2, 2.7, 0])\n",
        "        arrow = Arrow(word_eq.get_left(), oml_point, path_arc=90 * DEGREES)\n",
        "        arrow.set_color(TEAL)\n",
        "        oml = eq[R\"\\omega_l\"]\n",
        "        oml_copy = oml.copy().move_to(oml_point)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(word_eq),\n",
        "            ShowCreation(arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(ReplacementTransform(oml_copy, oml))\n",
        "        self.play(Write(eq[R\"\\ne \\omega_r\"]))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class DisectDrivenEq(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Setup\n",
        "        driven_eq = Tex(\n",
        "            R\"\"\"\n",
        "                \\vec{\\textbf{F}}(t) = - k \\vec{\\textbf{x}}(t)\n",
        "                + \\vec{\\textbf{E}}_0 q \\cos(\\omega_l t)\n",
        "            \"\"\",\n",
        "            t2c=EQUATION_T2C\n",
        "        )\n",
        "        driven_eq.to_corner(UR, buff=0.6)\n",
        "\n",
        "        lhs = driven_eq[R\"\\vec{\\textbf{F}}(t) = - k \\vec{\\textbf{x}}(t)\"]\n",
        "        parts = VGroup(*(\n",
        "            driven_eq[tex]\n",
        "            for tex in [\n",
        "                R\"\\vec{\\textbf{E}}_0 q \\cos(\\omega_l t)\",\n",
        "                R\"\\omega_l\",\n",
        "                R\"\\vec{\\textbf{E}}_0\",\n",
        "                R\"q\",\n",
        "            ]\n",
        "        ))\n",
        "        light_part, omega_l, E0, q = parts\n",
        "        words = VGroup(\n",
        "            Text(\"Force from a\\nlight wave\"),\n",
        "            Text(\"Angular frequency\\nof the light (color)\"),\n",
        "            Text(\"Strength of\\nthe wave\"),\n",
        "            Text(\"Charge of the\\nelectron\"),\n",
        "        )\n",
        "        words[0].scale(0.75)\n",
        "        words[1:].scale(0.75)\n",
        "        for part, word in zip(parts, words):\n",
        "            word.next_to(part, DOWN, buff=0.35)\n",
        "            word.shift_onto_screen()\n",
        "            word.match_color(part[0][0])\n",
        "        words[0].set_color(WHITE)\n",
        "\n",
        "        rect = SurroundingRectangle(light_part)\n",
        "        rect.set_stroke(TEAL, 2)\n",
        "\n",
        "        # for expr in driven_eq, words[0]:\n",
        "        #     bg = BackgroundRectangle(expr, buff=MED_SMALL_BUFF)\n",
        "        #     bg.set_fill(BLACK, 1)\n",
        "        #     self.add(bg)\n",
        "\n",
        "        words[0].set_backstroke(BLACK, 8)\n",
        "\n",
        "        # Animations\n",
        "        self.play(FadeIn(lhs, UP))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Write(driven_eq[\"+\"]),\n",
        "            FadeIn(light_part, lag_ratio=0.1),\n",
        "        )\n",
        "        self.play(\n",
        "            ShowCreation(rect),\n",
        "            Write(words[0]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            rect.animate.surround(omega_l),\n",
        "            FadeTransform(*words[0:2]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            rect.animate.surround(E0),\n",
        "            FadeTransform(*words[1:3]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            rect.animate.surround(q),\n",
        "            FadeTransform(*words[2:4]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            rect.animate.surround(light_part),\n",
        "            FadeTransform(words[3], words[0]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class AskAboutAmplitude(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        lines = DashedLine(3 * LEFT, 3 * RIGHT).replicate(2)\n",
        "        lines.arrange(DOWN, buff=0.8)\n",
        "        brace = Brace(lines, LEFT)\n",
        "        text = brace.get_text(\"What is this\\nAmplitude?\")\n",
        "        text.set_backstroke(BLACK, 8)\n",
        "\n",
        "        self.play(*map(ShowCreation, lines))\n",
        "        self.play(\n",
        "            GrowFromCenter(brace),\n",
        "            Write(text),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class PiCreaturesReactingToEquation(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "        self.remove(self.background)\n",
        "        point = morty.get_corner(UL) + 2 * UP + LEFT\n",
        "        self.play(\n",
        "            morty.change(\"raise_left_hand\", point),\n",
        "            self.change_students(\"pondering\", \"thinking\", \"erm\", look_at=point)\n",
        "        )\n",
        "        self.wait(3)\n",
        "        self.play(self.change_students(\"thinking\", \"pondering\", \"pondering\", look_at=point))\n",
        "        self.wait(3)\n",
        "        self.play(\n",
        "            morty.says(\"Oh hey, it depends\\non the frequency!\", mode=\"hooray\"),\n",
        "            self.change_students(\"happy\", \"tease\", \"thinking\", look_at=point)\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class HighlightExpression(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        expr = Tex(\n",
        "            R\"\"\"\n",
        "                \\vec{\\textbf{x}}(t) = \n",
        "                \\frac{q ||\\vec{\\textbf{E}}_0||}{m\\left(\\omega_r^2-\\omega_l^2\\right)}\n",
        "                \\cos(\\omega_l t)\n",
        "            \"\"\",\n",
        "            t2c=EQUATION_T2C\n",
        "        )\n",
        "        expr.to_edge(UP)\n",
        "        rect1 = SurroundingRectangle(expr[R\"\\omega_r^2-\\omega_l^2\"])\n",
        "        rect2 = SurroundingRectangle(expr[R\"\\frac{q ||\\vec{\\textbf{E}}_0||}{m\\left(\\omega_r^2-\\omega_l^2\\right)}\"])\n",
        "\n",
        "        self.add(expr)\n",
        "        self.play(ShowCreation(rect1))\n",
        "        self.wait()\n",
        "        self.play(Transform(rect1, rect2))\n",
        "        self.wait()\n",
        "        self.play(FadeOut(rect2))\n",
        "\n",
        "\n",
        "class Amplitude(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Show equation with annotations\n",
        "        equation = Tex(R\"\"\"\n",
        "            \\text{Layer wiggle amplitude} = \n",
        "            \\frac{q ||\\vec{\\textbf{E}}_0||}{m\\left(\\omega_r^2-\\omega_l^2\\right)}\n",
        "        \"\"\", t2c=EQUATION_T2C)\n",
        "        equation.to_corner(UL)\n",
        "\n",
        "        lf_rect = SurroundingRectangle(equation[R\"\\omega_l\"])\n",
        "        rf_rect = SurroundingRectangle(equation[R\"\\omega_r\"])\n",
        "\n",
        "        lf_words = Text(\"Light frequency\", font_size=36)\n",
        "        rf_words = Text(\"Resonant frequency\", font_size=36)\n",
        "        lf_words.next_to(lf_rect, DOWN)\n",
        "        rf_words.next_to(rf_rect, DOWN)\n",
        "\n",
        "        VGroup(lf_rect, rf_rect).set_stroke(width=2)\n",
        "        VGroup(lf_rect, lf_words).set_color(EQUATION_T2C[R\"\\omega_l\"])\n",
        "        VGroup(rf_rect, rf_words).set_color(EQUATION_T2C[R\"\\omega_r\"])\n",
        "\n",
        "        self.add(equation)\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            ShowCreation(lf_rect),\n",
        "            FadeIn(lf_words, 0.5 * DOWN),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            ReplacementTransform(lf_rect, rf_rect),\n",
        "            FadeTransform(lf_words, rf_words),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(FadeOut(rf_rect), FadeOut(rf_words))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class GuessSteadyState(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Show prompt\n",
        "        prompt = VGroup(\n",
        "            Text(\"Guess that: \"),\n",
        "            Tex(R\"\"\"\n",
        "                \\vec{\\textbf{x}}(t) =\n",
        "                A \\cos(\\omega_l t)\n",
        "            \"\"\", t2c=EQUATION_T2C)\n",
        "        )\n",
        "        prompt.arrange(RIGHT, buff=0.5)\n",
        "        prompt.to_edge(UP)\n",
        "        A_part = prompt[1][\"A\"]\n",
        "        A_part.set_color(GREY_B)\n",
        "        freq = prompt[1][R\"\\omega_l\"]\n",
        "\n",
        "        A_arrow = Vector(0.3 * UP, stroke_width=2).next_to(A_part, DOWN, buff=0.1)\n",
        "        freq_arrow = Vector(0.3 * UP, stroke_width=2).next_to(freq, DOWN, buff=0.1)\n",
        "        freq_arrow.set_color(TEAL)\n",
        "\n",
        "        A_word = Text(\"Solve for\\nthis\", font_size=24)\n",
        "        A_word.next_to(A_arrow, DOWN, buff=0.1)\n",
        "        freq_word = Text(\"Light frequency\", font_size=24)\n",
        "        freq_word.next_to(freq_arrow, DOWN, buff=0.1)\n",
        "        freq_word.shift(0.5 * RIGHT)\n",
        "        freq_word.set_color(TEAL)\n",
        "        A_word.align_to(freq_word, UP)\n",
        "\n",
        "        rect = FullScreenRectangle()\n",
        "        rect.set_fill(BLACK, 1)\n",
        "        rect.set_height(2, about_edge=UP, stretch=True)\n",
        "\n",
        "        self.add(rect)\n",
        "        self.add(prompt)\n",
        "        self.play(\n",
        "            GrowArrow(A_arrow),\n",
        "            FadeIn(A_word),\n",
        "        )\n",
        "        self.play(\n",
        "            GrowArrow(freq_arrow),\n",
        "            FadeIn(freq_word),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Answer\n",
        "        amp_tex = R\"\\frac{q \\vec{\\textbf{E}}_0}{m\\left(\\omega_r^2-\\omega_l^2\\right)}\"\n",
        "        solution = Tex(\n",
        "            fR\"\\vec{{\\textbf{{x}}}}(t) = {amp_tex} \\cos(\\omega_l t)\",\n",
        "            t2c=EQUATION_T2C\n",
        "        )\n",
        "        solution.move_to(np.array([3.85, 0.65, 0.0]))\n",
        "\n",
        "        self.play(\n",
        "            rect.animate.set_height(FRAME_HEIGHT, about_edge=UP, stretch=True).set_anim_args(run_time=2),\n",
        "            FadeOut(VGroup(\n",
        "                prompt[0],\n",
        "                A_arrow, A_word,\n",
        "                freq_arrow, freq_word\n",
        "            )),\n",
        "            TransformMatchingTex(\n",
        "                prompt[1], solution,\n",
        "                matched_pairs=[\n",
        "                    (prompt[1][R\"\\vec{\\textbf{x}}(t)\"], solution[R\"\\vec{\\textbf{x}}(t)\"]),\n",
        "                    (A_part, solution[amp_tex])\n",
        "                ]\n",
        "            ),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class StrongerResonanceStrongerPhaseShift(InteractiveScene):\n",
        "    def construct(self):\n",
        "        words = TexText(R\"Stronger resonance $\\rightarrow$ Bigger phase kick\", font_size=60)\n",
        "        words.to_edge(UP)\n",
        "        self.add(words)\n",
        "\n",
        "\n",
        "class WhyIsThisTrue(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        stds = self.students\n",
        "        morty = self.teacher\n",
        "        self.screen.to_corner(UR)\n",
        "        self.play(\n",
        "            stds[2].says(\"Why is it\\na phase shift?\", look_at=self.screen),\n",
        "            stds[1].change(\"confused\", self.screen),\n",
        "            stds[0].change(\"pondering\", self.screen),\n",
        "            morty.change(\"guilty\", stds[0].eyes)\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            self.change_students(\"pondering\", \"pleading\", \"maybe\", look_at=self.screen),\n",
        "            morty.change(\"hesitant\", self.screen)\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class QuestionsFromPatrons(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Questions\n",
        "        title = Text(\"Viewer questions about the index of refraction\", font_size=60)\n",
        "        title.to_edge(UP)\n",
        "        title.add(Underline(title))\n",
        "        title.set_color(BLUE)\n",
        "\n",
        "        questions = BulletedList(\n",
        "            \"Why does slowing imply bending?\",\n",
        "            \"What causes birefringence?\",\n",
        "            \"What's the end of the barber pole explanation?\",\n",
        "            \"How can the index of refraction be lower than 1?\",\n",
        "            buff=0.75\n",
        "        )\n",
        "        questions.next_to(title, DOWN, buff=1.0)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(title, lag_ratio=0.1),\n",
        "            LaggedStartMap(FadeIn, questions, shift=0.5 * DOWN, lag_ratio=0.25)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Higlight last three\n",
        "        last_three = questions[1:]\n",
        "        highlight_rect = SurroundingRectangle(last_three, buff=0.25)\n",
        "        highlight_rect.set_stroke(YELLOW, 2)\n",
        "        grey_rect = highlight_rect.copy().set_stroke(width=0).set_fill(GREY_E, 1)\n",
        "        back_rect = FullScreenRectangle().set_fill(BLACK, 0.9)\n",
        "        self.add(back_rect, grey_rect, highlight_rect, last_three)\n",
        "        self.play(\n",
        "            FadeIn(back_rect),\n",
        "            FadeIn(grey_rect),\n",
        "            DrawBorderThenFill(highlight_rect)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(FadeOut(back_rect), FadeOut(grey_rect), FadeOut(highlight_rect))\n",
        "\n",
        "        # Each question\n",
        "        background = FullScreenRectangle()\n",
        "        background.set_fill(interpolate_color(GREY_E, BLACK, 0.5), 1)\n",
        "\n",
        "        for question in questions:\n",
        "            question.save_state()\n",
        "            question.target = question.generate_target()\n",
        "            question.target[0].scale(0, about_point=question[1].get_left()).set_opacity(0)\n",
        "            question.target.center().to_edge(UP)\n",
        "\n",
        "            self.add(background, question)\n",
        "            self.play(\n",
        "                FadeIn(background),\n",
        "                MoveToTarget(question),\n",
        "            )\n",
        "            self.wait()\n",
        "            self.play(\n",
        "                Restore(question),\n",
        "                FadeOut(background),\n",
        "            )\n",
        "\n",
        "\n",
        "class HoldUpMainVideo(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Show previous video\n",
        "        thumbnail = get_bordered_thumbnail(\"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/Thumbnails/PrismThumbnail2.png\")\n",
        "        thumbnail.move_to(self.hold_up_spot, DOWN)\n",
        "\n",
        "        morty = self.teacher\n",
        "        self.play(\n",
        "            morty.change(\"raise_left_hand\"),\n",
        "            FadeIn(thumbnail, UP),\n",
        "            self.change_students(\"happy\", \"guilty\", \"erm\", look_at=thumbnail),\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        # Key points\n",
        "        key_points = VGroup(\n",
        "            Text(\"Key point #1: Phase kicks\"),\n",
        "            Text(\"Key point #2: Layer oscillations\"),\n",
        "            Text(\"Key point #3: Resonance\"),\n",
        "        )\n",
        "        key_points.scale(1.25)\n",
        "        key_points.set_backstroke(BLACK, 4)\n",
        "        key_points.to_edge(UP)\n",
        "        key_points[0].set_fill(BLUE)\n",
        "        key_points[0].save_state()\n",
        "        key_points.set_fill(WHITE)\n",
        "        key_points.scale(0.7)\n",
        "        key_points.arrange(DOWN, buff=0.5, aligned_edge=LEFT)\n",
        "        key_points.set_y(2).to_edge(RIGHT)\n",
        "        thumbnail.generate_target()\n",
        "        thumbnail.target.next_to(key_points, LEFT, buff=0.75)\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(thumbnail),\n",
        "            morty.change(\"raise_right_hand\", key_points),\n",
        "            self.change_students(\"pondering\", \"hesitant\", \"pondering\", look_at=thumbnail.target),\n",
        "            LaggedStartMap(FadeIn, key_points, shift=0.5 * LEFT, lag_ratio=0.5)\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            Restore(key_points[0]),\n",
        "            LaggedStartMap(FadeOut, key_points[1:], shift=DOWN),\n",
        "            LaggedStartMap(FadeOut, self.pi_creatures, shift=DOWN),\n",
        "            FadeOut(thumbnail, scale=0.5, shift=DOWN),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class HoldUpBarberPoleVideos(HoldUpMainVideo):\n",
        "    def construct(self):\n",
        "        # Show thumbnails\n",
        "        folder = \"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/Thumbnails/\"\n",
        "        thumbnails = Group(*(\n",
        "            get_bordered_thumbnail(os.path.join(folder, name), stroke_width=2)\n",
        "            for name in [\"CleanThumbnail\", \"Part2Thumbnail6\"]\n",
        "        ))\n",
        "        thumbnails.arrange(RIGHT, buff=1.0)\n",
        "        thumbnails.set_height(2.5)\n",
        "        thumbnails.move_to(self.hold_up_spot, DR)\n",
        "\n",
        "        morty = self.teacher\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\", thumbnails),\n",
        "            LaggedStartMap(FadeIn, thumbnails, shift=0.5 * UP, lag_ratio=0.5),\n",
        "            self.change_students(\"maybe\", \"erm\", \"happy\", look_at=thumbnails),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            self.change_students(\"confused\", \"maybe\"),\n",
        "            morty.animate.look_at(self.students)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            self.students[2].change(\"tease\", thumbnails)\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "\n",
        "class MissingDetails(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        title = Text(\"Details I skipped:\", font_size=72)\n",
        "        title.to_edge(UP)\n",
        "        title.add(Underline(title))\n",
        "        title.set_color(BLUE)\n",
        "\n",
        "        details = BulletedList(\n",
        "            \"There will be many resonant frequencies\",\n",
        "            \"Our force law should include a damping term\",\n",
        "            \"Why the wave produced by a plane of charges is a \\\\\\\\\" + \\\n",
        "            \"quarter-cycle out of phase with the incoming light\",\n",
        "            \"Everything related to the magnetic field\",\n",
        "            \"Whether accounting for quantum effects makes a difference\",\n",
        "        )\n",
        "        details.next_to(title, DOWN, buff=0.5)\n",
        "        details.set_fill(border_width=0)\n",
        "\n",
        "        self.add(title)\n",
        "        self.play(LaggedStartMap(FadeIn, details, shift=0.5 * DOWN, lag_ratio=0.35, run_time=3))\n",
        "        self.wait()\n",
        "        self.play(details.animate.fade_all_but(1))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ArrowOverInldexHalf(InteractiveScene):\n",
        "    speed = 1.0\n",
        "    index = 0.68\n",
        "    bounds = (-3, 3)\n",
        "\n",
        "    def construct(self):\n",
        "        arrow = Vector(0.5 * DOWN)\n",
        "        arrow.next_to(UP, UP)\n",
        "        arrow.to_edge(LEFT, buff=0)\n",
        "        x_min, x_max = self.bounds\n",
        "\n",
        "        def update_arrow(arr, dt):\n",
        "            step = dt * self.speed\n",
        "            if x_min < arr.get_x() < x_max:\n",
        "                step /= self.index\n",
        "            arr.shift(step * RIGHT)\n",
        "\n",
        "        arrow.add_updater(update_arrow)\n",
        "        self.add(arrow)\n",
        "        self.wait_until(lambda: arrow.get_x() > FRAME_WIDTH / 2 + 2 * arrow.get_width())\n",
        "\n",
        "\n",
        "class SteadyStateSolutionCircledAmplitude(InteractiveScene):\n",
        "    def construct(self):\n",
        "        equation = Tex(\n",
        "            R\"\"\"\n",
        "                \\vec{\\textbf{x}}(t) = \n",
        "                \\cos(\\omega_l t) \\cdot\n",
        "                \\frac{q ||\\vec{\\textbf{E}}_0||}{m\\left(\\omega_r^2-\\omega_l^2\\right)}\n",
        "            \"\"\",\n",
        "            t2c=EQUATION_T2C\n",
        "        )\n",
        "        equation.set_backstroke(BLACK, 5)\n",
        "\n",
        "        rect = SurroundingRectangle(equation[R\"\\frac{q ||\\vec{\\textbf{E}}_0||}{m\\left(\\omega_r^2-\\omega_l^2\\right)}\"])\n",
        "        rect.set_stroke(TEAL)\n",
        "\n",
        "        self.add(equation)\n",
        "        self.play(ShowCreation(rect))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class LimitToContinuity(InteractiveScene):\n",
        "    def construct(self):\n",
        "        arrow = Arrow(3 * UP, 3 * DOWN, buff=0, stroke_width=10, stroke_color=YELLOW)\n",
        "        words = Text(\"Continuous in\\nthe limit\", font_size=60)\n",
        "        words.next_to(arrow, RIGHT, buff=0.5)\n",
        "        self.play(\n",
        "            GrowArrow(arrow),\n",
        "            FadeIn(words),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class KickForwardOrBackCondition(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # First statement\n",
        "        words = VGroup(\n",
        "            TexText(\"If this $< 0$\"),\n",
        "            TexText(\"Refractive Index $< 1$\", font_size=48),\n",
        "        )\n",
        "        rect = Rectangle(2, 1)\n",
        "        rect.next_to(LEFT, LEFT, buff=MED_LARGE_BUFF).set_y(1.9)\n",
        "        words[0].next_to(rect, UP, MED_SMALL_BUFF)\n",
        "        words[1].set_y(1.5)\n",
        "        words[1].set_x(FRAME_WIDTH / 4)\n",
        "\n",
        "        arrow = Arrow(words[0].get_right(), words[1].get_left())\n",
        "        arrow.set_stroke(YELLOW, 6)\n",
        "\n",
        "        self.play(Write(words[0]))\n",
        "        self.play(\n",
        "            GrowArrow(arrow),\n",
        "            FadeIn(words[1], RIGHT)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Freq reference\n",
        "        freq_ineq = Tex(R\"\\text{If } \\omega_l > \\omega_r\", t2c=EQUATION_T2C)\n",
        "        freq_ineq.move_to(words[0])\n",
        "\n",
        "        lf_rect = SurroundingRectangle(freq_ineq[R\"\\omega_l\"])\n",
        "        rf_rect = SurroundingRectangle(freq_ineq[R\"\\omega_r\"])\n",
        "\n",
        "        lf_words = Text(\"Light frequency\", font_size=36)\n",
        "        rf_words = Text(\"Resonant frequency\", font_size=36)\n",
        "        lf_words.next_to(lf_rect, UP)\n",
        "        rf_words.next_to(rf_rect, UP)\n",
        "\n",
        "        VGroup(lf_rect, rf_rect).set_stroke(width=2)\n",
        "        VGroup(lf_rect, lf_words).set_color(EQUATION_T2C[R\"\\omega_l\"])\n",
        "        VGroup(rf_rect, rf_words).set_color(EQUATION_T2C[R\"\\omega_r\"])\n",
        "\n",
        "        words[0].generate_target()\n",
        "        words[0].target.next_to(rect, RIGHT, SMALL_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            # MoveToTarget(words[0]),\n",
        "            # arrow.animate.put_start_and_end_on(\n",
        "            #     words[0].target.get_right() + SMALL_BUFF * RIGHT,\n",
        "            #     arrow.get_end(),\n",
        "            # ),\n",
        "            FadeOut(words[0], 0.5 * UP),\n",
        "            FadeIn(freq_ineq, 0.5 * UP),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(lf_rect),\n",
        "            FadeIn(lf_words, shift=0.25 * UP),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            ReplacementTransform(lf_rect, rf_rect),\n",
        "            FadeTransform(lf_words, rf_words),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(FadeOut(rf_words), FadeOut(rf_rect))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ThisReallyDoesHappen(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        self.play(\n",
        "            self.teacher.says(\"This really\\ndoes happen!\", mode=\"surprised\"),\n",
        "        )\n",
        "        self.play(self.change_students(\"sassy\", \"confused\", \"pleading\", look_at=self.screen))\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class LookAround(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        circle = Circle(radius=2)\n",
        "        circle.stretch(1.5, 0)\n",
        "        arrows = VGroup(*(\n",
        "            Arrow(v, 2 * v, buff=0, stroke_width=8, stroke_color=GREY_B)\n",
        "            for alpha in np.arange(0, 1, 1 / 12)\n",
        "            for v in [circle.pfp(alpha)]\n",
        "        ))\n",
        "        words1 = Text(\"Look\\naround\", font_size=90)\n",
        "        words2 = Text(\"Most things\\nare opaque\", font_size=72)\n",
        "\n",
        "        self.add(words1)\n",
        "        self.play(LaggedStartMap(GrowArrow, arrows, lag_ratio=0.2))\n",
        "        self.wait()\n",
        "        self.play(FadeTransform(words1, words2))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class CausalInfluence(InteractiveScene):\n",
        "    def construct(self):\n",
        "        words = TexText(R\"No causal influence can \\\\ propagate faster than $c$\", font_size=72)\n",
        "        c = words[\"$c$\"]\n",
        "        c.set_color(YELLOW)\n",
        "        rect = SurroundingRectangle(c)\n",
        "        arrow = Vector(UP)\n",
        "        arrow.set_color(YELLOW)\n",
        "        arrow.next_to(rect, DOWN)\n",
        "\n",
        "        self.add(words)\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            GrowArrow(arrow),\n",
        "            ShowCreation(rect),\n",
        "            FlashAround(c),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class RightLeftArrow(InteractiveScene):\n",
        "    def construct(self):\n",
        "        vect = Vector(DOWN)\n",
        "        vect.to_edge(RIGHT)\n",
        "        self.play(vect.animate.to_edge(LEFT), run_time=24, rate_func=linear)\n",
        "\n",
        "\n",
        "class SameRotationRate(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        words = Text(\"Same rate\\nof rotation\", font_size=60)\n",
        "        words.to_edge(RIGHT)\n",
        "        arrows = VGroup(*(\n",
        "            Arrow(words.get_corner(corner), y * UP + 1.25 * RIGHT, buff=0.2)\n",
        "            for y, corner in zip([2.75, 0, -2.75], [UL, LEFT, DL])\n",
        "        ))\n",
        "        self.play(\n",
        "            Write(words),\n",
        "            LaggedStartMap(GrowArrow, arrows)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class IOREndScreen(PatreonEndScreen):\n",
        "    pass\n"
    ]
}