{
    "topic": "The mathematical concept being demonstrated is the relationship between velocity and time for a moving object. The code creates",
    "code": [
        "#!/usr/bin/env python\n",
        "# -*- coding: utf-8 -*-\n",
        "\n",
        "\n",
        "from manim_imports_ext import *\n",
        "\n",
        "\n",
        "class SimpleVelocityGraph(GraphScene):\n",
        "    CONFIG = {\n",
        "        # \"frame_rate\" : 4000,\n",
        "        # \"domino_thickness\" : 7.5438,\n",
        "        # \"domino_spacing\" : 8.701314282,\n",
        "        \"data_files\" : [\n",
        "            \"data07.txt\",\n",
        "            \"data13.txt\",\n",
        "            # \"data11.txt\",\n",
        "        ],\n",
        "        \"colors\" : [WHITE, BLUE, YELLOW, GREEN, MAROON_B],\n",
        "        \"x_axis_label\" : \"$t$\",\n",
        "        \"y_axis_label\" : \"$v$\",\n",
        "        \"x_min\" : 0,\n",
        "        \"x_max\" : 1.8,\n",
        "        \"x_tick_frequency\" : 0.1,\n",
        "        \"x_labeled_nums\" : np.arange(0, 1.8, 0.2),\n",
        "        \"y_tick_frequency\" : 100,\n",
        "        \"y_min\" : 0,\n",
        "        \"y_max\" : 1000,\n",
        "        \"y_labeled_nums\" : list(range(0, 1000, 200)),\n",
        "        \"x_axis_width\" : 12,\n",
        "        \"graph_origin\" : 2.5*DOWN + 5*LEFT,\n",
        "        \"trailing_average_length\" : 20,\n",
        "        \"include_domino_thickness\" : False,\n",
        "    }\n",
        "    def construct(self):\n",
        "        self.setup_axes()\n",
        "        # self.save_all_images()\n",
        "        for data_file, color in zip(self.data_files, self.colors):\n",
        "            self.init_data(data_file)\n",
        "            self.draw_dots(color)\n",
        "            self.add_label_to_last_dot(\n",
        "                \"%s %s %.2f\"%(\n",
        "                    data_file[4:6], \n",
        "                    \"hard\" if self.friction == \"low\" else \"felt\",\n",
        "                    self.domino_spacing,\n",
        "                ),\n",
        "                color\n",
        "            )\n",
        "            self.draw_lines(color)\n",
        "\n",
        "    def save_all_images(self):\n",
        "        indices = list(range(1, 20))\n",
        "        for i1, i2 in it.combinations(indices, 2):\n",
        "            to_remove = VGroup()\n",
        "            for index in i1, i2:\n",
        "                index_str = (\"%.2f\"%float(0.01*index))[-2:]\n",
        "                data_file = \"data%s.txt\"%index_str\n",
        "                self.init_data(data_file)\n",
        "                color = WHITE if self.friction == \"low\" else BLUE\n",
        "                self.draw_dots(color)\n",
        "                self.add_label_to_last_dot(\n",
        "                    \"%s %s %.2f\"%(\n",
        "                        data_file[4:6], \n",
        "                        \"hard\" if self.friction == \"low\" else \"felt\",\n",
        "                        self.domino_spacing,\n",
        "                    ),\n",
        "                    color\n",
        "                )\n",
        "                self.draw_lines(color)\n",
        "                to_remove.add(self.dots, self.lines, self.label)\n",
        "            self.save_image(\"dominos_%d_vs_%d\"%(i1, i2))\n",
        "            self.remove(to_remove)\n",
        "\n",
        "    def init_data(self, data_file):\n",
        "        file_name = os.path.join(\n",
        "            os.path.dirname(os.path.realpath(__file__)),\n",
        "            \"dominos\",\n",
        "            data_file\n",
        "        )\n",
        "\n",
        "        file = open(file_name, \"r\")\n",
        "        frames, notes = [], []\n",
        "        for line in file:\n",
        "            line = line.replace(\"  \", \",\")\n",
        "            line = line.replace(\"\\n\", \"\")\n",
        "            entries = [s for s in line.split(\",\") if s is not \"\"]\n",
        "            if len(entries) == 0:\n",
        "                continue\n",
        "\n",
        "            if entries[0] == \"framerate\":\n",
        "                frame_rate = float(entries[1])\n",
        "            elif entries[0] == \"domino spacing\":\n",
        "                domino_spacing = float(entries[1])\n",
        "            elif entries[0] == \"domino thickness\":\n",
        "                domino_thickness = float(entries[1])\n",
        "            elif entries[0] == \"friction\":\n",
        "                self.friction = entries[1]\n",
        "            else:\n",
        "                try:\n",
        "                    frames.append(int(entries[0]))\n",
        "                except:\n",
        "                    continue #How to treat?\n",
        "                    # frames.append(frames[-1] + (frames[-1] - frames[-2]))\n",
        "                if len(entries) > 1:\n",
        "                    notes.append(entries[1])\n",
        "                else:\n",
        "                    notes.append(\"\")\n",
        "        frames = np.array(frames)\n",
        "\n",
        "        self.times = (frames - frames[0])/float(frame_rate)\n",
        "        delta_times = self.times[1:] - self.times[:-1]\n",
        "        if self.include_domino_thickness:\n",
        "            distance = domino_spacing+domino_thickness\n",
        "        else:\n",
        "            distance = domino_spacing\n",
        "        self.velocities = distance/delta_times\n",
        "        self.notes = notes\n",
        "\n",
        "        n = self.trailing_average_length\n",
        "        self.velocities = np.array([\n",
        "            np.mean(self.velocities[max(0, i-n):i])\n",
        "            for i in range(len(self.velocities))\n",
        "        ])\n",
        "        self.domino_spacing = domino_spacing\n",
        "        self.domino_thickness = domino_thickness\n",
        "\n",
        "    def draw_dots(self, color = WHITE):\n",
        "        dots = VGroup()\n",
        "        for time, v, note in zip(self.times, self.velocities, self.notes):\n",
        "            dot = Dot(color = color)\n",
        "            dot.scale(0.5)\n",
        "            dot.move_to(self.coords_to_point(time, v))\n",
        "            self.add(dot)\n",
        "            dots.add(dot)\n",
        "            if note == \"twist\":\n",
        "                dot.set_color(RED)\n",
        "        self.dots = dots\n",
        "\n",
        "    def add_label_to_last_dot(self, label, color = WHITE):\n",
        "        dot = self.dots[-1]\n",
        "        label = OldTexText(label)\n",
        "        label.scale(0.75)\n",
        "        label.next_to(dot, UP, buff = MED_SMALL_BUFF)\n",
        "        label.set_color(color)\n",
        "        label.shift_onto_screen()\n",
        "        self.label = label\n",
        "        self.add(label)\n",
        "\n",
        "    def draw_lines(self, color = WHITE, stroke_width = 2):\n",
        "        lines = VGroup()\n",
        "        for d1, d2 in zip(self.dots, self.dots[1:]):\n",
        "            line = Line(d1.get_center(), d2.get_center())\n",
        "            lines.add(line)\n",
        "        lines.set_stroke(color, stroke_width)\n",
        "        self.add(lines, self.dots)\n",
        "        self.lines = lines\n",
        "\n",
        "ALL_VELOCITIES = {\n",
        "    10 : [\n",
        "        0.350308642,\n",
        "        0.3861880046,\n",
        "        0.8665243271,\n",
        "        0.9738947062,\n",
        "        0.8087560386,\n",
        "        1.067001275,\n",
        "        0.9059117965,\n",
        "        1.113855622,\n",
        "        0.9088626493,\n",
        "        1.504155436,\n",
        "        1.347926731,\n",
        "        1.274067732,\n",
        "        1.242854491,\n",
        "        1.118319973,\n",
        "        1.177303094,\n",
        "        1.202676006,\n",
        "        0.9965029762,\n",
        "        1.558775605,\n",
        "        1.472405453,\n",
        "        1.357765612,\n",
        "        1.200089606,\n",
        "        1.285810292,\n",
        "        1.138860544,\n",
        "        1.322373618,\n",
        "        1.51230804,\n",
        "        1.148233882,\n",
        "        1.276983219,\n",
        "        1.150601375,\n",
        "        1.492090018,\n",
        "        1.210502531,\n",
        "        1.221097739,\n",
        "        1.141189502,\n",
        "        1.364405053,\n",
        "        1.608189241,\n",
        "        1.223775585,\n",
        "        1.174824561,\n",
        "        1.069045338,\n",
        "        1.468530702,\n",
        "        1.733048654,\n",
        "        1.328670635,\n",
        "        1.118319973,\n",
        "        1.143528005,\n",
        "        1.010945048,\n",
        "        1.430876068,\n",
        "        1.395104167,\n",
        "        1.018324209,\n",
        "        1.405646516,\n",
        "        1.120565596,\n",
        "        1.24562872,\n",
        "        1.65590999,\n",
        "        1.276983219,\n",
        "        1.282854406,\n",
        "        1.338229416,\n",
        "        1.240092593,\n",
        "        0.9982856291,\n",
        "        1.811823593,\n",
        "        1.328670635,\n",
        "        1.167451185,\n",
        "        1.27991208,\n",
        "        1.221097739,\n",
        "        1.022054335,\n",
        "        1.160169785,\n",
        "        1.805960086,\n",
        "        0.9965029762,\n",
        "        1.449458874,\n",
        "        1.603568008,\n",
        "        1.234605457,\n",
        "        1.210502531,\n",
        "        1.192396724,\n",
        "        1.020185862,\n",
        "        1.496090259,\n",
        "        1.322373618,\n",
        "        1.291763117,\n",
        "        1.210502531,\n",
        "        0.9807410662,\n",
        "        1.341446314,\n",
        "        1.391625104,\n",
        "        1.480216622,\n",
        "        1.148233882,\n",
        "        1.125084005,\n",
        "        1.670783433,\n",
        "        1.118319973,\n",
        "        1.174824561,\n",
        "        1.395104167,\n",
        "        1.167451185,\n",
        "        1.182291667,\n",
        "        1.696175279,\n",
        "        1.306889149,\n",
        "        1.430876068,\n",
        "        1.048950501,\n",
        "        1.823665577,\n",
        "        1.24562872,\n",
        "    ],\n",
        "    13 : [\n",
        "        0.2480920273,\n",
        "        0.3532654568,\n",
        "        0.549163523,\n",
        "        0.5979017857,\n",
        "        0.6643353175,\n",
        "        0.8495940117,\n",
        "        1.037573598,\n",
        "        0.897413562,\n",
        "        1.410977665,\n",
        "        0.9180833562,\n",
        "        1.303328143,\n",
        "        0.9324004456,\n",
        "        2.026785714,\n",
        "        0.9721980256,\n",
        "        1.339835934,\n",
        "        1.002770291,\n",
        "        2.3797086,\n",
        "        1.235972684,\n",
        "        1.508900406,\n",
        "        1.239174685,\n",
        "        1.374486864,\n",
        "        1.181040564,\n",
        "        1.144309638,\n",
        "        1.195803571,\n",
        "        1.265400605,\n",
        "        1.223328462,\n",
        "        1.678320802,\n",
        "        1.198800573,\n",
        "        0.7958759211,\n",
        "        1.573425752,\n",
        "        1.046655205,\n",
        "        2.009753902,\n",
        "        1.42782516,\n",
        "        1.289276088,\n",
        "        1.347384306,\n",
        "        1.299786491,\n",
        "        1.06530385,\n",
        "        1.339835934,\n",
        "        1.242393321,\n",
        "        1.053571429,\n",
        "        1.317689886,\n",
        "        1.626943635,\n",
        "        1.112375415,\n",
        "        1.362739113,\n",
        "        0.9110884354,\n",
        "        1.578618576,\n",
        "        1.853959025,\n",
        "        1.504155436,\n",
        "        1.158163265,\n",
        "        1.262061817,\n",
        "        1.060579664,\n",
        "        1.122820255,\n",
        "        1.594404762,\n",
        "        1.27552381,\n",
        "        1.382431874,\n",
        "        1.109794498,\n",
        "        1.303328143,\n",
        "        1.160974341,\n",
        "        1.296264034,\n",
        "        1.092058056,\n",
        "        1.077300515,\n",
        "        1.462756662,\n",
        "        1.317689886,\n",
        "        1.390469269,\n",
        "        1.099589491,\n",
        "        1.649384236,\n",
        "        1.467243646,\n",
        "        1.402702137,\n",
        "        1.092058056,\n",
        "        1.201812635,\n",
        "        1.258740602,\n",
        "        1.321329913,\n",
        "        1.272131459,\n",
        "        1.175236925,\n",
        "        1.181040564,\n",
        "        1.296264034,\n",
        "        1.24562872,\n",
        "        1.358867695,\n",
        "        1.332371667,\n",
        "        1.296264034,\n",
        "        1.217102872,\n",
        "        1.169490045,\n",
        "        1.114968365,\n",
        "        1.528183478,\n",
        "        1.374486864,\n",
        "        1.223328462,\n",
        "        1.324990107,\n",
        "        1.268757105,\n",
        "        1.169490045,\n",
        "        1.578618576,\n",
        "    ],\n",
        "    14 : [\n",
        "        0.4905860806,\n",
        "        0.6236263736,\n",
        "        0.71391258,\n",
        "        0.8436004031,\n",
        "        1.048950501,\n",
        "        0.9585599771,\n",
        "        1.138860544,\n",
        "        1.210940325,\n",
        "        1.27552381,\n",
        "        1.282363079,\n",
        "        1.166637631,\n",
        "        1.242393321,\n",
        "        1.163799096,\n",
        "        1.166637631,\n",
        "        1.42357568,\n",
        "        1.382431874,\n",
        "        1.278934301,\n",
        "        1.390469269,\n",
        "        1.181040564,\n",
        "        1.107225529,\n",
        "        1.08462909,\n",
        "        1.160974341,\n",
        "        1.374486864,\n",
        "        1.382431874,\n",
        "        1.355018211,\n",
        "        1.25543682,\n",
        "        1.192821518,\n",
        "        0.9360497624,\n",
        "        1.449458874,\n",
        "        1.370548506,\n",
        "        1.485470275,\n",
        "        1.471758242,\n",
        "        1.149811126,\n",
        "        1.217102872,\n",
        "        1.152581756,\n",
        "        1.402702137,\n",
        "        1.155365769,\n",
        "        1.141578588,\n",
        "        1.248881015,\n",
        "        1.074879615,\n",
        "        1.453864525,\n",
        "        1.303328143,\n",
        "        1.248881015,\n",
        "        1.169490045,\n",
        "        1.214013778,\n",
        "        1.220207726,\n",
        "        1.310469667,\n",
        "        1.42357568,\n",
        "        1.163799096,\n",
        "        1.220207726,\n",
        "        1.141578588,\n",
        "        1.207882395,\n",
        "        1.104668426,\n",
        "        1.328670635,\n",
        "        1.25543682,\n",
        "        1.239174685,\n",
        "        1.169490045,\n",
        "        1.149811126,\n",
        "        1.000672445,\n",
        "        1.144309638,\n",
        "        1.232787187,\n",
        "        1.268757105,\n",
        "        1.306889149,\n",
        "        1.538011024,\n",
        "        1.355018211,\n",
        "        1.347384306,\n",
        "        1.223328462,\n",
        "        1.149811126,\n",
        "        1.158163265,\n",
        "        1.24562872,\n",
        "        1.485470275,\n",
        "        1.339835934,\n",
        "        1.314069859,\n",
        "        1.235972684,\n",
        "        1.265400605,\n",
        "        1.181040564,\n",
        "        1.638087084,\n",
        "        1.568266979,\n",
        "        1.299786491,\n",
        "        1.278934301,\n",
        "        1.336093376,\n",
        "        1.089570452,\n",
        "        1.004876951,\n",
        "        1.089570452,\n",
        "        1.282363079,\n",
        "        1.449458874,\n",
        "        1.370548506,\n",
        "        1.265400605,\n",
        "        1.143215651,\n",
        "    ],\n",
        "    15 : [\n",
        "        1.087094156,\n",
        "        1.223328462,\n",
        "        1.563141923,\n",
        "        1.394523115,\n",
        "        1.268757105,\n",
        "        1.513675407,\n",
        "        1.436400686,\n",
        "        1.094557045,\n",
        "        0.9761661808,\n",
        "        1.072469571,\n",
        "        1.178131597,\n",
        "        1.366632653,\n",
        "        1.258740602,\n",
        "        1.25543682,\n",
        "        1.285810292,\n",
        "        1.235972684,\n",
        "        1.347384306,\n",
        "        1.239174685,\n",
        "        1.195803571,\n",
        "        1.186901808,\n",
        "        1.141578588,\n",
        "        1.152581756,\n",
        "        1.136155412,\n",
        "        1.102123107,\n",
        "        1.242393321,\n",
        "        1.347384306,\n",
        "        1.278934301,\n",
        "        1.366632653,\n",
        "        1.351190476,\n",
        "        0.9882674144,\n",
        "        1.1898543,\n",
        "        1.351190476,\n",
        "        1.169490045,\n",
        "        1.292760618,\n",
        "        1.638087084,\n",
        "        1.436400686,\n",
        "        1.328670635,\n",
        "        1.242393321,\n",
        "        1.355018211,\n",
        "        1.303328143,\n",
        "        1.186901808,\n",
        "        1.112375415,\n",
        "        1.432100086,\n",
        "        1.1898543,\n",
        "        1.324990107,\n",
        "        1.074879615,\n",
        "        1.214013778,\n",
        "        1.20483987,\n",
        "        1.158163265,\n",
        "        1.112375415,\n",
        "        1.220207726,\n",
        "        1.402702137,\n",
        "        1.268757105,\n",
        "        1.282363079,\n",
        "        1.289276088,\n",
        "        1.292760618,\n",
        "        1.183963932,\n",
        "        1.252150337,\n",
        "        1.42782516,\n",
        "        1.292760618,\n",
        "        1.026440834,\n",
        "        1.268757105,\n",
        "        1.268757105,\n",
        "        1.285810292,\n",
        "        1.347384306,\n",
        "        1.272131459,\n",
        "        1.220207726,\n",
        "        1.296264034,\n",
        "        1.25543682,\n",
        "        1.494754464,\n",
        "        1.347384306,\n",
        "        1.214013778,\n",
        "        1.169490045,\n",
        "        1.147053786,\n",
        "        1.082175178,\n",
        "        1.109794498,\n",
        "        1.382431874,\n",
        "        1.24562872,\n",
        "        1.201812635,\n",
        "        1.328670635,\n",
        "        1.122820255,\n",
        "        1.220207726,\n",
        "        1.192821518,\n",
        "        1.563141923,\n",
        "        1.41935142,\n",
        "        1.336093376,\n",
        "        1.406827731,\n",
        "        1.258740602,\n",
        "        1.186901808,\n",
        "        1.232787187,\n",
        "        1.107225529,\n",
        "    ],\n",
        "\n",
        "}\n",
        "# Felt: 8,9,10,11,12,13\n",
        "# Hardwood 1-7, 14,15\n",
        "\n",
        "class ContrastTwoGraphs(SimpleVelocityGraph):\n",
        "    CONFIG = {\n",
        "        \"velocities1_index\" : 13,\n",
        "        \"velocities2_index\" : 14,\n",
        "        \"x_min\" : -1,\n",
        "        \"x_max\" : 10,\n",
        "        \"y_min\" : -0.25,\n",
        "        \"y_max\" : 2,\n",
        "        \"x_axis_label\" : \"\",\n",
        "        \"y_axis_label\" : \"\",\n",
        "        \"x_labeled_nums\" : [],\n",
        "        \"y_labeled_nums\" : [],\n",
        "        \"y_tick_frequency\" : 0.25,\n",
        "        \"x_tick_frequency\" : 12,\n",
        "        \"moving_average_n\" : 20,\n",
        "    }\n",
        "    def construct(self):\n",
        "        self.setup_axes()\n",
        "        velocities1 = ALL_VELOCITIES[self.velocities1_index]\n",
        "        velocities2 = ALL_VELOCITIES[self.velocities2_index]\n",
        "\n",
        "        self.n_data_points = len(velocities1)\n",
        "        graph1 = self.get_velocity_graph(velocities1)\n",
        "        graph2 = self.get_velocity_graph(velocities2)\n",
        "        smoothed_graph1 = self.get_smoothed_velocity_graph(velocities1)\n",
        "        smoothed_graph2 = self.get_smoothed_velocity_graph(velocities2)\n",
        "        for graph in graph1, smoothed_graph1:\n",
        "            self.color_graph(graph)\n",
        "        for graph in graph2, smoothed_graph2:\n",
        "            self.color_graph(graph, BLUE, RED)\n",
        "        for graph in graph1, graph2, smoothed_graph1, smoothed_graph2:\n",
        "            graph.axes = self.axes.deepcopy()\n",
        "            graph.add_to_back(graph.axes)\n",
        "\n",
        "        lower_left = self.axes.get_corner(DOWN+LEFT)\n",
        "        self.remove(self.axes)\n",
        "\n",
        "        felt = OldTexText(\"Felt\")\n",
        "        hardwood = OldTexText(\"Hardwood\")\n",
        "        hardwood.set_color(RED)\n",
        "        words = VGroup(felt, hardwood)\n",
        "\n",
        "        self.force_skipping()\n",
        "\n",
        "        #Show jaggediness\n",
        "        graph1.scale(0.5).to_edge(UP)\n",
        "        graph2.scale(0.5).to_edge(DOWN)\n",
        "        felt.next_to(graph1, LEFT, buff = 0.75)\n",
        "        hardwood.next_to(graph2, LEFT, buff = 0.75)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(graph1, run_time = 3, rate_func=linear),\n",
        "            Write(felt)\n",
        "        )\n",
        "        self.play(\n",
        "            ShowCreation(graph2, run_time = 4, rate_func=linear),\n",
        "            Write(hardwood)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        for g, sg in (graph1, smoothed_graph1), (graph2, smoothed_graph2):\n",
        "            sg_copy = sg.deepcopy()\n",
        "            sg_copy.scale(0.5)\n",
        "            sg_copy.shift(g.get_center())\n",
        "            mover = VGroup(*it.chain(*list(zip(g.dots, g.lines))))\n",
        "            target = VGroup(*it.chain(*list(zip(sg_copy.dots, sg_copy.lines))))\n",
        "            for m, t in zip(mover, target):\n",
        "                m.target = t\n",
        "            self.play(LaggedStartMap(\n",
        "                MoveToTarget, mover,\n",
        "                rate_func = lambda t : 0.3*wiggle(t),\n",
        "                run_time = 3,\n",
        "                lag_ratio = 0.2,\n",
        "            ))\n",
        "        twists = OldTexText(\"Twists?\")\n",
        "        variable_distances = OldTexText(\"Variable distances\")\n",
        "        for word in twists, variable_distances:\n",
        "            word.to_corner(UP+RIGHT)\n",
        "        self.play(Write(twists))\n",
        "        self.wait()\n",
        "        self.play(ReplacementTransform(twists, variable_distances))\n",
        "        self.wait(3)\n",
        "        self.play(FadeOut(variable_distances))\n",
        "\n",
        "        self.revert_to_original_skipping_status()\n",
        "        self.play(\n",
        "            graph1.scale, 2,\n",
        "            graph1.move_to, lower_left, DOWN+LEFT,\n",
        "            graph2.scale, 2,\n",
        "            graph2.move_to, lower_left, DOWN+LEFT,\n",
        "            FadeOut(words)\n",
        "        )\n",
        "        self.wait()\n",
        "        return\n",
        "\n",
        "        #Show moving averages\n",
        "        self.play(FadeOut(graph2))\n",
        "\n",
        "        dots = graph1.dots\n",
        "        dot1, dot2 = dots[21], dots[41]\n",
        "        rect = Rectangle(\n",
        "            width = dot2.get_center()[0] - dot1.get_center()[0],\n",
        "            height = FRAME_Y_RADIUS - self.x_axis.get_center()[1],\n",
        "            stroke_width = 0,\n",
        "            fill_color = YELLOW,\n",
        "            fill_opacity = 0.5\n",
        "        )\n",
        "        rect.move_to(dot2.get_center(), RIGHT)\n",
        "        rect.to_edge(UP, buff = 0)\n",
        "        pre_rect = rect.copy()\n",
        "        pre_rect.stretch_to_fit_width(0)\n",
        "        pre_rect.move_to(rect, RIGHT)\n",
        "\n",
        "        arrow = Vector(DOWN)\n",
        "        arrow.next_to(dot2, UP, SMALL_BUFF)\n",
        "\n",
        "        self.play(GrowArrow(arrow))\n",
        "        self.play(\n",
        "            dot2.shift, MED_SMALL_BUFF*UP,\n",
        "            dot2.set_color, PINK,\n",
        "            rate_func = wiggle\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(arrow),\n",
        "            ReplacementTransform(pre_rect, rect),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Transform(graph1, smoothed_graph1, run_time = 2),\n",
        "            Animation(rect)\n",
        "        )\n",
        "        self.play(FadeOut(rect))\n",
        "        self.wait()\n",
        "        self.play(FadeIn(graph2))\n",
        "        self.play(Transform(graph2, smoothed_graph2))\n",
        "\n",
        "        felt.next_to(dot2, UP, MED_LARGE_BUFF)\n",
        "        hardwood.next_to(felt, DOWN, LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeIn, felt),\n",
        "            LaggedStartMap(FadeIn, hardwood),\n",
        "            run_time = 1\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        #Compare regions\n",
        "        dot_group1 = VGroup(\n",
        "            *graph1.dots[35:75] + graph2.dots[35:75]\n",
        "        )\n",
        "        dot_group2 = VGroup(\n",
        "            *graph1.dots[75:] + graph2.dots[75:]\n",
        "        )\n",
        "        dot_group3 = VGroup(\n",
        "            *graph1.dots[35:] + graph2.dots[35:]\n",
        "        )\n",
        "        rect1 = SurroundingRectangle(dot_group1)\n",
        "        rect2 = SurroundingRectangle(dot_group2)\n",
        "        rect3 = SurroundingRectangle(dot_group3)\n",
        "\n",
        "        self.play(ShowCreation(rect1))\n",
        "        for x in range(2):\n",
        "            self.play(LaggedStartMap(\n",
        "                ApplyMethod, dot_group1,\n",
        "                lambda m : (m.scale, 0.5),\n",
        "                rate_func = wiggle,\n",
        "                lag_ratio = 0.05,\n",
        "                run_time = 3,\n",
        "            ))\n",
        "        self.wait()\n",
        "        self.play(ReplacementTransform(rect1, rect2))\n",
        "        for x in range(2):\n",
        "            self.play(LaggedStartMap(\n",
        "                ApplyMethod, dot_group2,\n",
        "                lambda m : (m.scale, 0.5),\n",
        "                rate_func = wiggle,\n",
        "                lag_ratio = 0.05,\n",
        "                run_time = 3,\n",
        "            ))\n",
        "        self.wait()\n",
        "        self.play(ReplacementTransform(rect1, rect3))\n",
        "        for x in range(2):\n",
        "            self.play(LaggedStartMap(\n",
        "                ApplyMethod, dot_group3,\n",
        "                lambda m : (m.scale, 0.5),\n",
        "                rate_func = wiggle,\n",
        "                lag_ratio = 0.05,\n",
        "                run_time = 3,\n",
        "            ))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "    ###\n",
        "\n",
        "    def color_graph(self, graph, color1 = BLUE, color2 = WHITE, n_starts = 20):\n",
        "        graph.set_color(color2)\n",
        "        VGroup(*graph.dots[:11] + graph.lines[:10]).set_color(color1)\n",
        "\n",
        "    def get_smoothed_velocity_graph(self, velocities):\n",
        "        n = self.moving_average_n\n",
        "        smoothed_vs = np.array([\n",
        "            np.mean(velocities[max(0, i-n):i])\n",
        "            for i in range(len(velocities))\n",
        "        ])\n",
        "        return self.get_velocity_graph(smoothed_vs)\n",
        "\n",
        "    def get_velocity_graph(self, velocities):\n",
        "        n = len(velocities)\n",
        "        dots = VGroup(self.get_dot(1, velocities[0]))\n",
        "        lines = VGroup()\n",
        "        for x in range(1, n):\n",
        "            dots.add(self.get_dot(x+1, velocities[x]))\n",
        "            lines.add(Line(\n",
        "                dots[-2].get_center(),\n",
        "                dots[-1].get_center(),\n",
        "            ))\n",
        "        graph = VGroup(dots, lines)\n",
        "        graph.dots = dots\n",
        "        graph.lines = lines\n",
        "\n",
        "        return graph\n",
        "\n",
        "    def get_dot(self, x, y):\n",
        "        dot = Dot(radius = 0.05)\n",
        "        dot.move_to(self.coords_to_point(\n",
        "            x * float(self.x_max) / self.n_data_points, y\n",
        "        ))\n",
        "        return dot\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "class ShowAllSteadyStateVelocities(SimpleVelocityGraph):\n",
        "    CONFIG = {\n",
        "        \"x_axis_label\" : \"\\\\text{Domino spacing}\",\n",
        "        \"x_min\" : 0,\n",
        "        \"x_max\" : 40,\n",
        "        \"x_axis_width\" : 9,\n",
        "        \"x_tick_frequency\" : 5,\n",
        "        \"x_labeled_nums\" : list(range(0, 50, 10)),\n",
        "        \"y_min\" : 0,\n",
        "        \"y_max\" : 400,\n",
        "        \"y_labeled_nums\" : [],\n",
        "        # \"y_labeled_nums\" : range(200, 1400, 200),\n",
        "    }\n",
        "    def construct(self):\n",
        "        self.setup_axes()\n",
        "        for index in range(1, 20):\n",
        "            index_str = (\"%.2f\"%float(0.01*index))[-2:]\n",
        "            data_file = \"data%s.txt\"%index_str\n",
        "            self.init_data(data_file)\n",
        "            color = WHITE if self.friction == \"low\" else BLUE\n",
        "            label = OldTexText(\n",
        "                index_str,\n",
        "                color = color\n",
        "            )\n",
        "            label.scale(0.5)\n",
        "            label.set_color(color)\n",
        "\n",
        "            dot = Dot(color = color)\n",
        "            dot.scale(0.5)\n",
        "            dot.move_to(self.coords_to_point(\n",
        "                self.domino_spacing, self.velocities[-1] - 400\n",
        "            ))\n",
        "            label.next_to(\n",
        "                dot, \n",
        "                random.choice([LEFT, RIGHT]), \n",
        "                SMALL_BUFF\n",
        "            )\n",
        "            self.add(dot)\n",
        "            self.add(label)\n",
        "            print(index_str, self.velocities[-1], self.friction)\n",
        "\n",
        "class Test(Scene):\n",
        "    def construct(self):\n",
        "        shift_val = 1.5\n",
        "\n",
        "        domino1 = Rectangle(\n",
        "            width = 0.5, height = 3,\n",
        "            stroke_width = 0,\n",
        "            fill_color = GREEN,\n",
        "            fill_opacity = 1\n",
        "        )\n",
        "        domino1.shift(LEFT)\n",
        "        domino2 = domino1.copy()\n",
        "        domino2.set_fill(BLUE_E)\n",
        "        domino2.shift(shift_val*RIGHT)\n",
        "        spacing = shift_val - domino2.get_width()\n",
        "        dominos = VGroup(domino1, domino2)\n",
        "        for domino in dominos:\n",
        "            line = DashedLine(domino.get_left(), domino.get_right())\n",
        "            dot = Dot(domino.get_center())\n",
        "            domino.add(line, dot)\n",
        "\n",
        "        arc1 = Arc(\n",
        "            radius = domino1.get_height(),\n",
        "            start_angle = np.pi/2,\n",
        "            angle = -np.arcsin(spacing / domino1.get_height())\n",
        "        )\n",
        "        arc1.shift(domino1.get_corner(DOWN+RIGHT))\n",
        "        arc2 = Arc(\n",
        "            radius = domino1.get_height()/2,\n",
        "            start_angle = np.pi/2,\n",
        "            angle = -np.arcsin(2*spacing/domino1.get_height())\n",
        "        )\n",
        "        arc2.shift(domino1.get_right())\n",
        "        arc2.set_color(BLUE)\n",
        "        arcs = VGroup(arc1, arc2)\n",
        "        for arc, vect in zip(arcs, [DOWN+RIGHT, RIGHT]):\n",
        "            arc_copy = arc.copy()\n",
        "            point = domino1.get_bounding_box_point(vect)\n",
        "            arc_copy.add_line_to([point])\n",
        "            arc_copy.set_stroke(width = 0)\n",
        "            arc_copy.set_fill(\n",
        "                arc.get_stroke_color(),\n",
        "                0.2,\n",
        "            )\n",
        "            self.add(arc_copy)\n",
        "\n",
        "        domino1_ghost = domino1.copy()\n",
        "        domino1_ghost.fade(0.8)\n",
        "        self.add(domino1_ghost, dominos, arcs)\n",
        "\n",
        "        self.play(Rotate(\n",
        "            domino1,\n",
        "            angle = arc1.angle,\n",
        "            about_point = domino1.get_corner(DOWN+RIGHT),\n",
        "            rate_func = there_and_back,\n",
        "            run_time = 3,\n",
        "        ))\n",
        "        self.play(Rotate(\n",
        "            domino1,\n",
        "            angle = arc2.angle,\n",
        "            about_point = domino1.get_right(),\n",
        "            rate_func = there_and_back,\n",
        "            run_time = 3,\n",
        "        ))\n",
        "\n",
        "        print(arc1.angle, arc2.angle)\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n"
    ]
}