{
    "topic": "is demonstrating the concept of population growth, specifically the growth of a population over time.",
    "code": [
        "from manim_imports_ext import *\n",
        "\n",
        "\n",
        "SICKLY_GREEN = \"#9BBD37\"\n",
        "\n",
        "\n",
        "class WomanIcon(SVGMobject):\n",
        "    CONFIG = {\n",
        "        \"fill_color\": GREY_B,\n",
        "        \"stroke_width\": 0,\n",
        "    }\n",
        "\n",
        "    def __init__(self, **kwargs):\n",
        "        super().__init__(\"woman_icon\", **kwargs)\n",
        "        self.remove(self[0])\n",
        "\n",
        "\n",
        "class PersonIcon(SVGMobject):\n",
        "    CONFIG = {\n",
        "        \"fill_color\": GREY_B,\n",
        "        \"stroke_width\": 0,\n",
        "    }\n",
        "\n",
        "    def __init__(self, **kwargs):\n",
        "        super().__init__(\"person\", **kwargs)\n",
        "\n",
        "\n",
        "class Population(VGroup):\n",
        "    def __init__(self, count, **kwargs):\n",
        "        super().__init__(**kwargs)\n",
        "        icon = PersonIcon()\n",
        "        self.add(*(icon.copy() for x in range(count)))\n",
        "        self.arrange_in_grid()\n",
        "\n",
        "\n",
        "def get_covid_clipboard(disease_name=\"SARS\\\\\\\\CoV-2\", sign=\"+\", report=\"Detected\", color=GREEN):\n",
        "    clipboard = SVGMobject(\"clipboard\")\n",
        "    clipboard.set_stroke(width=0)\n",
        "    clipboard.set_fill(interpolate_color(GREY_BROWN, WHITE, 0.5), 1)\n",
        "    clipboard.set_width(2.5)\n",
        "\n",
        "    result = OldTexText(\n",
        "        sign + \"\\\\\\\\\",\n",
        "        disease_name + \"\\\\\\\\\",\n",
        "        report,\n",
        "    )\n",
        "    result[0].scale(1.5, about_point=result[1].get_top())\n",
        "    result[0].set_fill(color)\n",
        "    result[0].set_stroke(color, 2)\n",
        "    result[2].set_width(1.2 * result[1].get_width())\n",
        "    result[-1].set_fill(color)\n",
        "    result.set_width(clipboard.get_width() * 0.7)\n",
        "    result.move_to(clipboard)\n",
        "    result.shift(0.2 * DOWN)\n",
        "    clipboard.add(result)\n",
        "    return clipboard\n",
        "\n",
        "\n",
        "# Scenes\n",
        "class Thumbnail1(Scene):\n",
        "    def construct(self):\n",
        "        # New\n",
        "        bg = FullScreenFadeRectangle()\n",
        "        bg.set_fill(BLACK, 1)\n",
        "        bg.set_gloss(0.2)\n",
        "        self.add(bg)\n",
        "\n",
        "        pre_pop = VGroup(*(WomanIcon() for x in range(5 * 6)))\n",
        "        pre_pop.arrange_in_grid(5, 6, fill_rows_first=False)\n",
        "        pre_pop.set_height(4)\n",
        "        pre_pop[:5].shift(MED_LARGE_BUFF * LEFT)\n",
        "        pre_pop[:5].set_fill(YELLOW)\n",
        "        pre_pop[5:].set_fill(GREY_C)\n",
        "\n",
        "        post_pop = pre_pop.copy()\n",
        "        post_pop.set_opacity(0.1)\n",
        "        for icon in (*post_pop[:4], *post_pop[5::5]):\n",
        "            rect = SurroundingRectangle(icon, buff=0.01)\n",
        "            rect.set_stroke(GREEN, 5)\n",
        "            icon.set_opacity(1)\n",
        "            plus = OldTex(\"+\")\n",
        "            plus.set_color(GREEN)\n",
        "            plus.set_width(rect.get_width() / 2)\n",
        "            plus.move_to(rect.get_corner(UR))\n",
        "            plus.shift(0.05 * UR)\n",
        "            icon.set_stroke(BLACK, 2, background=True)\n",
        "            icon.push_self_into_submobjects()\n",
        "            icon.add_to_back(rect, plus)\n",
        "            icon.set_stroke(background=True)\n",
        "\n",
        "        for pop in pre_pop, post_pop:\n",
        "            colon = OldTex(\":\", font_size=96)\n",
        "            colon.move_to(pop[:10])\n",
        "            pop.add(colon)\n",
        "\n",
        "        arrow = Arrow(LEFT, RIGHT, thickness=0.1)\n",
        "        arrow.scale(1.75)\n",
        "\n",
        "        group = VGroup(pre_pop, arrow, post_pop)\n",
        "        group.arrange(RIGHT, buff=1.0)\n",
        "        group.to_edge(UP)\n",
        "        post_pop.align_to(pre_pop, DOWN)\n",
        "\n",
        "        self.add(group)\n",
        "\n",
        "        # Or try something else...\n",
        "        self.remove(group)\n",
        "        randy = Randolph(color=SICKLY_GREEN, mode=\"sick\")\n",
        "        randy.set_height(4)\n",
        "        randy.next_to(ORIGIN, RIGHT, buff=0.5).to_edge(UP)\n",
        "        clipboard.set_height(4)\n",
        "        clipboard.next_to(ORIGIN, LEFT, buff=0.5).to_edge(UP)\n",
        "        self.add(randy)\n",
        "        self.add(clipboard)\n",
        "        #\n",
        "\n",
        "        new_bayes_rule = OldTexText(\n",
        "            \"Post = (Prior)(Bayes factor)\",\n",
        "            tex_to_color_map={\n",
        "                \"(Prior)\": YELLOW,\n",
        "                \"(Bayes factor)\": BLUE,\n",
        "            }\n",
        "        )\n",
        "        new_bayes_rule.set_width(FRAME_WIDTH - 1)\n",
        "        new_bayes_rule.move_to(2 * DOWN)\n",
        "\n",
        "        self.add(new_bayes_rule)\n",
        "\n",
        "        new_rule_words = OldTexText(\"Bayes rule redesigned\")\n",
        "        new_rule_words.scale(1.75)\n",
        "        new_rule_words.next_to(new_bayes_rule, DOWN, MED_LARGE_BUFF)\n",
        "        new_rule_words.set_fill(GREY_A)\n",
        "        self.add(new_rule_words)\n",
        "\n",
        "        self.embed()\n",
        "        return\n",
        "\n",
        "        # Old\n",
        "        title = OldTexText(\"Interpreting medical tests\", font_size=90)\n",
        "        title.to_edge(UP)\n",
        "        self.add(title)\n",
        "\n",
        "        factor = OldTex(\n",
        "            \"{P(+ \\\\,|\\\\, \\\\text{Virus}) \\\\over P(+ \\\\,|\\\\, \\\\text{No virus})}\",\n",
        "            tex_to_color_map={\n",
        "                \"+\": GREEN,\n",
        "                \"\\\\text{Virus}\": YELLOW,\n",
        "                \"\\\\text{No virus}\": GREY_B,\n",
        "            }\n",
        "        )\n",
        "        factor.scale(2)\n",
        "        rect = SurroundingRectangle(factor, buff=MED_SMALL_BUFF)\n",
        "        rect.set_stroke(BLUE, 3)\n",
        "        factor.add(rect)\n",
        "        self.add(factor)\n",
        "\n",
        "        clipboard = get_covid_clipboard(\"Virus\")\n",
        "        clipboard[2][0].set_stroke(GREEN, 8)\n",
        "        clipboard[2].scale(0.9)\n",
        "        clipboard.set_height(4)\n",
        "        clipboard.next_to(factor, LEFT, LARGE_BUFF)\n",
        "        VGroup(clipboard, factor).next_to(title, DOWN, buff=0.7)\n",
        "\n",
        "        self.add(clipboard)\n",
        "\n",
        "        brace = Brace(factor, DOWN, buff=0.4)\n",
        "        brace.stretch(1.5, 1, about_edge=UP)\n",
        "        text = brace.get_text(\"How much your belief should change\", buff=0.4)\n",
        "        text.scale(1.5, about_edge=UP)\n",
        "        text.shift_onto_screen()\n",
        "        text.match_color(rect)\n",
        "        brace.add(text)\n",
        "        self.add(brace)\n",
        "\n",
        "        self.embed()\n",
        "\n",
        "\n",
        "class Thumbnail2(Scene):\n",
        "    def construct(self):\n",
        "        dots = Dot().get_grid(9 * 5, 16 * 5, buff=MED_LARGE_BUFF)\n",
        "        dots.set_height(FRAME_HEIGHT)\n",
        "        dots.set_color(GREY_D)\n",
        "        VGroup(*random.sample(list(dots), 50)).set_fill(YELLOW, 1)\n",
        "        # self.add(dots)\n",
        "\n",
        "        title = Text(\"A better Bayes rule?\")\n",
        "        title.set_width(FRAME_WIDTH - 2)\n",
        "        title.to_edge(UP, buff=1)\n",
        "        title.set_stroke(BLACK, 25, background=True)\n",
        "        self.add(title)\n",
        "\n",
        "        formula = OldTex(\n",
        "            \"O(H | E)\", \"=\", \"O(H)\", \"{P(E | H) \\\\over P(E | \\\\neg H)\",\n",
        "            tex_to_color_map={\"H\": YELLOW, \"E\": BLUE}\n",
        "        )\n",
        "        formula.set_width(FRAME_WIDTH - 4)\n",
        "        formula.set_y(-1)\n",
        "\n",
        "        H = formula.get_part_by_tex(\"H\")\n",
        "        E = formula.get_part_by_tex(\"E\")\n",
        "        hyp_label = Text(\"Hypothesis\", color=YELLOW, font_size=24)\n",
        "        hyp_label.next_to(H, UP, buff=1).shift_onto_screen()\n",
        "        ev_label = Text(\"Evidence\", color=BLUE, font_size=24)\n",
        "        ev_label.next_to(E, DOWN, buff=1)\n",
        "\n",
        "        self.add(hyp_label, ev_label)\n",
        "        self.add(Arrow(hyp_label, H, buff=0.1, color=YELLOW))\n",
        "        self.add(Arrow(ev_label, E, buff=0.1, color=BLUE))\n",
        "\n",
        "        p_rect = SurroundingRectangle(formula[6:9])\n",
        "        p_rect.set_stroke(GREY_B, 2)\n",
        "        p_label = Text(\"Prior\")\n",
        "        p_label.next_to(p_rect, UP)\n",
        "        # self.add(p_rect, p_label)\n",
        "\n",
        "        rect = SurroundingRectangle(formula[9:])\n",
        "        rect.set_stroke(GREEN, 3)\n",
        "        rect.set_fill(BLACK, 1)\n",
        "        rect_label = Text(\"Bayes factor\", color=GREEN)\n",
        "        rect_label.match_width(rect)\n",
        "        rect_label.next_to(rect, DOWN)\n",
        "\n",
        "        self.add(BackgroundRectangle(formula[:9]))\n",
        "        self.add(rect)\n",
        "        self.add(rect_label)\n",
        "        self.add(formula)\n",
        "\n",
        "        # VGroup(formula, rect, rect_label).to_edge(DOWN)\n",
        "\n",
        "\n",
        "class Thumbnail3(Scene):\n",
        "    def construct(self):\n",
        "        bg = FullScreenFadeRectangle()\n",
        "        bg.set_fill(BLACK, 1)\n",
        "        # bg.set_gloss(0.4)\n",
        "        self.add(bg)\n",
        "\n",
        "        # Just the clipboard\n",
        "        clipboard = get_covid_clipboard(\"Cancer\", color=GREEN)\n",
        "        clipboard[2][0].set_stroke(GREEN, 8)\n",
        "        clipboard[2].scale(0.9)\n",
        "        clipboard.set_height(7)\n",
        "        clipboard.center().to_edge(LEFT, buff=1.0)\n",
        "        self.add(clipboard)\n",
        "\n",
        "        clipback = VMobject()\n",
        "        clipback.set_points(clipboard[1].get_subpaths()[0])\n",
        "        clipback.set_stroke(BLACK, 0)\n",
        "        clipback.set_fill(GREY_E, 1)\n",
        "        clipback.refresh_triangulation()\n",
        "        clipboard.refresh_triangulation()\n",
        "        self.add(clipback, clipboard)\n",
        "\n",
        "        # Title\n",
        "        words = VGroup(\n",
        "            VGroup(\n",
        "                OldTex(\"90\\\\%\").scale(1.8).set_color(GREEN),\n",
        "                OldTexText(\"test accuracy\", alignment=\"\")\n",
        "            ).arrange(DOWN, aligned_edge=LEFT, buff=SMALL_BUFF),\n",
        "            VGroup(\n",
        "                OldTex(\"9\\\\%\").scale(1.8).set_color(RED),\n",
        "                OldTexText(\"chance it's true\", alignment=\"\")\n",
        "            ).arrange(DOWN, aligned_edge=LEFT, buff=SMALL_BUFF),\n",
        "            Text(\"...how?\")\n",
        "        )\n",
        "        words.arrange(DOWN, buff=0.5, aligned_edge=LEFT)\n",
        "        # words.set_width(FRAME_WIDTH - clipboard.get_width() - 1.5)\n",
        "        words.set_height(FRAME_HEIGHT - 2)\n",
        "        words.to_edge(RIGHT, buff=1.0)\n",
        "        words.set_stroke(BLACK, 10, background=True)\n",
        "        self.add(words)\n",
        "\n",
        "        VGroup(*[m for m in self.mobjects if isinstance(m, VMobject)]).refresh_triangulation()\n",
        "\n",
        "\n",
        "class Thumbnail4(Scene):\n",
        "    def construct(self):\n",
        "        top_words = Text(\"False Positive Rate\")\n",
        "        top_words.set_width(FRAME_WIDTH - 1)\n",
        "        top_words.to_edge(UP)\n",
        "        self.add(top_words)\n",
        "\n",
        "        # is_not = Text(\"is NOT\")\n",
        "        is_not = OldTex(\"\\\\ne\")\n",
        "        is_not.set_color(RED)\n",
        "        is_not.set_height(2.5)\n",
        "        is_not.set_stroke(RED, 8)\n",
        "        self.add(is_not)\n",
        "\n",
        "        prob = Text(\n",
        "            \"P(Healthy | Positive)\",\n",
        "            t2c={\n",
        "                \"Healthy\": YELLOW,\n",
        "                \"Positive\": GREEN,\n",
        "            }\n",
        "        )\n",
        "        prob.set_width(FRAME_WIDTH - 1)\n",
        "        prob.to_edge(DOWN)\n",
        "        self.add(prob)\n",
        "\n",
        "\n",
        "class MathAsDesign(Scene):\n",
        "    def construct(self):\n",
        "        # Setup\n",
        "        design_word = OldTexText(\"Designed?\", font_size=72)\n",
        "        design_word.to_edge(UP)\n",
        "\n",
        "        e_formula = OldTex(\n",
        "            \"e\", \"^{\\\\pi\", \"i}\", \"=\", \"-1\",\n",
        "            font_size=96,\n",
        "        )\n",
        "        e_formula[1].set_color(GREY_B)\n",
        "        e_formula[2].set_color(YELLOW)\n",
        "        e_formula[4].set_color(BLUE)\n",
        "\n",
        "        l_formula = OldTex(\n",
        "            \"\\\\sum_{n = 0}^{\\\\infty} \\\\frac{(-1)^n}{2n + 1} = \\\\frac{\\\\pi}{4}\",\n",
        "            font_size=72,\n",
        "        )\n",
        "\n",
        "        buff = 1.5\n",
        "        formulas = VGroup(e_formula, l_formula)\n",
        "        formulas.arrange(DOWN, buff=buff)\n",
        "        formulas.next_to(design_word, DOWN, buff=buff)\n",
        "\n",
        "        original_ly = l_formula.get_y()\n",
        "        l_formula.center()\n",
        "\n",
        "        self.play(Write(l_formula, run_time=1))\n",
        "        self.wait()\n",
        "        self.play(FadeIn(design_word, 0.2 * UP, scale=1.1))\n",
        "        self.wait()\n",
        "\n",
        "        alt_l_formula = VGroup(\n",
        "            VGroup(\n",
        "                OldTex(\"\\\\pm\").set_height(0.8),\n",
        "                OldTex(\"k \\\\text{ odd}\", font_size=36)\n",
        "            ).arrange(DOWN, SMALL_BUFF),\n",
        "            OldTex(\"\\\\frac{1}{k}\"),\n",
        "            OldTex(\"=\"),\n",
        "            VGroup(\n",
        "                Sector(\n",
        "                    angle=PI / 2,\n",
        "                    fill_color=BLUE,\n",
        "                    fill_opacity=1,\n",
        "                    stroke_color=WHITE,\n",
        "                    stroke_width=2,\n",
        "                ),\n",
        "                Sector(\n",
        "                    start_angle=PI / 2, angle=3 * PI / 2,\n",
        "                    fill_color=GREY_E,\n",
        "                    fill_opacity=1,\n",
        "                    stroke_color=WHITE,\n",
        "                    stroke_width=2,\n",
        "                ),\n",
        "            ).set_height(1)\n",
        "        )\n",
        "        alt_l_formula.arrange(RIGHT)\n",
        "        alt_l_formula.match_height(l_formula)\n",
        "        alt_l_formula.next_to(l_formula.get_center(), RIGHT, LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            l_formula.next_to, l_formula.get_center(), LEFT, LARGE_BUFF,\n",
        "            FadeIn(alt_l_formula, shift=2 * RIGHT)\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        # Euler's formula\n",
        "        e_formula.next_to(e_formula.get_y() * UP, LEFT, buff=1.5)\n",
        "        self.play(\n",
        "            l_formula.scale, 0.7,\n",
        "            l_formula.set_y, original_ly,\n",
        "            alt_l_formula.scale, 0.7,\n",
        "            alt_l_formula.set_y, original_ly,\n",
        "            FadeIn(e_formula, scale=1.1)\n",
        "        )\n",
        "\n",
        "        alt_e_formula = VGroup(\n",
        "            OldTexText(\"exp\", font_size=96),\n",
        "            OldTex(\"(\", font_size=96),\n",
        "            Arrow(0.5 * RIGHT, 0.5 * LEFT, path_arc=PI, buff=0, color=GREY_B),\n",
        "            Dot(radius=0.05, color=WHITE),\n",
        "            Vector(0.75 * UP, fill_color=YELLOW),\n",
        "            OldTex(\")\", font_size=96),\n",
        "            OldTex(\"=\", font_size=96),\n",
        "            Vector(LEFT, fill_color=BLUE),\n",
        "        )\n",
        "        alt_e_formula.arrange(RIGHT, buff=MED_SMALL_BUFF)\n",
        "        alt_e_formula[0].shift(0.15 * RIGHT)\n",
        "        alt_e_formula[4:].shift(0.15 * LEFT)\n",
        "        alt_e_formula.scale(0.8)\n",
        "        alt_e_formula.next_to(e_formula.get_y() * UP, RIGHT, buff=1.0)\n",
        "        alt_e_formula.shift(0.2 * DOWN)\n",
        "\n",
        "        anims = []\n",
        "        for i, j in enumerate([0, 2, 4, 6, 7]):\n",
        "            src = e_formula[i].copy()\n",
        "            dst = alt_e_formula[j]\n",
        "            src.generate_target()\n",
        "            src.target.replace(dst, stretch=True)\n",
        "            src.target.set_opacity(0)\n",
        "            dst.save_state()\n",
        "            dst.replace(src, stretch=True)\n",
        "            dst.set_opacity(0)\n",
        "            anims.append(MoveToTarget(src, remover=True))\n",
        "            anims.append(Restore(dst))\n",
        "        anims.extend([\n",
        "            FadeIn(alt_e_formula[1], shift=0.5 * UP, scale=3),\n",
        "            FadeIn(alt_e_formula[5], shift=0.5 * UP, scale=3),\n",
        "            GrowFromPoint(alt_e_formula[3], e_formula[1:3].get_center()),\n",
        "        ])\n",
        "\n",
        "        self.play(*anims)\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class NewBayesRuleAndMedicalTests(Scene):\n",
        "    def construct(self):\n",
        "        # Mention paradox\n",
        "        paradox_name = OldTexText(\"Medical Test Paradox\", font_size=60)\n",
        "        paradox_name.to_corner(UL)\n",
        "        paradox_name.shift(MED_SMALL_BUFF * DOWN)\n",
        "        paradox_line = Underline(paradox_name)\n",
        "        paradox_line.set_stroke(GREY_B, 2)\n",
        "\n",
        "        clipboard = get_covid_clipboard(\"Virus\", color=BLUE)\n",
        "        clipboard.set_height(3)\n",
        "        clipboard.next_to(paradox_line, DOWN, LARGE_BUFF)\n",
        "        clipboard[2][0].shift(SMALL_BUFF * DOWN)\n",
        "        clipboard[2][0].set_stroke(BLUE, 4)\n",
        "        clipboard[2].set_opacity(0)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(paradox_name, lag_ratio=0.1),\n",
        "            ShowCreation(paradox_line),\n",
        "            FadeIn(clipboard, DOWN),\n",
        "        )\n",
        "        clipboard[2].set_opacity(1)\n",
        "        self.play(\n",
        "            Write(clipboard[2], run_time=1)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show Bayes rule\n",
        "        bayes_title = OldTexText(\"Bayes' rule\", font_size=60)\n",
        "        bayes_title.move_to(paradox_name, UL)\n",
        "        bayes_title.to_edge(RIGHT, buff=1.5)\n",
        "        bayes_underline = Underline(bayes_title)\n",
        "        bayes_underline.scale(1.5)\n",
        "        bayes_underline.set_stroke(GREY_B, 2)\n",
        "        bayes_underline.match_y(paradox_line)\n",
        "\n",
        "        formula = OldTex(\n",
        "            \"P(H|E) = {P(H)P(E|H) \\\\over P(E)}\",\n",
        "            tex_to_color_map={\n",
        "                \"H\": YELLOW,\n",
        "                \"E\": BLUE,\n",
        "            },\n",
        "        )\n",
        "        formula.next_to(bayes_underline, DOWN, buff=LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            Write(bayes_title, run_time=1),\n",
        "            GrowFromCenter(bayes_underline),\n",
        "            FadeIn(formula, shift=0.5 * DOWN, scale=1.2)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show high accuracy\n",
        "        accuracy_words = OldTexText(\"High accuracy\")\n",
        "        accuracy_words.next_to(paradox_line, DOWN, MED_LARGE_BUFF)\n",
        "        accuracy_words.set_color(GREEN)\n",
        "\n",
        "        population = Population(100)\n",
        "        population.arrange_in_grid(buff=LARGE_BUFF)\n",
        "        population.set_height(5)\n",
        "        population.next_to(accuracy_words, DOWN)\n",
        "\n",
        "        marks = VGroup()\n",
        "        for icon in population:\n",
        "            icon.generate_target()\n",
        "            if random.random() < 0.025:\n",
        "                mark = Exmark()\n",
        "                icon.target.set_opacity(0.5)\n",
        "            else:\n",
        "                mark = Checkmark()\n",
        "            mark.set_height(icon.get_height() / 2)\n",
        "            mark.move_to(icon.get_corner(UL))\n",
        "            marks.add(mark)\n",
        "\n",
        "        accuracy_group = VGroup(accuracy_words, population, marks)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(accuracy_words),\n",
        "            FadeIn(population, lag_ratio=0.01),\n",
        "            clipboard.scale, 0.5,\n",
        "            clipboard.to_corner, DR,\n",
        "        )\n",
        "        self.play(\n",
        "            ShowIncreasingSubsets(marks, run_time=2),\n",
        "            LaggedStartMap(MoveToTarget, population, run_time=2),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show test result\n",
        "        randy = Randolph(height=2)\n",
        "        randy.next_to(population, RIGHT, MED_LARGE_BUFF, aligned_edge=DOWN)\n",
        "        clipboard.generate_target()\n",
        "        clipboard.target.set_height(2)\n",
        "        clipboard.target.next_to(randy.get_corner(UR), RIGHT)\n",
        "\n",
        "        self.play(\n",
        "            VFadeIn(randy),\n",
        "            randy.change, \"guilty\", clipboard.target,\n",
        "            MoveToTarget(clipboard),\n",
        "            formula.match_width, bayes_underline,\n",
        "            formula.next_to, bayes_underline, DOWN, MED_SMALL_BUFF,\n",
        "        )\n",
        "        self.play(randy.change, \"horrified\", clipboard)\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        # Show low predictive value\n",
        "        prob_expression = OldTex(\n",
        "            \"P(\\\\text{Sick} \\\\text{ given } +) = \",\n",
        "            tex_to_color_map={\n",
        "                \"+\": BLUE,\n",
        "                \"\\\\text{Sick}\": YELLOW,\n",
        "            }\n",
        "        )\n",
        "        prob = DecimalNumber(0.9, font_size=60)\n",
        "        prob.next_to(prob_expression, RIGHT)\n",
        "        prob.set_color(WHITE)\n",
        "        prob.set_opacity(0)\n",
        "        prob_expression.add(prob)\n",
        "        p_line = Underline(prob)\n",
        "        p_line.shift(0.1 * DOWN)\n",
        "        p_line.scale(1.5)\n",
        "        p_line.set_stroke(WHITE, 2)\n",
        "        prob_expression.add(p_line)\n",
        "        prob_expression.next_to(VGroup(randy, clipboard), UP, aligned_edge=LEFT)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(prob_expression),\n",
        "            randy.change, \"pondering\", prob_expression\n",
        "        )\n",
        "        self.play(\n",
        "            ChangeDecimalToValue(prob, 0.09),\n",
        "            UpdateFromAlphaFunc(prob, lambda m, a: m.set_opacity(a)),\n",
        "            run_time=2\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.play(\n",
        "            randy.change, \"confused\", prob,\n",
        "            ChangeDecimalToValue(prob, 0.01),\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        predictive_group = VGroup(\n",
        "            randy, clipboard,\n",
        "            prob_expression, prob,\n",
        "        )\n",
        "\n",
        "        # Accurate does not imply predictive\n",
        "        implication = OldTexText(\n",
        "            \"Accurate \", \"$\\\\Rightarrow$\", \" Predictive\",\n",
        "        )\n",
        "        implication.set_color_by_tex(\"Accurate\", GREEN)\n",
        "        implication.set_color_by_tex(\"Predictive\", YELLOW)\n",
        "        implication.match_width(paradox_line)\n",
        "        implication.next_to(paradox_line, DOWN)\n",
        "\n",
        "        strike = Line(DL, UR).replace(implication[1], stretch=True)\n",
        "        strike.set_stroke(RED, 4)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(implication, scale=1.1),\n",
        "            accuracy_group.scale, 0.8, {\"about_edge\": DOWN},\n",
        "            randy.change, 'pondering', implication,\n",
        "        )\n",
        "        self.play(ShowCreation(strike))\n",
        "        self.wait()\n",
        "        implication.add(strike)\n",
        "\n",
        "        paradox_group = VGroup(paradox_name, paradox_line, implication)\n",
        "\n",
        "        # Get rid of medical test stuff\n",
        "        p_rect = SurroundingRectangle(paradox_group, buff=MED_SMALL_BUFF)\n",
        "        p_rect.set_stroke(WHITE, 2)\n",
        "        p_rect.set_fill(GREY_E, 1)\n",
        "        self.add(p_rect, paradox_group),\n",
        "        self.play(\n",
        "            FadeOut(accuracy_group, DL),\n",
        "            FadeOut(predictive_group, 2 * DL),\n",
        "            DrawBorderThenFill(p_rect)\n",
        "        )\n",
        "        paradox_group.add_to_back(p_rect)\n",
        "        self.wait()\n",
        "\n",
        "        # Alternate framing\n",
        "        odds_formula = OldTex(\n",
        "            \"O(H|E) = O(H){P(E|H) \\\\over P(E|\\\\neg H)}\",\n",
        "            tex_to_color_map={\n",
        "                \"H\": YELLOW,\n",
        "                \"E\": BLUE,\n",
        "                \"\\\\neg\": RED,\n",
        "            }\n",
        "        )\n",
        "        odds_formula.match_height(formula)\n",
        "        odds_formula.next_to(formula, DOWN, LARGE_BUFF)\n",
        "        odds_formula.shift_onto_screen()\n",
        "\n",
        "        bf_rect = SurroundingRectangle(odds_formula[7:], buff=0.025)\n",
        "        bf_rect.set_stroke(TEAL, 2)\n",
        "        bf_name = OldTexText(\"Bayes\\\\\\\\factor\", font_size=36)\n",
        "        bf_name.match_color(bf_rect)\n",
        "        bf_name.next_to(bf_rect, DOWN, buff=0.2)\n",
        "        odds_formula.add(bf_rect, bf_name)\n",
        "\n",
        "        arrow = Vector(1.5 * RIGHT)\n",
        "        arrow.next_to(formula, LEFT)\n",
        "\n",
        "        self.play(\n",
        "            paradox_group.next_to, arrow, LEFT,\n",
        "            GrowArrow(arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            VGroup(paradox_group, arrow).next_to, odds_formula[0], LEFT,\n",
        "            FadeIn(odds_formula, DOWN)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Reflections on this formula\n",
        "        morty = Mortimer(height=2.2)\n",
        "        morty.to_corner(DR)\n",
        "        morty.shift(2 * LEFT)\n",
        "        randy = Randolph(height=2)\n",
        "        randy.next_to(morty, LEFT, LARGE_BUFF, aligned_edge=DOWN)\n",
        "\n",
        "        bubble = ThoughtBubble()\n",
        "        bubble.pin_to(morty)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStart(*(\n",
        "                ShowCreationThenFadeOut(SurroundingRectangle(mob, color=BLUE))\n",
        "                for mob in (formula, odds_formula)\n",
        "            ), lag_ratio=0.4, run_time=3),\n",
        "            VFadeIn(randy),\n",
        "            randy.change, \"confused\", formula,\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        self.add(bubble, odds_formula)\n",
        "        odds_formula.save_state()\n",
        "        self.play(\n",
        "            VFadeIn(morty),\n",
        "            morty.change, \"maybe\", bubble[-1],\n",
        "            randy.look_at, bubble,\n",
        "            FadeIn(bubble, lag_ratio=0.5),\n",
        "            odds_formula.move_to, bubble.get_bubble_center(),\n",
        "            odds_formula.shift, 0.2 * LEFT + 0.1 * DOWN,\n",
        "            FadeOut(arrow, scale=0.5),\n",
        "            paradox_group.scale, 0.5,\n",
        "            paradox_group.to_corner, DL,\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.play(Blink(randy))\n",
        "        self.wait(2)\n",
        "        self.play(randy.change, \"pondering\")\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        paradox_group.generate_target()\n",
        "        paradox_group.target.scale(1.5)\n",
        "        paradox_group.target.next_to(randy.get_corner(UL), UP)\n",
        "        paradox_group.target.shift(LEFT)\n",
        "        self.play(\n",
        "            FadeOut(bubble, lag_ratio=0.4),\n",
        "            Restore(odds_formula),\n",
        "            morty.change, 'tease', paradox_group.target,\n",
        "            randy.change, 'raise_left_hand', paradox_group.target,\n",
        "            MoveToTarget(paradox_group),\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "        return\n",
        "\n",
        "        # Unprocessed\n",
        "        # Show rule\n",
        "        formula = OldTex(\n",
        "            \"P(H|E) = {P(H)P(E|H) \\\\over P(E)}\",\n",
        "            tex_to_color_map={\n",
        "                \"H\": YELLOW,\n",
        "                \"E\": BLUE,\n",
        "            },\n",
        "            font_size=60\n",
        "        )\n",
        "\n",
        "        h_part = formula.get_part_by_tex(\"H\")\n",
        "        hyp_word = OldTexText(\"Hypothesis\", color=YELLOW)\n",
        "        hyp_word.next_to(h_part, UP, LARGE_BUFF)\n",
        "        hyp_arrow = Arrow(hyp_word.get_bottom(), h_part.get_top(), buff=0.1)\n",
        "\n",
        "        e_part = formula.get_part_by_tex(\"E\")\n",
        "        ev_word = OldTexText(\"Evidence\", color=BLUE)\n",
        "        ev_word.next_to(e_part, DOWN, LARGE_BUFF)\n",
        "        ev_arrow = Arrow(ev_word.get_top(), e_part.get_bottom(), buff=0.1)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(h_line),\n",
        "            FadeIn(formula, scale=1.1),\n",
        "        )\n",
        "        self.play(\n",
        "            LaggedStart(\n",
        "                FadeIn(hyp_word, shift=0.25 * UP, scale=1.1),\n",
        "                FadeIn(ev_word, shift=0.25 * DOWN, scale=1.1),\n",
        "            ),\n",
        "            LaggedStart(\n",
        "                GrowArrow(hyp_arrow),\n",
        "                GrowArrow(ev_arrow),\n",
        "            ),\n",
        "        )\n",
        "        self.wait()\n",
        "        formula_annoations = VGroup(hyp_word, hyp_arrow, ev_word, ev_arrow)\n",
        "\n",
        "        # Randys\n",
        "        pis = VGroup(Randolph(), Randolph())\n",
        "        pis.set_height(2)\n",
        "        pis[1].flip()\n",
        "        pis[1].set_color(TEAL_E)\n",
        "        pis.arrange(RIGHT, buff=5)\n",
        "        pis.to_corner(DL)\n",
        "\n",
        "        self.play(\n",
        "            VFadeIn(pis[0]),\n",
        "            pis[0].change, \"hooray\", formula\n",
        "        )\n",
        "        self.play(Blink(pis[0]))\n",
        "        self.play(\n",
        "            VFadeIn(pis[1]),\n",
        "            pis[1].change, \"maybe\", formula\n",
        "        )\n",
        "        self.play(Blink(pis[1]))\n",
        "        self.wait()\n",
        "\n",
        "        # Sweep aside\n",
        "        title.add(h_line)\n",
        "        formula.generate_target()\n",
        "        formula.target.scale(0.6)\n",
        "        formula.target.to_corner(DR)\n",
        "\n",
        "        self.play(\n",
        "            VFadeOut(formula_annoations),\n",
        "            MaintainPositionRelativeTo(formula_annoations, formula),\n",
        "            MoveToTarget(formula),\n",
        "            title.scale, 0.7,\n",
        "            title.next_to, formula.target, UP,\n",
        "            FadeOut(pis, DOWN),\n",
        "        )\n",
        "\n",
        "        # Question the formulas\n",
        "        self.play(FadeIn(morty))\n",
        "        self.play(morty.change, \"hesitant\", formula)\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "        formulas = VGroup(formula, odds_formula)\n",
        "        self.play(\n",
        "            LaggedStart(\n",
        "                *(\n",
        "                    ShowCreationThenFadeOut(Underline(mob, color=GREY_BROWN))\n",
        "                    for mob in formulas\n",
        "                ),\n",
        "                lag_ratio=0.3\n",
        "            ),\n",
        "            morty.change, \"raise_right_hand\", formula,\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "        mover = VGroup(paradox_group, title, formula, odds_formula, arrow)\n",
        "        bubbles = VGroup(*(ThoughtBubble(height=1, width=1) for x in range(2)))\n",
        "        bubbles.set_fill(GREY_E, 1)\n",
        "        for bubble, form in zip(bubbles, formulas):\n",
        "            bubble.move_to(form, RIGHT)\n",
        "\n",
        "        self.play(\n",
        "            morty.change, \"raise_left_hand\", bubble,\n",
        "            mover.to_edge, LEFT,\n",
        "            LaggedStartMap(DrawBorderThenFill, bubbles, lag_ratio=0.7, run_time=2),\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            Rotate(arrow, PI),\n",
        "            morty.change, \"pondering\", paradox_group,\n",
        "        )\n",
        "        arrow2 = Arrow(formula.get_left(), paradox_group.get_corner(UR))\n",
        "        self.play(GrowArrow(arrow2))\n",
        "        self.play(Blink(morty))\n",
        "        self.wait(2)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStart(*(\n",
        "                FadeOut(mob, RIGHT)\n",
        "                for mob in [arrow2, arrow, title, formula, odds_formula, *bubbles]\n",
        "            )),\n",
        "            morty.change, \"raise_right_hand\",\n",
        "            paradox_group.next_to, morty.get_corner(UR), UP,\n",
        "            paradox_group.shift_onto_screen,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class SamplePopulationBreastCancer(Scene):\n",
        "    def construct(self):\n",
        "        # Introduce population\n",
        "        title = OldTexText(\n",
        "            \"Sample of \", \"$1{,}000$\", \" women\",\n",
        "            font_size=72,\n",
        "        )\n",
        "        title.add(Underline(title, color=GREY_B))\n",
        "        title.to_edge(UP, buff=MED_SMALL_BUFF)\n",
        "        self.add(title)\n",
        "\n",
        "        woman = WomanIcon()\n",
        "        globals()['woman'] = woman\n",
        "        population = VGroup(*[woman.copy() for x in range(1000)])\n",
        "        population.arrange_in_grid(\n",
        "            25, 40,\n",
        "            buff=LARGE_BUFF,\n",
        "            fill_rows_first=False,\n",
        "        )\n",
        "        population.set_height(6)\n",
        "        population.next_to(title, DOWN)\n",
        "\n",
        "        counter = Integer(1000, edge_to_fix=UL)\n",
        "        counter.replace(title[1])\n",
        "        counter.set_value(0)\n",
        "\n",
        "        title[1].set_opacity(0)\n",
        "        self.play(\n",
        "            ShowIncreasingSubsets(population),\n",
        "            ChangeDecimalToValue(counter, 1000),\n",
        "            run_time=5\n",
        "        )\n",
        "        self.remove(counter)\n",
        "        title[1].set_opacity(1)\n",
        "        self.wait()\n",
        "\n",
        "        # Show true positives\n",
        "        rects = VGroup(Rectangle(), Rectangle())\n",
        "        rects.set_height(6)\n",
        "        rects[0].set_width(4, stretch=True)\n",
        "        rects[1].set_width(8, stretch=True)\n",
        "        rects[0].set_stroke(YELLOW, 3)\n",
        "        rects[1].set_stroke(GREY, 3)\n",
        "        rects.arrange(RIGHT)\n",
        "        rects.center().to_edge(DOWN, buff=MED_SMALL_BUFF)\n",
        "\n",
        "        positive_cases = population[:10]\n",
        "        negative_cases = population[10:]\n",
        "\n",
        "        positive_cases.generate_target()\n",
        "        positive_cases.target.move_to(rects[0])\n",
        "        positive_cases.target.set_color(YELLOW)\n",
        "\n",
        "        negative_cases.generate_target()\n",
        "        negative_cases.target.set_height(rects[1].get_height() * 0.8)\n",
        "        negative_cases.target.move_to(rects[1])\n",
        "\n",
        "        positive_words = OldTexText(r\"1\\% \", \"Have breast cancer\", font_size=36)\n",
        "        positive_words.set_color(YELLOW)\n",
        "        positive_words.next_to(rects[0], UP, SMALL_BUFF)\n",
        "\n",
        "        negative_words = OldTexText(r\"99\\% \", \"Do not have cancer\", font_size=36)\n",
        "        negative_words.set_color(GREY_B)\n",
        "        negative_words.next_to(rects[1], UP, SMALL_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(positive_cases),\n",
        "            MoveToTarget(negative_cases),\n",
        "            Write(positive_words, run_time=1),\n",
        "            Write(negative_words, run_time=1),\n",
        "            FadeIn(rects),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show screening\n",
        "        scan_lines = VGroup(*(\n",
        "            Line(\n",
        "                # FRAME_WIDTH * LEFT / 2,\n",
        "                FRAME_HEIGHT * DOWN / 2,\n",
        "                icon.get_center(),\n",
        "                stroke_width=1,\n",
        "                stroke_color=interpolate_color(BLUE, GREEN, random.random())\n",
        "            )\n",
        "            for icon in population\n",
        "        ))\n",
        "        self.play(\n",
        "            LaggedStartMap(\n",
        "                ShowCreationThenFadeOut, scan_lines,\n",
        "                lag_ratio=1 / len(scan_lines),\n",
        "                run_time=3,\n",
        "            )\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Test results on cancer population\n",
        "        tpr_words = OldTexText(\"9 True positives\", font_size=36)\n",
        "        fnr_words = OldTexText(\"1 False negative\", font_size=36)\n",
        "        tnr_words = OldTexText(\"901 True negatives\", font_size=36)\n",
        "        fpr_words = OldTexText(\"89 False positives\", font_size=36)\n",
        "\n",
        "        tpr_words.set_color(GREEN_B)\n",
        "        fnr_words.set_color(RED_D)\n",
        "        tnr_words.set_color(RED_B)\n",
        "        fpr_words.set_color(GREEN_D)\n",
        "\n",
        "        tp_cases = positive_cases[:9]\n",
        "        fn_cases = positive_cases[9:]\n",
        "\n",
        "        tpr_words.next_to(tp_cases, UP)\n",
        "        fnr_words.next_to(fn_cases, DOWN)\n",
        "\n",
        "        signs = VGroup()\n",
        "        for woman in tp_cases:\n",
        "            sign = OldTex(\"+\")\n",
        "            sign.set_color(GREEN_B)\n",
        "            sign.match_height(woman)\n",
        "            sign.next_to(woman, RIGHT, SMALL_BUFF)\n",
        "            woman.sign = sign\n",
        "            signs.add(sign)\n",
        "        for woman in fn_cases:\n",
        "            sign = OldTex(\"-\")\n",
        "            sign.set_color(RED)\n",
        "            sign.match_width(signs[0])\n",
        "            sign.next_to(woman, RIGHT, SMALL_BUFF)\n",
        "            woman.sign = sign\n",
        "            signs.add(sign)\n",
        "\n",
        "        boxes = VGroup()\n",
        "        for n, woman in enumerate(positive_cases):\n",
        "            box = SurroundingRectangle(woman, buff=0)\n",
        "            box.set_stroke(width=2)\n",
        "            if woman in tp_cases:\n",
        "                box.set_color(GREEN)\n",
        "            else:\n",
        "                box.set_color(RED)\n",
        "            woman.box = box\n",
        "            boxes.add(box)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(tpr_words, shift=0.2 * UP),\n",
        "            ShowIncreasingSubsets(signs[:9]),\n",
        "            ShowIncreasingSubsets(boxes[:9]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(fnr_words, shift=0.2 * DOWN),\n",
        "            Write(signs[9:]),\n",
        "            ShowCreation(boxes[9:]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Test results on cancer-free population\n",
        "        negative_cases.sort(lambda p: -p[1])\n",
        "\n",
        "        num_fp = int(len(negative_cases) * 0.09)\n",
        "        fp_cases = negative_cases[:num_fp]\n",
        "        tn_cases = negative_cases[num_fp:]\n",
        "\n",
        "        new_boxes = VGroup()\n",
        "        for n, woman in enumerate(negative_cases):\n",
        "            box = SurroundingRectangle(woman, buff=0)\n",
        "            box.set_stroke(width=2)\n",
        "            if woman in fp_cases:\n",
        "                box.set_color(GREEN)\n",
        "            else:\n",
        "                box.set_color(RED)\n",
        "            woman.box = box\n",
        "            new_boxes.add(box)\n",
        "\n",
        "        fpr_words.next_to(fp_cases, UP, buff=SMALL_BUFF)\n",
        "        tnr_words.next_to(tn_cases, DOWN, buff=0.2)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(fpr_words, shift=0.2 * UP),\n",
        "            ShowIncreasingSubsets(new_boxes[:num_fp])\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(tnr_words, shift=0.2 * DOWN),\n",
        "            ShowIncreasingSubsets(new_boxes[num_fp:])\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Consolidate boxes\n",
        "        self.remove(boxes, new_boxes, population)\n",
        "        for woman in population:\n",
        "            woman.add(woman.box)\n",
        "        self.add(population)\n",
        "\n",
        "        # Limit view to positive cases\n",
        "        for cases, nr, rect in zip([tp_cases, fp_cases], [3, 7], rects):\n",
        "            cases.save_state()\n",
        "            cases.generate_target()\n",
        "            for case in cases.target:\n",
        "                case[-1].set_stroke(width=3)\n",
        "                case[-1].scale(1.1)\n",
        "            cases.target.arrange_in_grid(\n",
        "                n_rows=nr,\n",
        "                buff=0.5 * cases[0].get_width()\n",
        "            )\n",
        "            cases.target.scale(0.5 / cases.target[0].get_height())\n",
        "            cases.target.move_to(rect)\n",
        "\n",
        "        fp_cases.target.shift(0.4 * DOWN)\n",
        "        positive_words.save_state()\n",
        "        negative_words.save_state()\n",
        "        tpr_words.save_state()\n",
        "        fpr_words.save_state()\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(tp_cases),\n",
        "            MoveToTarget(fp_cases),\n",
        "            tpr_words.next_to, tp_cases.target, UP,\n",
        "            fpr_words.next_to, fp_cases.target, UP,\n",
        "            FadeOut(signs),\n",
        "            positive_words[0].set_opacity, 0,\n",
        "            negative_words[0].set_opacity, 0,\n",
        "            positive_words[1].match_x, rects[0],\n",
        "            negative_words[1].match_x, rects[1],\n",
        "            LaggedStart(\n",
        "                FadeOut(fn_cases, shift=DOWN),\n",
        "                FadeOut(fnr_words, shift=DOWN),\n",
        "                FadeOut(tn_cases, shift=DOWN),\n",
        "                FadeOut(tnr_words, shift=DOWN),\n",
        "            ),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Emphasize groups counts\n",
        "        self.play(\n",
        "            ShowCreationThenFadeOut(SurroundingRectangle(\n",
        "                tpr_words[0][:1],\n",
        "                stroke_width=2,\n",
        "                stroke_color=WHITE,\n",
        "                buff=0.05,\n",
        "            )),\n",
        "            LaggedStartMap(Indicate, tp_cases, color=YELLOW, lag_ratio=0.3, run_time=1),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            ShowCreationThenFadeOut(SurroundingRectangle(\n",
        "                fpr_words[0][:2],\n",
        "                stroke_width=2,\n",
        "                stroke_color=WHITE,\n",
        "                buff=0.05,\n",
        "            )),\n",
        "            LaggedStartMap(\n",
        "                Indicate, fp_cases,\n",
        "                color=GREEN_A,\n",
        "                lag_ratio=0.05,\n",
        "                run_time=3\n",
        "            )\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Final equation\n",
        "        equation = OldTex(\n",
        "            \"P(\",\n",
        "            \"\\\\text{Have cancer }\",\n",
        "            \"|\",\n",
        "            \"\\\\text{ positive test})\",\n",
        "            \"\\\\approx\",\n",
        "            \"\\\\frac{9}{9 + 89}\",\n",
        "            \"\\\\approx \\\\frac{1}{11}\"\n",
        "        )\n",
        "        equation.set_color_by_tex(\"cancer\", YELLOW)\n",
        "        equation.set_color_by_tex(\"positive\", GREEN)\n",
        "        equation.to_edge(UP, buff=SMALL_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(equation[:-1], shift=UP),\n",
        "            FadeOut(title, shift=UP),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Write(equation[-1]))\n",
        "        self.wait()\n",
        "\n",
        "        # Label PPV\n",
        "        frame = self.camera.frame\n",
        "        frame.save_state()\n",
        "\n",
        "        ppv_words = OldTexText(\n",
        "            \"Positive\\\\\\\\\",\n",
        "            \"Predictive\\\\\\\\\",\n",
        "            \"Value\\\\\\\\\",\n",
        "            alignment=\"\",\n",
        "        )\n",
        "        ppv_words.next_to(equation, RIGHT, LARGE_BUFF, DOWN)\n",
        "        for word in ppv_words:\n",
        "            word[0].set_color(BLUE)\n",
        "\n",
        "        ppv_rhs = OldTex(\n",
        "            \"={\\\\text{TP} \\\\over \\\\text{TP} + \\\\text{FP}}\",\n",
        "            tex_to_color_map={\n",
        "                \"\\\\text{TP}\": GREEN_B,\n",
        "                \"\\\\text{FP}\": GREEN_C,\n",
        "            }\n",
        "        )\n",
        "        ppv_rhs.next_to(ppv_words, RIGHT)\n",
        "        ppv_rhs.shift(1.5 * LEFT)\n",
        "\n",
        "        self.play(frame.scale, 1.1, {\"about_edge\": DL})\n",
        "        self.play(ShowIncreasingSubsets(ppv_words))\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            equation.shift, 1.5 * LEFT + 0.5 * UP,\n",
        "            ppv_words.shift, 1.5 * LEFT,\n",
        "            FadeIn(ppv_rhs, lag_ratio=0.1),\n",
        "            frame.scale, 1.1, {\"about_edge\": DL},\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Go back to earlier state\n",
        "        self.play(\n",
        "            frame.restore,\n",
        "            frame.shift, 0.5 * DOWN,\n",
        "            LaggedStartMap(FadeOut, VGroup(equation, ppv_words, ppv_rhs)),\n",
        "            LaggedStartMap(Restore, VGroup(\n",
        "                tpr_words, tp_cases,\n",
        "                fpr_words, fp_cases,\n",
        "            )),\n",
        "            run_time=3,\n",
        "        )\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeIn, VGroup(\n",
        "                fnr_words, fn_cases,\n",
        "                tnr_words, tn_cases,\n",
        "            )),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Fade rects\n",
        "        fade_rects = VGroup(*(\n",
        "            BackgroundRectangle(\n",
        "                VGroup(rect, words),\n",
        "                fill_opacity=0.9,\n",
        "                fill_color=BLACK,\n",
        "                buff=SMALL_BUFF,\n",
        "            )\n",
        "            for rect, words in zip(rects, [positive_words, negative_words])\n",
        "        ))\n",
        "\n",
        "        # Sensitivity\n",
        "        sens_eq = OldTex(\n",
        "            \"\\\\text{Sensitivity}\",\n",
        "            \"= {9 \\\\over 10}\",\n",
        "            \"= 90\\\\%\"\n",
        "        )\n",
        "        sens_eq.next_to(rects[0], LEFT, MED_LARGE_BUFF, aligned_edge=UP)\n",
        "        sens_eq.shift(DOWN)\n",
        "\n",
        "        fnr_eq = OldTex(\n",
        "            \"\\\\text{False Negative Rate}\", \"= 10\\\\%\"\n",
        "        )\n",
        "        fnr_eq.set_color(RED)\n",
        "        fnr_eq.scale(0.9)\n",
        "        equiv = OldTex(\"\\\\Leftrightarrow\")\n",
        "        equiv.scale(1.5)\n",
        "        equiv.rotate(90 * DEGREES)\n",
        "        equiv.next_to(sens_eq, DOWN, MED_LARGE_BUFF)\n",
        "        fnr_eq.next_to(equiv, DOWN, MED_LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            frame.shift, 5 * LEFT,\n",
        "            FadeIn(fade_rects[1]),\n",
        "            Write(sens_eq[0]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(tpr_words[0][0], sens_eq[1][1]),\n",
        "            Write(sens_eq[1][0]),\n",
        "            Write(sens_eq[1][2:]),\n",
        "        )\n",
        "        self.play(Write(sens_eq[2]))\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(equiv, shift=0.5 * DOWN),\n",
        "            FadeIn(fnr_eq, shift=1.0 * DOWN),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Transition to right side\n",
        "        fade_rects[0].stretch(5, 0, about_edge=RIGHT)\n",
        "        self.play(\n",
        "            ApplyMethod(frame.shift, 10 * RIGHT, run_time=4),\n",
        "            FadeIn(fade_rects[0], run_time=2),\n",
        "            FadeOut(fade_rects[1], run_time=2),\n",
        "        )\n",
        "\n",
        "        # Specificity\n",
        "        spec_eq = OldTex(\n",
        "            \"\\\\text{Specificity}\",\n",
        "            \"= {901 \\\\over 990}\",\n",
        "            \"\\\\approx 91\\\\%\"\n",
        "        )\n",
        "        spec_eq.next_to(rects[1], RIGHT, MED_LARGE_BUFF, aligned_edge=DOWN)\n",
        "        spec_eq.shift(UP)\n",
        "\n",
        "        fpr_eq = OldTex(\n",
        "            \"\\\\text{False Positive Rate}\", \"= 9\\\\%\"\n",
        "        )\n",
        "        fpr_eq.set_color(GREEN)\n",
        "        fpr_eq.scale(0.9)\n",
        "        equiv2 = OldTex(\"\\\\Leftrightarrow\")\n",
        "        equiv2.scale(1.5)\n",
        "        equiv2.rotate(90 * DEGREES)\n",
        "        equiv2.next_to(spec_eq, UP, MED_LARGE_BUFF)\n",
        "        fpr_eq.next_to(equiv2, UP, MED_LARGE_BUFF)\n",
        "\n",
        "        self.play(Write(spec_eq[0]))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Write(spec_eq[1][0]),\n",
        "            TransformFromCopy(\n",
        "                tnr_words[0][:3],\n",
        "                spec_eq[1][1:4],\n",
        "                run_time=2,\n",
        "                path_arc=30 * DEGREES,\n",
        "            ),\n",
        "            Write(spec_eq[1][4:]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Write(spec_eq[2]))\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(equiv2, shift=0.5 * UP),\n",
        "            FadeIn(fpr_eq, shift=1.0 * UP),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Reset to show both kinds of accuracy\n",
        "        eqs = [sens_eq, spec_eq]\n",
        "        for eq, word in zip(eqs, [positive_words, negative_words]):\n",
        "            eq.generate_target()\n",
        "            eq.target[1].set_opacity(0)\n",
        "            eq.target[2].move_to(eq.target[1], LEFT),\n",
        "            eq.target.next_to(word, UP, buff=0.3)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(fade_rects[0]),\n",
        "            frame.shift, 5 * LEFT,\n",
        "            frame.scale, 1.1, {\"about_edge\": DOWN},\n",
        "            MoveToTarget(sens_eq),\n",
        "            MoveToTarget(spec_eq),\n",
        "            *map(FadeOut, (fnr_eq, fpr_eq, equiv, equiv2)),\n",
        "            run_time=2,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            VGroup(\n",
        "                fn_cases, fnr_words,\n",
        "                fp_cases, fpr_words,\n",
        "            ).set_opacity, 0.2,\n",
        "            rate_func=there_and_back_with_pause,\n",
        "            run_time=3\n",
        "        )\n",
        "\n",
        "\n",
        "class LearnAboutPositiveResult(Scene):\n",
        "    def construct(self):\n",
        "        doctors = VGroup(\n",
        "            SVGMobject(\"female_doctor\"),\n",
        "            SVGMobject(\"male_doctor\"),\n",
        "        )\n",
        "        for doc in doctors:\n",
        "            doc.remove(doc[0])\n",
        "            doc.set_height(3)\n",
        "        doctors.set_stroke(width=0)\n",
        "        doctors.set_fill(GREY_C)\n",
        "        doctors.set_gloss(0.5)\n",
        "        doctors.arrange(RIGHT, buff=3)\n",
        "        doctors.move_to(DOWN)\n",
        "\n",
        "        self.add(doctors)\n",
        "\n",
        "        bubbles = VGroup(*(ThoughtBubble(height=2, width=2) for x in range(2)))\n",
        "        bubbles[1].flip()\n",
        "        for bubble, doc in zip(bubbles, doctors):\n",
        "            bubble.pin_to(doc)\n",
        "            icon = WomanIcon()\n",
        "            icon.set_height(0.5)\n",
        "            bubble.add_content(icon)\n",
        "            bubble.add(icon)\n",
        "\n",
        "        self.play(LaggedStartMap(FadeIn, bubbles))\n",
        "\n",
        "        clipboard = get_covid_clipboard(\"Cancer\")\n",
        "        clipboard.move_to(DOWN)\n",
        "        clipboard[2].set_opacity(0)\n",
        "\n",
        "        self.play(FadeIn(clipboard, UP))\n",
        "        self.play(clipboard[2].set_opacity, 1)\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class AskWhatTheParadoxIs(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Image\n",
        "        image = ImageMobject(\"ppv_image\")\n",
        "        image.replace(self.screen)\n",
        "        image.set_opacity(0)\n",
        "        outline = SurroundingRectangle(image, buff=0)\n",
        "        outline.set_stroke(WHITE, 2)\n",
        "        outline.set_fill(BLACK, 1)\n",
        "        image = Group(outline, image)\n",
        "        image.set_height(3.5, about_edge=UL)\n",
        "\n",
        "        # What's the paradox?\n",
        "        self.add(image)\n",
        "        self.student_says(\n",
        "            \"How's that\\\\\\\\a paradox?\",\n",
        "            target_mode=\"sassy\",\n",
        "            look_at=self.teacher.eyes,\n",
        "            index=2,\n",
        "            added_anims=[\n",
        "                self.students[0].change, \"pondering\", image,\n",
        "                self.students[1].change, \"pondering\", image,\n",
        "            ]\n",
        "        )\n",
        "        self.play(self.teacher.change, 'guilty')\n",
        "        self.wait(3)\n",
        "\n",
        "        # Consider test accuracy\n",
        "        self.teacher_says(\n",
        "            \"Consider the\\\\\\\\\", \"test accuracy\"\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "        # Test accuracy split\n",
        "        lower_words = self.teacher.bubble.content[1].copy()\n",
        "\n",
        "        top_words = OldTexText(\"Test Accuracy\", font_size=72)\n",
        "        top_words.to_corner(UR)\n",
        "        top_words.shift(LEFT)\n",
        "\n",
        "        sens_spec = VGroup(\n",
        "            OldTexText(\"Sensitivity\", color=YELLOW),\n",
        "            OldTexText(\"Specificity\", color=BLUE_D),\n",
        "        )\n",
        "        sens_spec.scale(1)\n",
        "        sens_spec.arrange(RIGHT, buff=1.0)\n",
        "        sens_spec.next_to(top_words, DOWN, LARGE_BUFF)\n",
        "        lines = VGroup(*(\n",
        "            Line(top_words.get_bottom(), word.get_top(), buff=0.1, color=word.get_color())\n",
        "            for word in sens_spec\n",
        "        ))\n",
        "\n",
        "        globals()['top_words'] = top_words\n",
        "        self.play(\n",
        "            TransformFromCopy(lower_words, top_words[0]),\n",
        "            RemovePiCreatureBubble(\n",
        "                self.teacher, target_mode=\"raise_right_hand\",\n",
        "                look_at=top_words,\n",
        "            ),\n",
        "            *(ApplyMethod(pi.look_at, top_words) for pi in self.students)\n",
        "        )\n",
        "        self.play(\n",
        "            LaggedStartMap(ShowCreation, lines),\n",
        "            LaggedStart(*(\n",
        "                FadeIn(word, shift=word.get_center() - top_words.get_center())\n",
        "                for word in sens_spec\n",
        "            )),\n",
        "            run_time=1,\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class MedicalTestsMatter(Scene):\n",
        "    def construct(self):\n",
        "        randy = Randolph(height=3)\n",
        "        randy.to_corner(DL)\n",
        "        randy.shift(2 * RIGHT)\n",
        "\n",
        "        clipboard = get_covid_clipboard()\n",
        "        clipboard.next_to(randy, RIGHT)\n",
        "        clipboard.set_y(0)\n",
        "\n",
        "        clipboard_words = VGroup(\n",
        "            OldTex(\"-\", color=RED),\n",
        "            OldTexText(\"SARS\\\\\\\\CoV-2\"),\n",
        "            OldTexText(\"Not Detected\", color=RED),\n",
        "        )\n",
        "        for m1, m2 in zip(clipboard_words, clipboard[2]):\n",
        "            m1.replace(m2, 0)\n",
        "\n",
        "        clipboard.remove(clipboard[2])\n",
        "\n",
        "        self.add(randy)\n",
        "        self.play(\n",
        "            FadeIn(clipboard, shift=LEFT),\n",
        "            randy.change, 'guilty'\n",
        "        )\n",
        "        self.play(\n",
        "            Write(clipboard_words),\n",
        "            randy.change, \"hooray\", clipboard,\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "\n",
        "        question = OldTexText(\"What does\\\\\\\\really this mean?\")\n",
        "        question.next_to(clipboard, RIGHT, buff=1.5)\n",
        "        question.shift(1.5 * UP)\n",
        "        q_arrow = Arrow(\n",
        "            question.get_bottom(), clipboard.get_right(),\n",
        "            path_arc=-30 * DEGREES,\n",
        "            buff=0.3,\n",
        "        )\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(question, shift=0.25 * UP),\n",
        "            DrawBorderThenFill(q_arrow),\n",
        "            randy.change, \"confused\",\n",
        "        )\n",
        "        self.play(randy.look_at, clipboard.get_top())\n",
        "        self.play(Blink(randy))\n",
        "        self.play(randy.look_at, clipboard.get_center())\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class GigerenzerSession(Scene):\n",
        "    def construct(self):\n",
        "        # Gigerenzer intro\n",
        "        years = OldTexText(\"2006-2007\", font_size=72)\n",
        "        years.to_edge(UP)\n",
        "\n",
        "        image = ImageMobject(\"Gerd_Gigerenzer\")\n",
        "        image.set_height(4)\n",
        "        image.flip()\n",
        "        name = OldTexText(\"Gerd Gigerenzer\", font_size=72)\n",
        "        name.next_to(image, DOWN)\n",
        "        image_group = Group(image, name)\n",
        "\n",
        "        self.play(FadeIn(years, shift=0.5 * UP))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(image),\n",
        "            Write(name)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Seminar words\n",
        "        title = OldTexText(\"Statistics Seminar\", font_size=72)\n",
        "        title.to_edge(UP)\n",
        "\n",
        "        title_underline = Underline(title, buff=SMALL_BUFF)\n",
        "        title_underline.scale(1.1)\n",
        "        title_underline.set_stroke(GREY_B)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(title, shift=0.5 * UP),\n",
        "            FadeOut(years, shift=0.5 * UP),\n",
        "        )\n",
        "        self.play(ShowCreation(title_underline))\n",
        "        title.add(title_underline)\n",
        "\n",
        "        # Docs\n",
        "        doctors = ImageMobject(\"doctor_pair\", height=2)\n",
        "        doctors.to_corner(DL, buff=1)\n",
        "        doctors_label = OldTexText(\"Practicing Gynecologists\")\n",
        "        doctors_label.match_width(doctors)\n",
        "        doctors_label.next_to(doctors, DOWN)\n",
        "        doctors_label.set_fill(GREY_A)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(doctors, scale=1.1),\n",
        "            Write(doctors_label, run_time=1),\n",
        "            image_group.scale, 0.75,\n",
        "            image_group.to_corner, DR,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Description of patient\n",
        "        prompt = OldTexText(\n",
        "            \"\"\"\n",
        "            A 50-year-old woman, no symptoms, participates\\\\\\\\\n",
        "            in routine mammography screening.\n",
        "            \"\"\",\n",
        "            \"\"\"She tests positive,\\\\\\\\\n",
        "            is alarmed, and wants to know from you whether she\\\\\\\\\n",
        "            has breast cancer for certain or what the chances are.\\\\\\\\\n",
        "            \\\\quad \\\\\\\\\n",
        "            \"\"\",\n",
        "            \"\"\"\n",
        "            Apart from the screening results, you know nothing\\\\\\\\\n",
        "            else about this woman.\\\\\\\\\n",
        "            \"\"\",\n",
        "            alignment=\"\",\n",
        "            font_size=36,\n",
        "        )\n",
        "        prompt.next_to(title_underline, DOWN, MED_LARGE_BUFF)\n",
        "        prompt[2].shift(0.5 * UP)\n",
        "        no_symptoms_part = prompt[0][18:28]\n",
        "        no_symptoms_underline = Underline(\n",
        "            no_symptoms_part,\n",
        "            buff=0,\n",
        "            stroke_width=3,\n",
        "            stroke_color=YELLOW,\n",
        "        )\n",
        "\n",
        "        clipboard = SVGMobject(\n",
        "            \"clipboard\",\n",
        "            stroke_width=0,\n",
        "            fill_color=interpolate_color(GREY_BROWN, WHITE, 0.2)\n",
        "        )\n",
        "        clipboard.next_to(prompt, DOWN)\n",
        "        clipboard.set_width(2.5)\n",
        "\n",
        "        clipboard_contents = VGroup(\n",
        "            OldTexText(\"+\", color=GREEN, font_size=96, stroke_width=3),\n",
        "            OldTexText(\"Cancer\\\\\\\\detected\", color=GREY_A),\n",
        "        )\n",
        "        clipboard_contents.arrange(DOWN)\n",
        "        clipboard_contents.set_width(0.7 * clipboard.get_width())\n",
        "        clipboard_contents.move_to(clipboard)\n",
        "        clipboard_contents.shift(0.1 * DOWN)\n",
        "        clipboard.add(clipboard_contents)\n",
        "\n",
        "        self.play(FadeIn(prompt[0], lag_ratio=0.01))\n",
        "        self.wait()\n",
        "        self.play(ShowCreationThenFadeOut(no_symptoms_underline))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(prompt[1], lag_ratio=0.01),\n",
        "            prompt[0].set_opacity, 0.5,\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(clipboard, shift=0.5 * UP, scale=1.1),\n",
        "            image_group.scale, 0.75, {\"about_edge\": DR},\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(prompt[2], lag_ratio=0.01),\n",
        "            prompt[1].set_opacity, 0.5,\n",
        "            clipboard.scale, 0.7, {\"about_edge\": DOWN},\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Push prompt lower\n",
        "        prompt.generate_target()\n",
        "        prompt.target.set_opacity(0.8)\n",
        "        prompt.target.replace(image_group, 0)\n",
        "        prompt.target.scale(1.5, about_edge=RIGHT)\n",
        "\n",
        "        h_line = DashedLine(FRAME_WIDTH * LEFT / 2, FRAME_WIDTH * RIGHT / 2)\n",
        "        h_line.set_stroke(GREY_C)\n",
        "        h_line.next_to(clipboard, UP)\n",
        "        h_line.set_x(0)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(title, shift=UP),\n",
        "            MoveToTarget(prompt),\n",
        "            ShowCreation(h_line),\n",
        "            FadeOut(image_group, shift=DR),\n",
        "            clipboard.shift, 0.5 * LEFT,\n",
        "        )\n",
        "\n",
        "        # Test statistics\n",
        "        stats = VGroup(\n",
        "            OldTexText(\"Prevalence: \", \"1\\\\%\"),\n",
        "            OldTexText(\"Sensitivity: \", \"90\\\\%\"),\n",
        "            OldTexText(\"Specificity: \", \"91\\\\%\"),\n",
        "        )\n",
        "        stats.arrange(DOWN, buff=0.5, aligned_edge=LEFT)\n",
        "        stats.to_corner(UL, buff=LARGE_BUFF)\n",
        "        colors = [YELLOW, GREEN_B, GREY_B]\n",
        "        for stat, color in zip(stats, colors):\n",
        "            stat[0].set_color(color)\n",
        "            stat[1].align_to(stats[0][1], LEFT)\n",
        "\n",
        "        for stat in stats:\n",
        "            self.play(FadeIn(stat[0], shift=0.25 * UP))\n",
        "            self.play(Write(stat[1]))\n",
        "            self.wait()\n",
        "        self.wait()\n",
        "\n",
        "        # Show randy knowing the answer\n",
        "        randy = Randolph(height=2)\n",
        "        randy.flip()\n",
        "        randy.next_to(h_line, UP)\n",
        "        randy.to_edge(RIGHT)\n",
        "\n",
        "        bubble = randy.get_bubble(\n",
        "            height=2,\n",
        "            width=2,\n",
        "        )\n",
        "        bubble.shift(0.2 * LEFT)\n",
        "        bubble.write(\"$\\\\frac{1}{11}$\")\n",
        "\n",
        "        self.play(FadeIn(randy))\n",
        "        self.play(\n",
        "            randy.change, \"thinking\",\n",
        "            ShowCreation(bubble),\n",
        "            Write(bubble.content),\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        # Show population\n",
        "        dot = Dot()\n",
        "        globals()['dot'] = dot\n",
        "        dots = VGroup(*(dot.copy() for x in range(1000)))\n",
        "        dots.arrange_in_grid(25, 40, buff=SMALL_BUFF)\n",
        "        dots.set_height(4)\n",
        "        dots.to_corner(UR)\n",
        "        dots.set_fill(GREY_D)\n",
        "        VGroup(*random.sample(list(dots), 10)).set_fill(YELLOW)\n",
        "\n",
        "        cross = Cross(dots)\n",
        "        cross.set_stroke(RED, 30)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeOut, VGroup(randy, bubble, bubble.content)),\n",
        "            ShowIncreasingSubsets(dots, run_time=2)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(ShowCreation(cross))\n",
        "        self.play(FadeOut(dots), FadeOut(cross))\n",
        "        self.wait()\n",
        "        self.play(LaggedStart(*(\n",
        "            ShowCreationThenFadeOut(SurroundingRectangle(\n",
        "                stat[1], color=stat[0].get_color()\n",
        "            ))\n",
        "            for stat in stats\n",
        "        )))\n",
        "\n",
        "        # Ask question\n",
        "        question = OldTexText(\n",
        "            \"How many women who test positive\\\\\\\\actually have breast cancer?\",\n",
        "            font_size=36\n",
        "        )\n",
        "        question.to_corner(UR)\n",
        "        question.shift(LEFT)\n",
        "\n",
        "        self.play(FadeIn(question, lag_ratio=0.1))\n",
        "\n",
        "        choices = VGroup(\n",
        "            OldTexText(\"A) 9 in 10\"),\n",
        "            OldTexText(\"B) 8 in 10\"),\n",
        "            OldTexText(\"C) 1 in 10\"),\n",
        "            OldTexText(\"D) 1 in 100\"),\n",
        "        )\n",
        "        choices.arrange_in_grid(2, 2, h_buff=1.0, v_buff=0.5, aligned_edge=LEFT)\n",
        "        choices.next_to(question, DOWN, buff=0.75)\n",
        "        choices.set_fill(GREY_A)\n",
        "\n",
        "        self.play(LaggedStart(*(\n",
        "            FadeIn(choice, scale=1.2)\n",
        "            for choice in choices\n",
        "        ), lag_ratio=0.3))\n",
        "        self.wait()\n",
        "\n",
        "        # Comment on choices\n",
        "        a_rect = SurroundingRectangle(choices[0])\n",
        "        a_rect.set_color(BLUE)\n",
        "        q_mark = OldTex(\"?\")\n",
        "        q_mark.match_height(a_rect)\n",
        "        q_mark.next_to(a_rect, LEFT)\n",
        "        q_mark.match_color(a_rect)\n",
        "        q_mark2 = q_mark.copy()\n",
        "        q_mark2.move_to(doctors, UR)\n",
        "\n",
        "        c_rect = SurroundingRectangle(choices[2])\n",
        "        c_rect.set_color(GREEN)\n",
        "        checkmark = Checkmark().next_to(c_rect, LEFT)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(a_rect),\n",
        "            Write(q_mark2)\n",
        "        )\n",
        "        self.play(TransformFromCopy(q_mark2, q_mark))\n",
        "        self.wait()\n",
        "\n",
        "        # One fifth of doctors\n",
        "        curr_doc_group = Group(\n",
        "            doctors,\n",
        "            clipboard,\n",
        "            doctors_label,\n",
        "            q_mark2,\n",
        "        )\n",
        "\n",
        "        new_doctors = VGroup(\n",
        "            SVGMobject(\"female_doctor\"),\n",
        "            SVGMobject(\"female_doctor\"),\n",
        "            SVGMobject(\"female_doctor\"),\n",
        "            SVGMobject(\"male_doctor\"),\n",
        "            SVGMobject(\"male_doctor\"),\n",
        "        )\n",
        "        for doc in new_doctors:\n",
        "            doc.remove(doc[0])\n",
        "            doc.set_stroke(width=0)\n",
        "            doc.set_fill(GREY_B)\n",
        "        new_doctors.arrange_in_grid(2, 2, buff=MED_LARGE_BUFF)\n",
        "        new_doctors[4].move_to(new_doctors[:4])\n",
        "        new_doctors.set_height(2.75)\n",
        "        new_doctors.move_to(doctors, UP)\n",
        "\n",
        "        marks = VGroup()\n",
        "        for n, doc in enumerate(new_doctors):\n",
        "            mark = Checkmark() if n == 0 else Exmark()\n",
        "            mark.move_to(doc.get_corner(UL))\n",
        "            mark.shift(SMALL_BUFF * DR)\n",
        "            marks.add(mark)\n",
        "\n",
        "        new_doctors[0].set_color(GREEN)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeOut, curr_doc_group, scale=0.5, run_time=1),\n",
        "            FadeIn(new_doctors, lag_ratio=0.1)\n",
        "        )\n",
        "        self.play(\n",
        "            ReplacementTransform(a_rect, c_rect),\n",
        "            FadeOut(q_mark),\n",
        "            Write(checkmark)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class OldGigerenzerMaterial(Scene):\n",
        "    def construct(self):\n",
        "        # Test sensitivity\n",
        "        prompt.generate_target()\n",
        "        prompt.target.set_opacity(0.8)\n",
        "        prompt.target.match_height(clipboard)\n",
        "        prompt.target.scale(0.65)\n",
        "        prompt.target.next_to(clipboard, RIGHT, MED_LARGE_BUFF)\n",
        "\n",
        "        sensitivity_words = OldTex(\"90\", \"\\\\%\", \"\\\\text{ Sensitivity}\")\n",
        "        sensitivity_words.to_edge(UP)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(sensitivity_words),\n",
        "            FadeOut(title, shift=UP),\n",
        "            MoveToTarget(prompt),\n",
        "            ShowCreation(h_line)\n",
        "        )\n",
        "\n",
        "        woman = WomanIcon()\n",
        "        women = VGroup(*[woman.copy() for x in range(100)])\n",
        "        women.arrange_in_grid(h_buff=2, v_buff=1)\n",
        "        women.set_height(3)\n",
        "        women.next_to(sensitivity_words, DOWN)\n",
        "        women_rect = SurroundingRectangle(women, buff=0.15)\n",
        "        women_rect.set_stroke(YELLOW, 2)\n",
        "\n",
        "        with_bc_label = OldTexText(\n",
        "            \"Women\\\\\\\\with\\\\\\\\breast\\\\\\\\cancer\",\n",
        "            font_size=36,\n",
        "            color=women_rect.get_color()\n",
        "        )\n",
        "        with_bc_label.next_to(women_rect, LEFT)\n",
        "\n",
        "        women.generate_target()\n",
        "        signs = VGroup()\n",
        "        for n, woman in enumerate(women.target):\n",
        "            if n < 90:\n",
        "                sign = OldTex(\"+\", color=GREEN)\n",
        "                woman.set_color(GREEN)\n",
        "            else:\n",
        "                sign = OldTex(\"-\", color=RED)\n",
        "                woman.set_color(RED)\n",
        "            sign.match_width(woman)\n",
        "            sign.move_to(woman.get_corner(UR), LEFT)\n",
        "            signs.add(sign)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(women_rect),\n",
        "            FadeIn(with_bc_label),\n",
        "            FadeIn(women, lag_ratio=0.01),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            MoveToTarget(women),\n",
        "            FadeIn(signs, lag_ratio=0.01)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        sens_group = VGroup(\n",
        "            sensitivity_words,\n",
        "            with_bc_label,\n",
        "            women_rect,\n",
        "            women,\n",
        "            signs\n",
        "        )\n",
        "\n",
        "        # Specificity\n",
        "        specificity_words = OldTex(\"91\", \"\\\\%\", \"\\\\text{ Specificity}\")\n",
        "        specificity_words.move_to(sensitivity_words)\n",
        "        spec_women = women.copy()\n",
        "        spec_women.set_fill(GREY_C)\n",
        "        spec_rect = women_rect.copy()\n",
        "        spec_rect.set_color(interpolate_color(GREY_BROWN, WHITE, 0.5))\n",
        "        wo_bc_label = OldTexText(\n",
        "            \"Women\\\\\\\\ \\\\emph{without} \\\\\\\\breast\\\\\\\\cancer\",\n",
        "            font_size=36,\n",
        "        )\n",
        "        wo_bc_label.next_to(spec_rect, LEFT)\n",
        "        wo_bc_label.match_color(spec_rect)\n",
        "\n",
        "        spec_group = VGroup(\n",
        "            specificity_words,\n",
        "            wo_bc_label,\n",
        "            spec_rect,\n",
        "            spec_women,\n",
        "        )\n",
        "        spec_group.next_to(ORIGIN, RIGHT, buff=1)\n",
        "        spec_group.to_edge(UP)\n",
        "\n",
        "        self.play(\n",
        "            sens_group.next_to, ORIGIN, LEFT, {\"buff\": 2},\n",
        "            sens_group.to_edge, UP,\n",
        "            FadeIn(spec_group, shift=RIGHT),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        spec_women.generate_target()\n",
        "        spec_signs = VGroup()\n",
        "        for n, woman in enumerate(spec_women.target):\n",
        "            if n < 9:\n",
        "                sign = OldTex(\"+\", color=GREEN)\n",
        "                woman.set_color(GREEN)\n",
        "            else:\n",
        "                sign = OldTex(\"-\", color=RED)\n",
        "                woman.set_color(RED)\n",
        "            sign.match_width(woman)\n",
        "            sign.move_to(woman.get_corner(UR), LEFT)\n",
        "            spec_signs.add(sign)\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(spec_women),\n",
        "            FadeIn(spec_signs, lag_ratio=0.01)\n",
        "        )\n",
        "        self.wait()\n",
        "        spec_group.add(spec_signs)\n",
        "\n",
        "        # False negatives/False positives\n",
        "        fnr = OldTex(\n",
        "            \"\\\\leftarrow\", \"10\", \"\\\\%\", \" \\\\text{ false negative}\",\n",
        "            font_size=36,\n",
        "        )\n",
        "        fnr.next_to(women[-1], RIGHT, buff=0.3)\n",
        "\n",
        "        fpr = OldTex(\n",
        "            \"9\", \"\\\\%\", \"\\\\text{ false positive}\", \"\\\\rightarrow\",\n",
        "            font_size=36,\n",
        "        )\n",
        "        fpr.next_to(spec_women[0], LEFT, buff=0.3)\n",
        "\n",
        "        self.play(FadeIn(fnr, shift=0.2 * RIGHT, scale=2))\n",
        "        self.play(FadeIn(fpr, shift=0.2 * LEFT, scale=2))\n",
        "\n",
        "\n",
        "class AskIfItsAParadox(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Add fact\n",
        "        stats = VGroup(\n",
        "            OldTexText(\"Sensitivity: \", \"90\\\\%\"),\n",
        "            OldTexText(\"Specificity: \", \"91\\\\%\"),\n",
        "            OldTexText(\"Prevalence: \", \"1\\\\%\"),\n",
        "        )\n",
        "        stats.arrange(DOWN, buff=0.25, aligned_edge=LEFT)\n",
        "        for stat, color in zip(stats, [GREEN_B, GREY_B, YELLOW]):\n",
        "            stat[0].set_color(color)\n",
        "            stat[1].align_to(stats[0][1], LEFT)\n",
        "\n",
        "        brace = Brace(stats, UP)\n",
        "        prob = OldTex(\n",
        "            \"P(\\\\text{Cancer} \\\\,|\\\\, +) \\\\approx \\\\frac{1}{11}\",\n",
        "            tex_to_color_map={\n",
        "                \"\\\\text{Cancer}\": YELLOW,\n",
        "                \"+\": GREEN,\n",
        "            }\n",
        "        )\n",
        "        prob.next_to(brace, UP, buff=SMALL_BUFF)\n",
        "\n",
        "        fact = VGroup(stats, brace, prob)\n",
        "        fact.to_corner(UL)\n",
        "\n",
        "        box = SurroundingRectangle(fact, buff=MED_SMALL_BUFF)\n",
        "        box.set_fill(BLACK, 0.5)\n",
        "        box.set_stroke(WHITE, 2)\n",
        "        fact.add_to_back(box)\n",
        "        fact.to_edge(UP, buff=SMALL_BUFF)\n",
        "\n",
        "        self.add(fact)\n",
        "\n",
        "        # Commentary\n",
        "        self.student_says(\n",
        "            \"I'm sorry, is that\\\\\\\\a paradox?\",\n",
        "            target_mode=\"sassy\",\n",
        "            index=1\n",
        "        )\n",
        "        self.play_student_changes(\n",
        "            \"angry\", \"sassy\", \"angry\",\n",
        "            added_anims=[self.teacher.change, \"guilty\"]\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        p_triangle = SVGMobject(\"PenroseTriangle\")\n",
        "        p_triangle.remove(p_triangle[0])\n",
        "        p_triangle.set_fill(opacity=0)\n",
        "        p_triangle.set_stroke(GREY_B, 3)\n",
        "        p_triangle.set_gloss(1)\n",
        "        p_triangle.set_height(3)\n",
        "        p_triangle.next_to(self.students[2].get_corner(UR), UP)\n",
        "        p_triangle = CurvesAsSubmobjects(p_triangle[0])\n",
        "\n",
        "        self.play(\n",
        "            self.students[0].change, \"thinking\", p_triangle,\n",
        "            RemovePiCreatureBubble(\n",
        "                self.students[1], target_mode=\"tease\", look_at=p_triangle,\n",
        "            ),\n",
        "            self.students[2].change, \"raise_right_hand\", p_triangle,\n",
        "            self.teacher.change, \"tease\", p_triangle,\n",
        "            ShowCreation(p_triangle, run_time=2, lag_ratio=0.01),\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "        # Veridical paradox\n",
        "        v_paradox = OldTexText(\"``Veridical paradox''\", font_size=72)\n",
        "        v_paradox.move_to(self.hold_up_spot, DOWN)\n",
        "        v_paradox.to_edge(UP)\n",
        "        v_paradox.shift(0.5 * LEFT)\n",
        "        vp_line = Underline(v_paradox)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(v_paradox, shift=UP),\n",
        "            self.change_students(*3 * [\"pondering\"], look_at=v_paradox),\n",
        "            FadeOut(p_triangle, shift=UP),\n",
        "            self.teacher.change, \"raise_right_hand\", v_paradox\n",
        "        )\n",
        "        self.play(ShowCreation(vp_line))\n",
        "        self.wait()\n",
        "\n",
        "        definition = OldTexText(\n",
        "            \"- Provably true\\\\\\\\\",\n",
        "            \"- Seems false\",\n",
        "            alignment=\"\",\n",
        "        )\n",
        "        definition.next_to(v_paradox, DOWN, MED_LARGE_BUFF, aligned_edge=LEFT)\n",
        "\n",
        "        for part in definition:\n",
        "            self.play(FadeIn(part, shift=0.25 * RIGHT))\n",
        "            self.wait()\n",
        "        self.wait(5)\n",
        "\n",
        "\n",
        "class GoalsOfEstimation(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Goal\n",
        "        goal = OldTexText(\"Goal: Quick estimations\")\n",
        "        goal.to_edge(UP)\n",
        "        goal_line = Underline(goal)\n",
        "\n",
        "        self.look_at(goal, added_anims=[FadeIn(goal, shift=0.5 * UP)])\n",
        "        self.play(\n",
        "            ShowCreation(goal_line),\n",
        "            self.change_students(\n",
        "                *3 * [\"pondering\"],\n",
        "                look_at=goal_line,\n",
        "            )\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Generators\n",
        "        def generate_stats(prev, sens, spec, bottom=self.hold_up_spot):\n",
        "            stats = VGroup(\n",
        "                OldTexText(\"Prevalence: \", f\"{prev}\\\\%\"),\n",
        "                OldTexText(\"Sensitivity: \", f\"{sens}\\\\%\"),\n",
        "                OldTexText(\"Specificity: \", f\"{spec}\\\\%\"),\n",
        "            )\n",
        "            stats.arrange(DOWN, buff=0.25, aligned_edge=LEFT)\n",
        "            for stat, color in zip(stats, [YELLOW, GREEN_B, GREY_B]):\n",
        "                stat[0].set_color(color)\n",
        "                stat[1].align_to(stats[0][1], LEFT)\n",
        "\n",
        "            rect = SurroundingRectangle(stats, buff=0.2)\n",
        "            rect.set_fill(BLACK, 1)\n",
        "            rect.set_stroke(GREY_B, 2)\n",
        "            stats.add_to_back(rect)\n",
        "            stats.move_to(bottom, DOWN)\n",
        "            return stats\n",
        "\n",
        "        def generate_answer(ans_tex):\n",
        "            return OldTex(\n",
        "                \"P(\\\\text{Cancer} \\\\,|\\\\, {+})\", ans_tex,\n",
        "                tex_to_color_map={\n",
        "                    \"\\\\text{Cancer}\": YELLOW,\n",
        "                    \"{+}\": GREEN,\n",
        "                }\n",
        "            )\n",
        "\n",
        "        stats = [\n",
        "            generate_stats(1, 90, 91),\n",
        "            generate_stats(10, 90, 91),\n",
        "            generate_stats(0.1, 90, 91),\n",
        "            generate_stats(1, 90, 99),\n",
        "        ]\n",
        "\n",
        "        # Question and answer\n",
        "        self.teacher_holds_up(stats[0])\n",
        "        self.wait()\n",
        "        self.student_says(\n",
        "            generate_answer(\"\\\\approx \\\\frac{1}{11}\"),\n",
        "            target_mode=\"hooray\",\n",
        "            index=0,\n",
        "            run_time=1,\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "        stats[1].to_edge(RIGHT)\n",
        "        self.play(\n",
        "            FadeOut(stats[0]),\n",
        "            self.teacher.change, \"raise_left_hand\", stats[1],\n",
        "            FadeIn(stats[1], shift=0.5 * UP),\n",
        "            RemovePiCreatureBubble(self.students[0]),\n",
        "        )\n",
        "        self.play(ShowCreationThenFadeAround(stats[1][1][1]))\n",
        "        self.play_student_changes(\n",
        "            \"pondering\", \"thinking\", \"confused\",\n",
        "            look_at=stats[1]\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.student_says(\n",
        "            generate_answer(\"\\\\text{ is} \\\\\\\\ \\\\text{a little over } 50\\\\%\"),\n",
        "            bubble_config={\"width\": 4, \"height\": 3},\n",
        "            index=1,\n",
        "            target_mode=\"speaking\",\n",
        "            run_time=1,\n",
        "            added_anims=[\n",
        "                self.students[2].change, \"erm\", goal,\n",
        "                self.teacher.change, \"happy\", self.students[1].eyes,\n",
        "            ]\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(stats[1], 0.5 * UP),\n",
        "            FadeIn(stats[2], 0.5 * UP),\n",
        "            RemovePiCreatureBubble(self.students[1]),\n",
        "            self.teacher.change, \"raise_right_hand\", stats[2],\n",
        "            self.change_students(*3 * [\"pondering\"], look_at=stats[2])\n",
        "        )\n",
        "        self.play(ShowCreationThenFadeAround(stats[2][1][1]))\n",
        "        self.wait(2)\n",
        "\n",
        "        self.student_says(\n",
        "            generate_answer(\"\\\\approx \\\\frac{1}{100}\"),\n",
        "            bubble_config={\"width\": 4, \"height\": 3},\n",
        "            index=0,\n",
        "            target_mode=\"tease\",\n",
        "            run_time=1,\n",
        "        )\n",
        "        self.look_at(self.students[0].bubble.content)\n",
        "        self.wait(2)\n",
        "\n",
        "        stats[3].to_edge(RIGHT)\n",
        "        self.play(\n",
        "            FadeOut(stats[2], 0.5 * UP),\n",
        "            FadeIn(stats[3], 0.5 * UP),\n",
        "            self.teacher.change, \"raise_left_hand\",\n",
        "            RemovePiCreatureBubble(self.students[0]),\n",
        "            *(ApplyMethod(pi.look_at, stats[3]) for pi in self.pi_creatures)\n",
        "        )\n",
        "        self.play(ShowCreationThenFadeAround(stats[3][1][1]))\n",
        "        self.play(\n",
        "            ShowCreationThenFadeAround(\n",
        "                stats[3][3][1],\n",
        "                surrounding_rectangle_config={\"color\": TEAL},\n",
        "            ),\n",
        "            self.teacher.change, \"tease\", stats[3]\n",
        "        )\n",
        "        self.play_student_changes(\n",
        "            \"pondering\", \"thinking\", \"confused\",\n",
        "            look_at=self.teacher.get_bottom(),\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.student_says(\n",
        "            generate_answer(\"\\\\text{ is} \\\\\\\\ \\\\text{a little below } 50\\\\%\"),\n",
        "            bubble_config={\"width\": 4, \"height\": 3},\n",
        "            index=1,\n",
        "            target_mode=\"speaking\",\n",
        "            run_time=1,\n",
        "            added_anims=[\n",
        "                self.students[0].change, \"erm\", goal,\n",
        "                self.students[2].change, \"confused\", goal,\n",
        "                self.teacher.change, \"happy\", self.students[1].eyes,\n",
        "            ]\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play_student_changes(\n",
        "            \"thinking\", \"hooray\", \"thinking\",\n",
        "            look_at=self.students[1].bubble.content,\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class QuickEstimatesAndMisconceptions(Scene):\n",
        "    def construct(self):\n",
        "        titles = VGroup(\n",
        "            OldTexText(\"Quick\\\\\\\\estimations\"),\n",
        "            OldTexText(\"Combating\\\\\\\\misconceptions\"),\n",
        "        )\n",
        "        for title, u in zip(titles, [-1, 1]):\n",
        "            title.set_x(u * FRAME_WIDTH / 4)\n",
        "        titles.to_edge(UP, buff=MED_SMALL_BUFF)\n",
        "\n",
        "        circles = VGroup(\n",
        "            Circle(color=BLUE),\n",
        "            Circle(color=RED),\n",
        "        )\n",
        "        circles[1].flip()\n",
        "        circles.set_height(4)\n",
        "        circles.set_stroke(width=3)\n",
        "        circles.set_fill(opacity=0.5)\n",
        "\n",
        "        for circle, title, u in zip(circles, titles, [-1, 1]):\n",
        "            circle.set_x(u)\n",
        "            title.set_color(\n",
        "                interpolate_color(circle.get_color(), WHITE, 0.5)\n",
        "            )\n",
        "            title.next_to(circle, UP)\n",
        "            title.shift(u * RIGHT)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeIn, titles, shift=0.2 * UP),\n",
        "            LaggedStartMap(DrawBorderThenFill, circles),\n",
        "            run_time=1.5,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        arrow = OldTex(\"\\\\leftrightarrow\", font_size=72)\n",
        "        arrow.move_to(circles)\n",
        "        self.play(\n",
        "            circles[0].next_to, arrow, LEFT,\n",
        "            circles[1].next_to, arrow, RIGHT,\n",
        "            titles[0].shift, 0.7 * LEFT,\n",
        "            titles[1].shift, 0.7 * RIGHT,\n",
        "            GrowFromCenter(arrow),\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            FadeOut(arrow, DOWN),\n",
        "            circles[0].shift, 2.0 * RIGHT,\n",
        "            circles[1].shift, 2.0 * LEFT,\n",
        "            titles[0].shift, 1.0 * RIGHT,\n",
        "            titles[1].shift, 1.0 * LEFT,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        titles[1].save_state()\n",
        "        self.play(\n",
        "            FadeOut(titles[0]),\n",
        "            FadeOut(circles[0]),\n",
        "            titles[1].match_x, circles[1]\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        circles[0].save_state()\n",
        "        titles[0].save_state()\n",
        "        circles[0].next_to(circles[1], LEFT, MED_LARGE_BUFF)\n",
        "        titles[0].next_to(circles[0], UP)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(titles[0]),\n",
        "            FadeIn(circles[0]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        bayes_factor = OldTexText(\"Bayes\\\\\\\\factor\", font_size=72)\n",
        "        bayes_factor.move_to(circles[0])\n",
        "\n",
        "        self.play(Write(bayes_factor))\n",
        "        self.wait()\n",
        "        restoration_group = VGroup(circles[0], titles[0], titles[1])\n",
        "        self.add(restoration_group, bayes_factor)\n",
        "        self.play(\n",
        "            bayes_factor.move_to, VGroup(circles[0].saved_state, circles[1]),\n",
        "            LaggedStartMap(Restore, restoration_group)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class WhatDoYouTellThem(Scene):\n",
        "    def construct(self):\n",
        "        text = OldTexText(\"What do you tell them?\", font_size=72)\n",
        "        text.set_color(BLUE)\n",
        "        self.play(Write(text))\n",
        "        self.wait(5)\n",
        "\n",
        "\n",
        "class AccuracyImage(Scene):\n",
        "    def construct(self):\n",
        "        sens = 90\n",
        "        spec = 91\n",
        "        stats = VGroup(\n",
        "            OldTexText(\"Sensitivity: \", f\"{sens}\\\\%\"),\n",
        "            OldTexText(\"Specificity: \", f\"{spec}\\\\%\"),\n",
        "        )\n",
        "        stats.arrange(DOWN, buff=0.25, aligned_edge=LEFT)\n",
        "        for stat, color in zip(stats, [GREEN_B, GREY_B]):\n",
        "            stat[0].set_color(color)\n",
        "            stat[1].align_to(stats[0][1], LEFT)\n",
        "\n",
        "        rect = SurroundingRectangle(stats, buff=0.2)\n",
        "        rect.set_fill(GREY_E, 1)\n",
        "        rect.set_stroke(GREY_B, 2)\n",
        "        stats.add_to_back(rect)\n",
        "        self.add(stats)\n",
        "\n",
        "\n",
        "class SamplePopulation10PercentPrevalence(Scene):\n",
        "    def construct(self):\n",
        "        # Setup test accuracy figures\n",
        "        accuracy_figures = VGroup(\n",
        "            OldTexText(\n",
        "                \"90\\\\% Sensitivity,\", \" 10\\\\% False negative rate\",\n",
        "                font_size=36\n",
        "            ),\n",
        "            OldTexText(\n",
        "                \"91\\\\% Specificity,\", \" 9\\\\% False positive rate\",\n",
        "                font_size=36\n",
        "            ),\n",
        "        )\n",
        "        accuracy_figures.arrange(RIGHT, buff=LARGE_BUFF)\n",
        "        accuracy_figures.to_edge(UP)\n",
        "\n",
        "        for color, text in zip([YELLOW, GREY], accuracy_figures):\n",
        "            text.add(Underline(text, color=color, stroke_width=2))\n",
        "\n",
        "        # Show population\n",
        "        population = VGroup(*[WomanIcon() for x in range(100)])\n",
        "        population.arrange_in_grid(fill_rows_first=False)\n",
        "        population.set_height(5)\n",
        "        population.next_to(accuracy_figures, DOWN, LARGE_BUFF)\n",
        "        cancer_cases = population[:10]\n",
        "        healthy_cases = population[10:]\n",
        "        cancer_cases.set_fill(YELLOW)\n",
        "        healthy_cases.set_fill(GREY)\n",
        "\n",
        "        population.generate_target()\n",
        "        reordered_pop = VGroup(*population)\n",
        "        reordered_pop.shuffle()\n",
        "        for m1, m2 in zip(reordered_pop, population.target):\n",
        "            m1.move_to(m2)\n",
        "        population.target[:10].next_to(accuracy_figures[0], DOWN, MED_LARGE_BUFF)\n",
        "        population.target[10:].next_to(accuracy_figures[1], DOWN, MED_LARGE_BUFF)\n",
        "\n",
        "        pop_words = OldTexText(\"100\", \" patients\")\n",
        "        wc_words = OldTexText(\"10\", \" with cancer\")\n",
        "        wo_words = OldTexText(\"90\", \" without cancer\")\n",
        "\n",
        "        pop_words.next_to(population, DOWN)\n",
        "        wc_words.next_to(population.target[:10], DOWN)\n",
        "        wo_words.next_to(population.target[10:], DOWN)\n",
        "        for words in wc_words, wo_words:\n",
        "            words.save_state()\n",
        "            words[0].replace(pop_words[0], stretch=True)\n",
        "            words[1].replace(pop_words[1], stretch=True)\n",
        "            words.set_opacity(0)\n",
        "\n",
        "        title = OldTexText(\"Picture a concrete population\", font_size=72)\n",
        "        title.to_edge(UP)\n",
        "        self.add(title)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(population, lag_ratio=0.05, run_time=3),\n",
        "            FadeIn(pop_words),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            MoveToTarget(population, run_time=2),\n",
        "            Restore(wc_words),\n",
        "            Restore(wo_words),\n",
        "            FadeOut(pop_words),\n",
        "            title.shift, 0.25 * UP,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show test stats\n",
        "        self.play(\n",
        "            FadeOut(title, shift=UP),\n",
        "            FadeIn(accuracy_figures[0], 0.5 * UP)\n",
        "        )\n",
        "\n",
        "        # Show test results\n",
        "        c_boxes = VGroup(*(\n",
        "            SurroundingRectangle(icon, buff=0)\n",
        "            for icon in cancer_cases\n",
        "        ))\n",
        "        h_boxes = VGroup(*(\n",
        "            SurroundingRectangle(icon, buff=0)\n",
        "            for icon in healthy_cases\n",
        "        ))\n",
        "        all_boxes = VGroup(c_boxes, h_boxes)\n",
        "        all_boxes.set_stroke(width=3)\n",
        "\n",
        "        c_boxes[:9].set_stroke(GREEN)\n",
        "        c_boxes[9:].set_stroke(RED)\n",
        "        h_boxes.set_stroke(RED)\n",
        "\n",
        "        false_positives = healthy_cases[0:80:10]\n",
        "        false_positive_boxes = h_boxes[0:80:10]\n",
        "        false_positive_boxes.set_stroke(GREEN)\n",
        "\n",
        "        for n, box in enumerate(c_boxes):\n",
        "            tex = \"+\" if n < 9 else \"-\"\n",
        "            sign = OldTex(tex, font_size=36)\n",
        "            sign.next_to(box, RIGHT, SMALL_BUFF)\n",
        "            sign.match_color(box)\n",
        "            box.add(sign)\n",
        "\n",
        "        for box in false_positive_boxes:\n",
        "            sign = OldTex(\"+\", font_size=36)\n",
        "            sign.next_to(box, UP, SMALL_BUFF)\n",
        "            sign.match_color(box)\n",
        "            box.add(sign)\n",
        "\n",
        "        for i, boxes in (0, c_boxes), (1, h_boxes):\n",
        "            if i == 1:\n",
        "                self.play(FadeIn(accuracy_figures[1]))\n",
        "            self.play(ShowCreationThenFadeOut(SurroundingRectangle(\n",
        "                accuracy_figures[i][i],\n",
        "                buff=SMALL_BUFF,\n",
        "                stroke_color=GREEN,\n",
        "            )))\n",
        "            self.wait()\n",
        "            self.play(ShowIncreasingSubsets(boxes))\n",
        "            self.wait()\n",
        "\n",
        "        for icon, box in zip(cancer_cases, c_boxes):\n",
        "            icon.add(box)\n",
        "        for icon, box in zip(healthy_cases, h_boxes):\n",
        "            icon.add(box)\n",
        "\n",
        "        self.remove(all_boxes)\n",
        "        self.add(population)\n",
        "\n",
        "        # Filter down to positive cases\n",
        "        new_wc_words = OldTexText(\"9 \", \"with cancer\")\n",
        "        new_wo_words = OldTexText(\"8 \", \"without cancer\")\n",
        "        for nw, w in (new_wc_words, wc_words), (new_wo_words, wo_words):\n",
        "            nw[0].set_color(GREEN)\n",
        "            nw.move_to(w)\n",
        "\n",
        "        self.play(\n",
        "            cancer_cases[:9].move_to, cancer_cases,\n",
        "            FadeOut(cancer_cases[9:]),\n",
        "            ReplacementTransform(wc_words, new_wc_words),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            false_positives.move_to, healthy_cases,\n",
        "            FadeOut(VGroup(*(\n",
        "                case for case in healthy_cases\n",
        "                if case not in false_positives\n",
        "            ))),\n",
        "            ReplacementTransform(wo_words, new_wo_words),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Rearrange true positives\n",
        "        false_positives.generate_target()\n",
        "        false_positives.target.shift(DOWN)\n",
        "        true_positives = cancer_cases[:9]\n",
        "        true_positives.generate_target()\n",
        "        for case in true_positives.target:\n",
        "            box = case[-1]\n",
        "            sign = box[-1]\n",
        "            sign.next_to(case[:-1], UP, SMALL_BUFF)\n",
        "        true_positives.target.arrange(\n",
        "            RIGHT,\n",
        "            buff=get_norm(false_positives[0].get_right() - false_positives[1].get_left()),\n",
        "        )\n",
        "        true_positives.target.match_y(false_positives.target)\n",
        "        true_positives.target.match_x(new_wc_words)\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(true_positives),\n",
        "            MoveToTarget(false_positives),\n",
        "            new_wc_words.next_to, true_positives.target, DOWN,\n",
        "            new_wo_words.next_to, false_positives.target, DOWN,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show final fraction\n",
        "        answer = OldTex(\n",
        "            \"{9 \\\\over 9 + 8} \\\\approx 0.53\",\n",
        "            font_size=72,\n",
        "        )[0]\n",
        "        answer.next_to(accuracy_figures, DOWN, LARGE_BUFF)\n",
        "        nine1 = new_wc_words[0].copy()\n",
        "        nine2 = new_wc_words[0].copy()\n",
        "        eight = new_wo_words[0].copy()\n",
        "\n",
        "        self.play(\n",
        "            nine1.replace, answer[0],\n",
        "            nine2.replace, answer[2],\n",
        "            eight.replace, answer[4],\n",
        "            Write(answer[1:5:2]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Write(answer[5:]))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class NinePercentOfNinety(Scene):\n",
        "    def construct(self):\n",
        "        mob = OldTex(\"(0.09)(90) = 8.1\", tex_to_color_map={\"8.1\": GREEN})\n",
        "        mob.scale(2)\n",
        "        self.add(mob)\n",
        "\n",
        "\n",
        "class MoreExamples(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        self.teacher_says(\n",
        "            \"More examples!\", target_mode=\"hooray\",\n",
        "            added_anims=[self.change_students(\"tired\", \"erm\", \"happy\", run_time=2)]\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class SamplePopulationOneInThousandPrevalence(Scene):\n",
        "    def construct(self):\n",
        "        # Add prevalence title\n",
        "        titles = VGroup(*(\n",
        "            OldTexText(\n",
        "                f\"What if prevalence is {n} in {k}?\",\n",
        "                tex_to_color_map={\n",
        "                    n: YELLOW,\n",
        "                    k: GREY_B,\n",
        "                }\n",
        "            )\n",
        "            for n, k in [(\"{1}\", \"{1,000}\"), (\"{10}\", \"{10,000}\")]\n",
        "        ))\n",
        "        titles.to_edge(UP)\n",
        "\n",
        "        self.add(titles[0])\n",
        "\n",
        "        # Show population\n",
        "        dots1k, dots10k = [\n",
        "            VGroup(*(Dot() for x in range(n))).set_fill(GREY_D)\n",
        "            for n in [1000, 10000]\n",
        "        ]\n",
        "        dots1k[:1].set_fill(YELLOW)\n",
        "        dots10k[:10].set_fill(YELLOW)\n",
        "\n",
        "        for dots, n, m in [(dots1k, 20, 50), (dots10k, 100, 100)]:\n",
        "            sorter = VGroup(*dots)\n",
        "            sorter.shuffle()\n",
        "            sorter.arrange_in_grid(n, m, buff=SMALL_BUFF)\n",
        "            sorter.set_width(FRAME_WIDTH - 1)\n",
        "            if sorter.get_height() > 6:\n",
        "                sorter.set_height(6)\n",
        "            sorter.to_edge(DOWN)\n",
        "\n",
        "        self.play(FadeIn(dots1k, lag_ratio=0.05, run_time=2))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Transform(dots1k, dots10k[0::10]),\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(dots10k),\n",
        "            ReplacementTransform(titles[0][0::2], titles[1][0::2]),\n",
        "            FadeOut(titles[0][1::2], 0.5 * UP),\n",
        "            FadeIn(titles[1][1::2], 0.5 * UP),\n",
        "        )\n",
        "        self.remove(dots1k)\n",
        "\n",
        "        # Split the group\n",
        "        cancer_cases = dots10k[:10]\n",
        "        cancer_cases.generate_target()\n",
        "        cancer_cases.target.arrange_in_grid(\n",
        "            buff=cancer_cases[0].get_width() / 2,\n",
        "        )\n",
        "        cancer_cases.target.set_height(2)\n",
        "        cancer_cases.target.set_y(0)\n",
        "        cancer_cases.target.to_edge(LEFT, buff=LARGE_BUFF)\n",
        "\n",
        "        non_cancer_cases = dots10k[10:]\n",
        "        non_cancer_cases.generate_target()\n",
        "        non_cancer_cases.target.to_edge(RIGHT)\n",
        "\n",
        "        c_count = titles[1][1].copy()\n",
        "        c_count.generate_target()\n",
        "        c_count.target.next_to(cancer_cases.target, UP, MED_LARGE_BUFF)\n",
        "        nc_count = Integer(9990)\n",
        "        nc_count.set_color(GREY_B)\n",
        "        nc_count.set_opacity(0)\n",
        "        nc_count.move_to(titles[1][3])\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(cancer_cases),\n",
        "            MoveToTarget(non_cancer_cases),\n",
        "            MoveToTarget(c_count),\n",
        "            nc_count.set_opacity, 1,\n",
        "            nc_count.next_to, non_cancer_cases.target, UP,\n",
        "            FadeOut(titles[1]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show test results\n",
        "        tp_cases = cancer_cases[:9]\n",
        "        fp_cases = VGroup(*random.sample(list(non_cancer_cases), 900))\n",
        "        for case in it.chain(tp_cases, fp_cases):\n",
        "            box = SurroundingRectangle(\n",
        "                case, buff=0.1 * case.get_width()\n",
        "            )\n",
        "            box.set_stroke(GREEN, 3)\n",
        "            case.box = box\n",
        "\n",
        "        tn_cases = VGroup(*(\n",
        "            case for case in non_cancer_cases if case not in fp_cases\n",
        "        ))\n",
        "\n",
        "        tp_label = OldTexText(\"$9$ True Positives\")\n",
        "        tp_label.set_color(GREEN)\n",
        "        tp_label.move_to(c_count)\n",
        "        tp_label.shift_onto_screen()\n",
        "\n",
        "        fp_label = OldTexText(\"$\\\\sim 900$ False Positives\")\n",
        "        fp_label.set_color(GREEN_D)\n",
        "        fp_label.move_to(nc_count)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(c_count),\n",
        "            FadeIn(tp_label),\n",
        "            LaggedStart(*(\n",
        "                ShowCreation(case.box)\n",
        "                for case in tp_cases\n",
        "            )),\n",
        "            cancer_cases[9].set_opacity, 0.25\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(nc_count),\n",
        "            FadeIn(fp_label),\n",
        "            LaggedStart(*(\n",
        "                ShowCreation(case.box)\n",
        "                for case in fp_cases\n",
        "            ), lag_ratio=0.001),\n",
        "            tn_cases.set_opacity, 0.25,\n",
        "            run_time=2,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        for case in it.chain(tp_cases, fp_cases):\n",
        "            case.add(case.box)\n",
        "\n",
        "        # Organize false positives\n",
        "        center = fp_cases.get_center()\n",
        "        fp_cases.sort(lambda p: get_norm(p - center))\n",
        "        fp_cases.generate_target()\n",
        "        fp_cases.target.arrange_in_grid(\n",
        "            buff=fp_cases[0].get_width() / 4,\n",
        "        )\n",
        "        fp_cases.target.set_height(6)\n",
        "        fp_cases.target.to_corner(DR)\n",
        "        new_center = fp_cases.target.get_center()\n",
        "        fp_cases.target.sort(lambda p: get_norm(p - new_center))\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(fp_cases, run_time=4),\n",
        "            FadeOut(tn_cases, run_time=1),\n",
        "            FadeOut(cancer_cases[9]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Final fraction\n",
        "        final_frac = OldTex(\n",
        "            \"{{9} \\\\over {9} + {900}} \\\\approx 0.01\",\n",
        "            tex_to_color_map={\n",
        "                \"{9}\": GREEN,\n",
        "                \"{900}\": GREEN_D,\n",
        "            }\n",
        "        )\n",
        "        final_frac.scale(1.5)\n",
        "        final_frac.next_to(tp_cases, DOWN, LARGE_BUFF)\n",
        "        final_frac.to_edge(LEFT, LARGE_BUFF)\n",
        "\n",
        "        self.play(FadeIn(final_frac, lag_ratio=0.2))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class AltShowUpdatingPrior(Scene):\n",
        "    def construct(self):\n",
        "        N = 100\n",
        "        post_denom = 11\n",
        "        N_str = \"{:,}\".format(N)\n",
        "\n",
        "        # Show prior\n",
        "        woman = WomanIcon()\n",
        "        population = VGroup(*[woman.copy() for x in range(N)])\n",
        "        population.arrange_in_grid()\n",
        "        population.set_fill(GREY)\n",
        "        population[0].set_fill(YELLOW)\n",
        "        population.set_height(5)\n",
        "\n",
        "        prior_prob = OldTexText(\"1\", \" in \", N_str)\n",
        "        prior_prob.set_color_by_tex(\"1\", YELLOW)\n",
        "        prior_prob.set_color_by_tex(N_str, GREY_B)\n",
        "        prior_prob.next_to(population, UP, MED_LARGE_BUFF)\n",
        "        prior_brace = Brace(prior_prob, UP, buff=SMALL_BUFF)\n",
        "        prior_words = prior_brace.get_text(\"Prior\")\n",
        "        prior_words.add_updater(lambda m: m.next_to(prior_brace, UP, SMALL_BUFF))\n",
        "\n",
        "        thousand_part = prior_prob.get_part_by_tex(N_str)\n",
        "        pop_count = Integer(N, edge_to_fix=UL)\n",
        "        pop_count.replace(thousand_part)\n",
        "        pop_count.match_color(thousand_part)\n",
        "        pop_count.set_value(0)\n",
        "        prior_prob.replace_submobject(2, pop_count)\n",
        "\n",
        "        VGroup(population, prior_prob, prior_brace, prior_words).to_corner(UL)\n",
        "\n",
        "        self.add(prior_prob)\n",
        "\n",
        "        # Before word\n",
        "        before_words = OldTexText(\n",
        "            \"Probability of having the disease\\\\\\\\ \",\n",
        "            \"\\\\emph{before} taking a test\"\n",
        "        )\n",
        "        before_words.set_color(BLUE_B)\n",
        "        before_words.next_to(prior_words, RIGHT, buff=3, aligned_edge=UP)\n",
        "        before_arrow1 = Arrow(before_words[0][0].get_left(), prior_prob.get_right() + MED_SMALL_BUFF * RIGHT)\n",
        "        before_arrow2 = Arrow(before_words[0][0].get_left(), prior_words.get_right())\n",
        "        before_arrow1.match_color(before_words)\n",
        "        before_arrow2.match_color(before_words)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(before_words, lag_ratio=0.1),\n",
        "            GrowArrow(before_arrow1),\n",
        "            ShowIncreasingSubsets(population, run_time=2),\n",
        "            ChangeDecimalToValue(pop_count, len(population), run_time=2),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            GrowFromCenter(prior_brace),\n",
        "            FadeIn(prior_words, shift=0.5 * UP),\n",
        "            ReplacementTransform(before_arrow1, before_arrow2)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Update arrow\n",
        "        update_arrow = Arrow(2 * LEFT, 2 * RIGHT)\n",
        "        update_arrow.set_thickness(0.1)\n",
        "        update_arrow.center()\n",
        "        update_arrow.match_y(pop_count)\n",
        "        update_words = OldTexText(\"See positive test\", tex_to_color_map={\"positive\": GREEN})\n",
        "        update_words.next_to(update_arrow, UP, SMALL_BUFF)\n",
        "        low_update_words = OldTexText(\"Update probability\", font_size=36)\n",
        "        low_update_words.next_to(update_arrow, DOWN, MED_SMALL_BUFF)\n",
        "\n",
        "        # Posterior\n",
        "        post_pop = population[:post_denom].copy()\n",
        "        post_pop.arrange_in_grid(\n",
        "            buff=get_norm(population[1].get_left() - population[0].get_right())\n",
        "        )\n",
        "        post_pop.match_height(population)\n",
        "        post_pop.next_to(\n",
        "            update_arrow, RIGHT,\n",
        "            buff=abs(population.get_right()[0] - update_arrow.get_left()[0])\n",
        "        )\n",
        "        post_pop.align_to(population, UP)\n",
        "\n",
        "        def give_pop_plusses(pop):\n",
        "            for icon in pop:\n",
        "                plus = OldTex(\"+\")\n",
        "                plus.set_color(GREEN)\n",
        "                plus.set_width(icon.get_width() / 2)\n",
        "                plus.move_to(icon.get_corner(UR))\n",
        "                icon.add(plus)\n",
        "\n",
        "        give_pop_plusses(post_pop)\n",
        "\n",
        "        post_prob = prior_prob.copy()\n",
        "        post_prob[2].set_value(post_denom)\n",
        "        post_prob.next_to(post_pop, UP, buff=MED_LARGE_BUFF)\n",
        "\n",
        "        roughly = OldTexText(\"(roughly)\", font_size=24)\n",
        "        roughly.next_to(post_prob, RIGHT, buff=0.2)\n",
        "\n",
        "        post_prob[2].set_value(0)\n",
        "        self.play(\n",
        "            FadeIn(update_words, lag_ratio=0.2),\n",
        "            FadeOut(before_words),\n",
        "            ReplacementTransform(before_arrow2, update_arrow, path_arc=30 * DEGREES),\n",
        "            FadeIn(low_update_words, lag_ratio=0.2),\n",
        "        )\n",
        "        self.add(post_prob)\n",
        "        self.play(\n",
        "            ShowIncreasingSubsets(post_pop, run_time=1),\n",
        "            ChangeDecimalToValue(post_prob[2], post_denom, run_time=1),\n",
        "            FadeIn(roughly),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        post_brace = Brace(post_prob, UP, buff=SMALL_BUFF)\n",
        "        post_words = post_brace.get_text(\"Posterior\")\n",
        "        post_words.add_updater(lambda m: m.next_to(post_brace, UP, SMALL_BUFF))\n",
        "        post_words.update(0)\n",
        "\n",
        "        self.play(\n",
        "            GrowFromCenter(post_brace),\n",
        "            FadeIn(post_words, shift=0.5 * UP)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        post_group = VGroup(\n",
        "            update_arrow, update_words,\n",
        "            post_pop, post_prob, post_brace, post_words,\n",
        "        )\n",
        "        post_group.save_state()\n",
        "\n",
        "        return\n",
        "        # Change prior and posterior\n",
        "        pop100, pop11, pop10, pop2 = pops = [\n",
        "            VGroup(*[woman.copy() for x in range(n)])\n",
        "            for n in [100, 11, 10, 2]\n",
        "        ]\n",
        "        for pop in pops:\n",
        "            pop.arrange_in_grid()\n",
        "            pop.set_fill(GREY)\n",
        "            pop[0].set_fill(YELLOW)\n",
        "            pop.scale(\n",
        "                post_pop[0].get_height() / pop[0].get_height()\n",
        "            )\n",
        "\n",
        "        pop100.replace(population)\n",
        "        pop11.move_to(post_pop, UP)\n",
        "        pop11.shift(0.2 * LEFT)\n",
        "        pop10.move_to(population, UP)\n",
        "        pop10.shift(0.4 * LEFT)\n",
        "        pop2.move_to(post_pop, UP)\n",
        "        pop2.shift(0.3 * LEFT)\n",
        "\n",
        "        give_pop_plusses(pop11)\n",
        "        give_pop_plusses(pop2)\n",
        "\n",
        "        def replace_population_anims(old_pop, new_pop, count, brace):\n",
        "            count.set_value(len(new_pop))\n",
        "            brace.generate_target()\n",
        "            brace.target.match_width(\n",
        "                Line(brace.get_left(), count.get_right()),\n",
        "                about_edge=LEFT,\n",
        "                stretch=True,\n",
        "            )\n",
        "            count.set_value(len(old_pop))\n",
        "\n",
        "            return [\n",
        "                FadeOut(old_pop, lag_ratio=0.1),\n",
        "                ShowIncreasingSubsets(new_pop),\n",
        "                ChangeDecimalToValue(count, len(new_pop)),\n",
        "                MoveToTarget(brace)\n",
        "            ]\n",
        "\n",
        "        self.play(\n",
        "            *replace_population_anims(population, pop100, prior_prob[2], prior_brace)\n",
        "        )\n",
        "        self.play(\n",
        "            *replace_population_anims(post_pop, pop11, post_prob[2], post_brace),\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            *replace_population_anims(pop100, pop10, prior_prob[2], prior_brace),\n",
        "            prior_words.shift, 0.1 * LEFT\n",
        "        )\n",
        "        self.play(\n",
        "            *replace_population_anims(pop11, pop2, post_prob[2], post_brace)\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "\n",
        "class NewContrastThreeContexts(Scene):\n",
        "    def construct(self):\n",
        "        # Background\n",
        "        bg_rect = FullScreenFadeRectangle()\n",
        "        bg_rect.set_fill(GREY_E, 1)\n",
        "        self.add(bg_rect)\n",
        "\n",
        "        # Scene templates\n",
        "        screens = VGroup(*(\n",
        "            ScreenRectangle() for x in range(3)\n",
        "        ))\n",
        "        screens.set_stroke(WHITE, 2)\n",
        "        screens.set_fill(BLACK, 1)\n",
        "        screens.arrange(DOWN, buff=LARGE_BUFF)\n",
        "        screens.set_height(FRAME_HEIGHT - 1)\n",
        "        screens.next_to(ORIGIN, RIGHT)\n",
        "\n",
        "        self.add(screens)\n",
        "\n",
        "        # Prevalence values\n",
        "        dots_template = VGroup(*(Dot() for x in range(1000)))\n",
        "        dots_template.arrange_in_grid(20, 50, buff=SMALL_BUFF)\n",
        "        dots_template.set_fill(GREY_B)\n",
        "        dot_groups = VGroup()\n",
        "        for screen, n in zip(screens, [1, 10, 100]):\n",
        "            dots = dots_template.copy()\n",
        "            dots.match_width(screen)\n",
        "            dots.scale(0.9)\n",
        "            dots.move_to(screen, DOWN)\n",
        "            dots.shift(0.1 * UP)\n",
        "            for dot in random.sample(list(dots), n):\n",
        "                dot.set_fill(YELLOW)\n",
        "            dot_groups.add(dots)\n",
        "\n",
        "        prevalence_labels = VGroup(\n",
        "            OldTexText(\"Prevalence: \", \"0.1\\\\%\"),\n",
        "            OldTexText(\"Prevalence: \", \"1\\\\%\"),\n",
        "            OldTexText(\"Prevalence: \", \"10\\\\%\"),\n",
        "        )\n",
        "        for label, dots in zip(prevalence_labels, dot_groups):\n",
        "            label.scale(0.75)\n",
        "            label[1].set_color(YELLOW)\n",
        "            label.next_to(dots, UP, buff=0.15)\n",
        "\n",
        "        self.add(prevalence_labels)\n",
        "        self.add(dot_groups)\n",
        "\n",
        "        # Words\n",
        "        words = VGroup(\n",
        "            OldTexText(\"Same\", \" test\"),\n",
        "            OldTexText(\"Same\", \" accuracy\"),\n",
        "            OldTexText(\"Same\", \" result\"),\n",
        "        )\n",
        "        words.scale(1.5)\n",
        "        words.arrange(DOWN, aligned_edge=LEFT, buff=MED_LARGE_BUFF)\n",
        "        words.to_edge(LEFT)\n",
        "        words.set_stroke(BLACK, 3, background=True)\n",
        "\n",
        "        for word in words[:2]:\n",
        "            self.add(word)\n",
        "            self.wait()\n",
        "\n",
        "        # Show receiving results\n",
        "        def get_positive_result():\n",
        "            woman = WomanIcon()\n",
        "            clipboard = SVGMobject(\n",
        "                \"clipboard\",\n",
        "                stroke_width=0,\n",
        "                fill_color=interpolate_color(GREY_BROWN, WHITE, 0.2)\n",
        "            )\n",
        "            clipboard.set_width(1)\n",
        "            clipboard.next_to(woman, LEFT)\n",
        "            content = OldTexText(\"+\\\\\\\\\", \"Cancer\\\\\\\\detected\")\n",
        "            content[0].scale(2, about_edge=DOWN)\n",
        "            content[0].set_color(GREEN)\n",
        "            content[0].set_stroke(GREEN, 3)\n",
        "            content[0].shift(SMALL_BUFF * UP)\n",
        "            content.set_width(0.7 * clipboard.get_width())\n",
        "            content.move_to(clipboard)\n",
        "            content.shift(SMALL_BUFF * DOWN)\n",
        "            clipboard.add(content)\n",
        "            result = VGroup(woman, clipboard)\n",
        "            result.scale(0.7)\n",
        "            return result\n",
        "\n",
        "        globals()['get_positive_result'] = get_positive_result\n",
        "\n",
        "        positive_results = VGroup(*(\n",
        "            get_positive_result() for screen in screens\n",
        "        ))\n",
        "        positive_results.generate_target()\n",
        "        positive_results.set_opacity(0)\n",
        "        for screen, result in zip(screens, positive_results.target):\n",
        "            result.set_height(screen.get_height() * 0.5)\n",
        "            result.next_to(screen, RIGHT, MED_LARGE_BUFF, aligned_edge=DOWN)\n",
        "            result.shift(0.25 * UP)\n",
        "\n",
        "        self.add(words[2])\n",
        "        self.play(MoveToTarget(positive_results))\n",
        "        self.wait()\n",
        "\n",
        "        # Different results\n",
        "        probs = VGroup(*(\n",
        "            Integer(0, unit=\"\\\\%\").next_to(result, UP)\n",
        "            for result in positive_results\n",
        "        ))\n",
        "        probs.set_fill(GREEN)\n",
        "\n",
        "        result_change_anims = [\n",
        "            ChangeDecimalToValue(probs[0], 1),\n",
        "            ChangeDecimalToValue(probs[1], 9),\n",
        "            ChangeDecimalToValue(probs[2], 53),\n",
        "            UpdateFromAlphaFunc(\n",
        "                Mobject(),\n",
        "                lambda m, a, probs=probs: probs.set_opacity(a),\n",
        "                remover=True,\n",
        "            ),\n",
        "        ]\n",
        "\n",
        "        # Odds\n",
        "        prior_probs = VGroup(*(pl[1] for pl in prevalence_labels))\n",
        "        prior_odds = VGroup(\n",
        "            OldTexText(\"1:999\"),\n",
        "            OldTexText(\"1:99\"),\n",
        "            OldTexText(\"1:9\"),\n",
        "        )\n",
        "        prior_odds.set_color(YELLOW)\n",
        "        for po, pp in zip(prior_odds, prior_probs):\n",
        "            po.match_height(pp)\n",
        "            po.scale(0.8)\n",
        "            po.move_to(pp, LEFT)\n",
        "\n",
        "        post_odds = VGroup(\n",
        "            OldTexText(\"10:999\"),\n",
        "            OldTexText(\"10:99\"),\n",
        "            OldTexText(\"10:9\"),\n",
        "        )\n",
        "        for po, prob in zip(post_odds, probs):\n",
        "            po.match_color(prob)\n",
        "            po.match_height(prob)\n",
        "            po.scale(0.8)\n",
        "            po.move_to(prob, LEFT)\n",
        "\n",
        "        # Show updates\n",
        "        arrows = VGroup(*(\n",
        "            Arrow(\n",
        "                prior.get_corner(UR), post.get_corner(UL),\n",
        "                buff=0.1,\n",
        "                path_arc=-45 * DEGREES,\n",
        "            )\n",
        "            for prior, post in zip(prior_odds, post_odds)\n",
        "        ))\n",
        "        arrows.set_color(BLUE)\n",
        "\n",
        "        # What test accuracy does\n",
        "        ta_words = VGroup(\n",
        "            OldTexText(\"Test\", \" accuracy\"),\n",
        "            OldTexText(\"\\\\emph{alone} \", \"does not\"),\n",
        "            OldTexText(\"determine\", \".\"),\n",
        "            OldTexText(\"\\\\,\", \"your chances\"),\n",
        "        )\n",
        "        ta_words[2][1].set_opacity(0)\n",
        "        ta_words[1].set_color_by_tex(\"not\", RED)\n",
        "\n",
        "        up_words = VGroup(\n",
        "            OldTexText(\"Test\", \" accuracy\"),\n",
        "            OldTexText(\"determine\", \"s\"),\n",
        "            OldTexText(\"how\", \" your chances\"),\n",
        "            OldTexText(\"are\", \" \\\\emph{updated}\"),\n",
        "        )\n",
        "        up_words[3][1].set_color(BLUE)\n",
        "        up_words[3].shift(SMALL_BUFF * UP)\n",
        "        up_words[0].shift(SMALL_BUFF * DOWN)\n",
        "\n",
        "        for group in ta_words, up_words:\n",
        "            group.arrange(DOWN, buff=0.3, aligned_edge=LEFT)\n",
        "            group.scale(1.5)\n",
        "            group.to_edge(LEFT)\n",
        "            group.set_stroke(BLACK, 3, background=True)\n",
        "\n",
        "        self.play(*result_change_anims)\n",
        "        self.play(\n",
        "            FadeOut(words[0][0]),\n",
        "            FadeOut(words[1][0]),\n",
        "            FadeOut(words[2]),\n",
        "            ReplacementTransform(words[0][1], ta_words[0][0]),\n",
        "            ReplacementTransform(words[1][1], ta_words[0][1]),\n",
        "            LaggedStartMap(FadeIn, ta_words[1:]),\n",
        "        )\n",
        "        self.add(ta_words)\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(prior_probs, 0.25 * UP),\n",
        "            FadeOut(probs, 0.25 * UP),\n",
        "            FadeIn(prior_odds, 0.25 * UP),\n",
        "            FadeIn(post_odds, 0.25 * UP),\n",
        "        )\n",
        "\n",
        "        self.play(\n",
        "            ReplacementTransform(ta_words[0], up_words[0]),\n",
        "            ReplacementTransform(ta_words[2], up_words[1]),\n",
        "            FadeIn(up_words[2][0], scale=2),\n",
        "            ReplacementTransform(ta_words[3][1], up_words[2][1]),\n",
        "            FadeOut(ta_words[1], scale=0.5),\n",
        "        )\n",
        "        self.play(\n",
        "            Write(up_words[3]),\n",
        "            LaggedStartMap(DrawBorderThenFill, arrows),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class BayesFactor(Scene):\n",
        "    def construct(self):\n",
        "        # Test sensitivity\n",
        "        woman = WomanIcon()\n",
        "        bc_pop = VGroup(*[woman.copy() for x in range(100)])\n",
        "        bc_pop.arrange_in_grid(h_buff=1.5, v_buff=1)\n",
        "        bc_pop.set_height(4)\n",
        "        bc_pop.next_to(ORIGIN, LEFT, MED_LARGE_BUFF)\n",
        "        bc_rect = SurroundingRectangle(bc_pop, buff=0.15)\n",
        "        bc_rect.set_stroke(YELLOW, 2)\n",
        "\n",
        "        with_bc_label = OldTexText(\n",
        "            \"Patients with\\\\\\\\breast cancer\",\n",
        "            font_size=36,\n",
        "            color=bc_rect.get_color()\n",
        "        )\n",
        "        with_bc_label.next_to(bc_rect, UP)\n",
        "\n",
        "        bc_pop.generate_target()\n",
        "        bc_signs = VGroup()\n",
        "        for n, icon in enumerate(bc_pop.target):\n",
        "            if n < 90:\n",
        "                sign = OldTex(\"+\", color=GREEN)\n",
        "                icon.set_color(GREEN)\n",
        "            else:\n",
        "                sign = OldTex(\"-\", color=RED)\n",
        "                icon.set_color(RED)\n",
        "            sign.match_width(icon)\n",
        "            sign.move_to(icon.get_corner(UR), LEFT)\n",
        "            bc_signs.add(sign)\n",
        "\n",
        "        sens_brace = Brace(bc_pop[:90], LEFT, buff=MED_SMALL_BUFF)\n",
        "        sens_word = sens_brace.get_text(\"90\\\\% Sens.\")\n",
        "        sens_word.set_color(GREEN)\n",
        "        fnr_brace = Brace(bc_pop[90:], LEFT, buff=MED_SMALL_BUFF)\n",
        "        fnr_word = fnr_brace.get_text(\"10\\\\% FNR\")\n",
        "        fnr_word.set_color(RED_E)\n",
        "\n",
        "        bc_group = VGroup(\n",
        "            with_bc_label,\n",
        "            bc_rect,\n",
        "            bc_pop,\n",
        "            bc_signs,\n",
        "            sens_brace,\n",
        "            sens_word,\n",
        "            fnr_brace,\n",
        "            fnr_word,\n",
        "        )\n",
        "\n",
        "        # Specificity (too much copy paste)\n",
        "        nc_pop = bc_pop.copy()\n",
        "        nc_pop.next_to(ORIGIN, RIGHT, MED_LARGE_BUFF)\n",
        "        nc_rect = SurroundingRectangle(nc_pop, buff=0.15)\n",
        "        nc_rect.set_stroke(GREY_B, 2)\n",
        "\n",
        "        without_bc_label = OldTexText(\n",
        "            \"Patients without\\\\\\\\breast cancer\",\n",
        "            font_size=36,\n",
        "            color=nc_rect.get_color()\n",
        "        )\n",
        "        without_bc_label.next_to(nc_rect, UP)\n",
        "\n",
        "        nc_pop.generate_target()\n",
        "        nc_signs = VGroup()\n",
        "        for n, icon in enumerate(nc_pop.target):\n",
        "            if 0 < n < 10:\n",
        "                sign = OldTex(\"+\", color=GREEN)\n",
        "                icon.set_color(GREEN)\n",
        "            else:\n",
        "                sign = OldTex(\"-\", color=RED)\n",
        "                icon.set_color(RED)\n",
        "            sign.match_width(icon)\n",
        "            sign.move_to(icon.get_corner(UR), LEFT)\n",
        "            nc_signs.add(sign)\n",
        "\n",
        "        spec_brace = Brace(nc_pop[10:], RIGHT, buff=MED_SMALL_BUFF)\n",
        "        spec_word = spec_brace.get_text(\"91\\\\% Spec.\")\n",
        "        spec_word.set_color(RED)\n",
        "        fpr_brace = Brace(nc_pop[:10], RIGHT, buff=MED_SMALL_BUFF)\n",
        "        fpr_word = fpr_brace.get_text(\"9\\\\% FPR\")\n",
        "        fpr_word.set_color(GREEN_D)\n",
        "\n",
        "        nc_group = VGroup(\n",
        "            without_bc_label,\n",
        "            nc_rect,\n",
        "            nc_pop,\n",
        "            nc_signs,\n",
        "            spec_brace,\n",
        "            spec_word,\n",
        "            fpr_brace,\n",
        "            fpr_word,\n",
        "        )\n",
        "\n",
        "        # Draw groups\n",
        "        self.play(LaggedStart(\n",
        "            FadeIn(with_bc_label),\n",
        "            ShowCreation(bc_rect),\n",
        "            ShowIncreasingSubsets(bc_pop),\n",
        "            FadeIn(without_bc_label),\n",
        "            ShowCreation(nc_rect),\n",
        "            ShowIncreasingSubsets(nc_pop),\n",
        "        ))\n",
        "        self.play(LaggedStart(\n",
        "            MoveToTarget(bc_pop),\n",
        "            FadeIn(bc_signs, lag_ratio=0.02),\n",
        "            GrowFromCenter(sens_brace),\n",
        "            FadeIn(sens_word, shift=0.2 * LEFT),\n",
        "            GrowFromCenter(fnr_brace),\n",
        "            FadeIn(fnr_word, shift=0.2 * LEFT),\n",
        "        ))\n",
        "        self.play(LaggedStart(\n",
        "            MoveToTarget(nc_pop),\n",
        "            FadeIn(nc_signs, lag_ratio=0.02),\n",
        "            GrowFromCenter(spec_brace),\n",
        "            FadeIn(spec_word, shift=0.2 * RIGHT),\n",
        "            GrowFromCenter(fpr_brace),\n",
        "            FadeIn(fpr_word, shift=0.2 * RIGHT),\n",
        "        ))\n",
        "        self.wait()\n",
        "\n",
        "        groups = VGroup(bc_group, nc_group)\n",
        "\n",
        "        # Highlight relevant parts\n",
        "        fade_rects = VGroup(*(BackgroundRectangle(group) for group in groups))\n",
        "        fade_rects.set_fill(BLACK, 0.8)\n",
        "\n",
        "        self.play(FadeIn(fade_rects[1]))\n",
        "        self.play(LaggedStart(*(\n",
        "            ShowCreationThenFadeOut(Underline(word))\n",
        "            for word in [sens_word, fnr_word]\n",
        "        ), lag_ratio=0.4))\n",
        "        self.play(\n",
        "            FadeIn(fade_rects[0]),\n",
        "            FadeOut(fade_rects[1]),\n",
        "        )\n",
        "        self.play(LaggedStart(*(\n",
        "            ShowCreationThenFadeOut(Underline(word))\n",
        "            for word in [spec_word, fpr_word]\n",
        "        ), lag_ratio=0.4))\n",
        "        self.wait()\n",
        "        self.play(FadeOut(fade_rects[0]))\n",
        "\n",
        "        # None of these are your answer\n",
        "        title = OldTex(\n",
        "            \"\\\\text{None of these tell you }\",\n",
        "            \"P(\\\\text{Cancer} \\\\,|\\\\, +)\",\n",
        "            tex_to_color_map={\n",
        "                \"\\\\text{Cancer}\": YELLOW,\n",
        "                \"+\": GREEN,\n",
        "            },\n",
        "            font_size=72,\n",
        "        )\n",
        "        title.to_edge(UP)\n",
        "        title_underline = Underline(title)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(title, lag_ratio=0.1),\n",
        "            groups.to_edge, DOWN,\n",
        "        )\n",
        "        self.play(ShowCreation(title_underline))\n",
        "        self.wait()\n",
        "        title.add(title_underline)\n",
        "\n",
        "        # Ask about update strength\n",
        "        question = OldTexText(\"How strongly\\\\\\\\does it update?\")\n",
        "        question.set_height(1)\n",
        "        question.to_corner(UL)\n",
        "        question.save_state()\n",
        "        question.replace(title, 1)\n",
        "        question.set_opacity(0)\n",
        "\n",
        "        self.play(\n",
        "            Restore(question),\n",
        "            title.replace, question.saved_state, 0,\n",
        "            title.set_opacity, 0,\n",
        "        )\n",
        "        self.remove(title)\n",
        "        self.wait()\n",
        "\n",
        "        # Write Bayes factor\n",
        "        frac = VGroup(\n",
        "            sens_word.copy(),\n",
        "            OldTex(\"\\\\qquad \\\\over \\\\qquad\"),\n",
        "            fpr_word.copy(),\n",
        "        )\n",
        "        frac[1].match_width(frac[0], stretch=True)\n",
        "        frac.arrange(DOWN, SMALL_BUFF)\n",
        "        frac.next_to(question, RIGHT, LARGE_BUFF)\n",
        "\n",
        "        mid_rhs = OldTex(\n",
        "            \"= {P(+ \\\\,|\\\\, \\\\text{Cancer}) \\\\over P(+ \\\\,|\\\\, \\\\text{No cancer})}\",\n",
        "            tex_to_color_map={\n",
        "                \"+\": GREEN,\n",
        "                \"\\\\text{Cancer}\": YELLOW,\n",
        "                \"\\\\text{No cancer}\": GREY_B,\n",
        "            }\n",
        "        )\n",
        "        mid_rhs.next_to(frac, RIGHT)\n",
        "\n",
        "        rhs = OldTex(\"= 10\", font_size=72)\n",
        "        rhs.next_to(mid_rhs, RIGHT)\n",
        "\n",
        "        for part in frac[0::2]:\n",
        "            part.save_state()\n",
        "        frac[0].replace(sens_word)\n",
        "        frac[2].replace(fpr_word)\n",
        "\n",
        "        s_rect = SurroundingRectangle(frac[0])\n",
        "        self.play(ShowCreation(s_rect))\n",
        "        self.play(\n",
        "            Restore(frac[0]),\n",
        "            s_rect.move_to, frac[0].saved_state,\n",
        "            s_rect.set_opacity, 0,\n",
        "            Write(frac[1]),\n",
        "            Restore(frac[2]),\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(Write(mid_rhs))\n",
        "        self.wait()\n",
        "        self.play(Write(rhs))\n",
        "        self.wait()\n",
        "\n",
        "        # Name the Bayes factor\n",
        "        bf_name = OldTexText(\"Bayes\\\\\\\\Factor \", font_size=72)\n",
        "        equals = OldTex(\"=\", font_size=72).next_to(frac, LEFT)\n",
        "        bf_name.next_to(equals, LEFT)\n",
        "        lr_name = OldTexText(\"Likelihood\\\\\\\\ratio\")\n",
        "        lr_name.next_to(equals, LEFT)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(question, UP),\n",
        "            FadeIn(bf_name, UP),\n",
        "            FadeIn(equals, UP),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(bf_name, UP),\n",
        "            FadeIn(lr_name, UP),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(bf_name, DOWN),\n",
        "            FadeOut(lr_name, DOWN),\n",
        "        )\n",
        "        self.wait(5)\n",
        "\n",
        "\n",
        "class RuleOfThumb(Scene):\n",
        "    def construct(self):\n",
        "        # Add Bayes factor\n",
        "        t2c = {\n",
        "            \"+\": GREEN,\n",
        "            \"\\\\text{Cancer}\": YELLOW,\n",
        "            \"\\\\text{No cancer}\": GREY_B,\n",
        "            \"=\": WHITE,\n",
        "            \"\\\\over\": WHITE,\n",
        "            \"{90\\\\%\": GREEN,\n",
        "            \"9\\\\%}\": GREEN,\n",
        "            \"1\\\\%}\": TEAL,\n",
        "            \"{10}\": GREEN,\n",
        "        }\n",
        "        frac_part = OldTex(\n",
        "            \"\"\"\n",
        "            {P(+ \\\\, | \\\\, \\\\text{Cancer}) \\\\over\n",
        "            P(+ \\\\, | \\\\, \\\\text{No cancer})}\n",
        "            \"\"\",\n",
        "            tex_to_color_map=t2c\n",
        "        )\n",
        "        frac_part.add(SurroundingRectangle(\n",
        "            frac_part, buff=0.1, stroke_width=1, stroke_color=GREY_B\n",
        "        ))\n",
        "        ex_part = OldTex(\n",
        "            \"\\\\text{e.g. } {90\\\\% \\\\over 9\\\\%} = {10}\",\n",
        "            tex_to_color_map=t2c\n",
        "        )\n",
        "        ex_part.next_to(frac_part, RIGHT, LARGE_BUFF)\n",
        "\n",
        "        brace = Brace(frac_part, UP, buff=SMALL_BUFF)\n",
        "        bf_label = brace.get_text(\"Bayes factor\")\n",
        "        bf_label.set_color(GREEN)\n",
        "\n",
        "        bf_group = VGroup(frac_part, ex_part, brace, bf_label)\n",
        "        bf_group.to_corner(DL)\n",
        "\n",
        "        self.add(bf_group)\n",
        "\n",
        "        # Lightbulb\n",
        "        bulb = Lightbulb()\n",
        "        condition = OldTexText(\"If Prior $\\\\ll$ 1 \\\\dots\", tex_to_color_map={\"Prior\": YELLOW})\n",
        "        condition.next_to(bulb, RIGHT, buff=MED_LARGE_BUFF, aligned_edge=DOWN)\n",
        "        bulb_group = VGroup(bulb, condition)\n",
        "        bulb_group.center().to_edge(UP)\n",
        "\n",
        "        self.play(DrawBorderThenFill(bulb, run_time=1))\n",
        "        self.play(FadeIn(condition, lag_ratio=0.1))\n",
        "        self.wait()\n",
        "\n",
        "        # Equation\n",
        "        equation = OldTexText(\n",
        "            \"Posterior\", \" $\\\\approx$ \",\n",
        "            \"(\", \"Prior\", \")\", \"(\", \"Bayes factor\", \")\",\n",
        "            tex_to_color_map={\n",
        "                \"Prior\": YELLOW,\n",
        "                \"Bayes factor\": GREEN,\n",
        "            }\n",
        "        )\n",
        "        equation.next_to(bulb_group, DOWN, LARGE_BUFF)\n",
        "\n",
        "        self.play(Write(equation[:2]), run_time=1)\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(equation.get_parts_by_tex(\"(\")),\n",
        "            FadeIn(equation.get_parts_by_tex(\")\")),\n",
        "            TransformFromCopy(\n",
        "                condition.get_part_by_tex(\"Prior\"),\n",
        "                equation.get_part_by_tex(\"Prior\")\n",
        "            ),\n",
        "            TransformFromCopy(\n",
        "                bf_label[0],\n",
        "                equation.get_part_by_tex(\"Bayes factor\"),\n",
        "            ),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # 1% example\n",
        "        ex_rhs = OldTex(\n",
        "            \"\\\\left({1 \\\\over 100}\\\\right)({10}) = {1 \\\\over 10}\",\n",
        "            tex_to_color_map={\n",
        "                \"1 \\\\over 100\": YELLOW,\n",
        "                \"{10}\": GREEN,\n",
        "            }\n",
        "        )\n",
        "        ex_rhs.next_to(equation, DOWN, MED_LARGE_BUFF)\n",
        "        ex_rhs.shift(RIGHT)\n",
        "\n",
        "        ex_lhs = OldTex(\"{1 \\\\over 11} \\\\approx\")\n",
        "        ex_lhs.next_to(ex_rhs, LEFT)\n",
        "\n",
        "        self.play(FadeIn(ex_rhs, DOWN))\n",
        "        self.wait()\n",
        "        self.play(Write(ex_lhs))\n",
        "        self.wait()\n",
        "\n",
        "        # 10% example\n",
        "        randy = Randolph(height=2)\n",
        "        randy.next_to(bf_label, UP, SMALL_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(ex_lhs), FadeOut(ex_rhs),\n",
        "            VFadeIn(randy),\n",
        "            randy.change, \"hesitant\",\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        ex2_rhs = OldTex(\n",
        "            \"(10\\\\%)({10}) = 100\\\\%\",\n",
        "            tex_to_color_map={\n",
        "                \"10\\\\%\": YELLOW,\n",
        "                \"{10}\": GREEN,\n",
        "                \"=\": WHITE,\n",
        "            }\n",
        "        )\n",
        "        ex2_rhs.move_to(ex_rhs, LEFT)\n",
        "        ex2_rhs.shift(0.15 * RIGHT)\n",
        "\n",
        "        eq_index = ex2_rhs.index_of_part_by_tex(\"=\")\n",
        "        self.play(\n",
        "            Write(ex2_rhs[:eq_index]),\n",
        "            randy.change, \"confused\",\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.play(Write(ex2_rhs[eq_index:]))\n",
        "        self.wait()\n",
        "        self.play(Blink(randy))\n",
        "\n",
        "        ex2_lhs = OldTex(\"53\\\\%\", \"\\\\approx\")\n",
        "        ex2_lhs.next_to(ex2_rhs, LEFT)\n",
        "        ex2_lhs.align_to(equation.get_part_by_tex(\"\\\\approx\"), RIGHT)\n",
        "        approx_part = ex2_lhs.get_part_by_tex(\"\\\\approx\")\n",
        "        approx_part.scale(1.2, about_edge=DL)\n",
        "        strike = Line(DL, UR).replace(approx_part, stretch=True)\n",
        "        strike.set_stroke(RED, 6)\n",
        "        strike.stretch(0.7, 0)\n",
        "        strike.stretch(1.5, 1)\n",
        "\n",
        "        self.play(\n",
        "            Write(ex2_lhs, run_time=1),\n",
        "            randy.look_at, ex2_lhs,\n",
        "        )\n",
        "        self.play(\n",
        "            randy.change, \"sad\", ex2_lhs,\n",
        "            ShowCreation(strike, run_time=0.3)\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            randy.change, \"tired\", ex2_lhs,\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        ex2 = VGroup(ex2_lhs, strike, ex2_rhs)\n",
        "\n",
        "        # This statement is actually true\n",
        "        morty = Mortimer()\n",
        "        morty.replace(randy, dim_to_match=1)\n",
        "        morty.to_edge(RIGHT, buff=1.5)\n",
        "\n",
        "        self.play(\n",
        "            VFadeIn(morty),\n",
        "            morty.change, \"tease\", equation,\n",
        "            FadeOut(ex2, UP),\n",
        "            FadeOut(VGroup(bulb, condition), UP),\n",
        "            equation.match_y, randy,\n",
        "            randy.change, \"erm\",\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "\n",
        "        eq = OldTex(\"=\")\n",
        "        approx = equation.get_part_by_tex(\"\\\\approx\")\n",
        "        eq.replace(approx)\n",
        "\n",
        "        self.play(\n",
        "            PiCreatureSays(\n",
        "                morty, \"This equation\\\\\\\\is precisely true!\",\n",
        "                bubble_config={\"height\": 2, \"width\": 3},\n",
        "                look_at=randy.eyes,\n",
        "            ),\n",
        "            GrowFromPoint(eq, morty.get_corner(UL)),\n",
        "            FadeOut(approx, 0.25 * DL),\n",
        "            randy.change, \"confused\", morty.eyes,\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.play(Blink(morty))\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class ProbabilityVsOdds(Scene):\n",
        "    def construct(self):\n",
        "        # Show titles and division\n",
        "        titles = VGroup(\n",
        "            OldTexText(\"Probability\"),\n",
        "            OldTexText(\"Odds\"),\n",
        "        )\n",
        "        for title, u in zip(titles, [-1, 1]):\n",
        "            title.scale(1.5)\n",
        "            title.to_edge(UP)\n",
        "            title.set_x(FRAME_WIDTH * u / 4)\n",
        "\n",
        "        h_line = Line(LEFT, RIGHT)\n",
        "        h_line.set_width(FRAME_WIDTH)\n",
        "        h_line.next_to(titles, DOWN, SMALL_BUFF)\n",
        "        h_line.set_x(0)\n",
        "\n",
        "        v_line = Line(UP, DOWN)\n",
        "        v_line.set_height(FRAME_HEIGHT)\n",
        "        v_line.center()\n",
        "\n",
        "        VGroup(h_line, v_line).set_stroke(GREY, 2)\n",
        "\n",
        "        titles.save_state()\n",
        "        for title in titles:\n",
        "            title.set_x(0)\n",
        "        titles[1].set_opacity(0)\n",
        "\n",
        "        self.add(titles)\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Restore(titles),\n",
        "            ShowCreation(v_line),\n",
        "        )\n",
        "        self.play(ShowCreation(h_line))\n",
        "        self.wait()\n",
        "\n",
        "        # Function definitions\n",
        "        def get_people_row(n_all, n_pos=1):\n",
        "            icon = SVGMobject(\"person\")\n",
        "            icon.set_fill(GREY)\n",
        "            icon.set_stroke(WHITE, 1)\n",
        "            icon.set_height(1)\n",
        "\n",
        "            people = VGroup(*(icon.copy() for x in range(n_all)))\n",
        "            people.arrange(RIGHT, buff=SMALL_BUFF)\n",
        "            people[:n_pos].set_fill(YELLOW)\n",
        "            return people\n",
        "\n",
        "        def get_prob_counts(people, n_pos, n_all):\n",
        "            pos_brace = Brace(people[:n_pos], UP, buff=SMALL_BUFF)\n",
        "            all_brace = Brace(people, DOWN, buff=SMALL_BUFF)\n",
        "\n",
        "            pos_label = Integer(n_pos, color=YELLOW)\n",
        "            all_label = Integer(n_all)\n",
        "\n",
        "            pos_label.next_to(pos_brace, UP)\n",
        "            all_label.next_to(all_brace, DOWN)\n",
        "\n",
        "            return VGroup(\n",
        "                VGroup(pos_brace, pos_label),\n",
        "                VGroup(all_brace, all_label),\n",
        "            )\n",
        "\n",
        "        def get_odds_counts(people, n_pos, n_neg):\n",
        "            pos_brace = Brace(people[:n_pos], UP, buff=SMALL_BUFF)\n",
        "            neg_brace = Brace(people[n_pos:], UP, buff=SMALL_BUFF)\n",
        "\n",
        "            pos_label = Integer(n_pos, color=YELLOW)\n",
        "            neg_label = Integer(n_neg, color=GREY_B)\n",
        "\n",
        "            pos_label.next_to(pos_brace, UP)\n",
        "            neg_label.next_to(neg_brace, UP)\n",
        "\n",
        "            return VGroup(\n",
        "                VGroup(pos_brace, pos_label),\n",
        "                VGroup(neg_brace, neg_label),\n",
        "            )\n",
        "\n",
        "        def get_prob_label(n_pos, n_all):\n",
        "            result = VGroup(\n",
        "                Integer(n_pos, color=YELLOW),\n",
        "                OldTex(\"/\"),\n",
        "                Integer(n_all),\n",
        "            )\n",
        "            result.scale(1.5)\n",
        "            result.arrange(RIGHT, buff=0.1)\n",
        "            return result\n",
        "\n",
        "        def get_odds_label(n_pos, n_neg):\n",
        "            result = VGroup(\n",
        "                Integer(n_pos, color=YELLOW),\n",
        "                OldTex(\":\"),\n",
        "                Integer(n_neg, color=GREY_B),\n",
        "            )\n",
        "            result.scale(1.5)\n",
        "            result.arrange(RIGHT, buff=0.2)\n",
        "            return result\n",
        "\n",
        "        # Show probability\n",
        "        people = get_people_row(5)\n",
        "        people.match_x(titles[0])\n",
        "        people.shift(DOWN)\n",
        "        prob_counts = get_prob_counts(people, 1, 5)\n",
        "\n",
        "        prob = get_prob_label(1, 5)\n",
        "        prob.next_to(people, UP, MED_LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(people, lag_ratio=0.3),\n",
        "            Write(prob)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            prob.shift, 1.5 * UP,\n",
        "            TransformFromCopy(prob[0], prob_counts[0][1]),\n",
        "            GrowFromCenter(prob_counts[0][0]),\n",
        "        )\n",
        "        self.play(\n",
        "            TransformFromCopy(prob[2], prob_counts[1][1]),\n",
        "            GrowFromCenter(prob_counts[1][0]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Transition to odds\n",
        "        right_people = people.copy()\n",
        "        right_people.match_x(titles[1])\n",
        "\n",
        "        odds = get_odds_label(1, 4)\n",
        "        odds.match_x(right_people)\n",
        "        odds.match_y(prob)\n",
        "\n",
        "        arrow = Arrow(prob.get_right(), odds.get_left(), buff=1)\n",
        "        arrow.set_thickness(0.1)\n",
        "\n",
        "        odds_count = get_odds_counts(right_people, 1, 4)\n",
        "\n",
        "        self.play(\n",
        "            TransformFromCopy(people, right_people),\n",
        "            TransformFromCopy(\n",
        "                odds.copy().replace(prob).set_opacity(0),\n",
        "                odds\n",
        "            ),\n",
        "            GrowArrow(arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(odds[0], odds_count[0][1]),\n",
        "            GrowFromCenter(odds_count[0][0]),\n",
        "        )\n",
        "        self.play(\n",
        "            TransformFromCopy(odds[2], odds_count[1][1]),\n",
        "            GrowFromCenter(odds_count[1][0]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(ShowCreationThenFadeAround(odds[1]))\n",
        "        self.wait()\n",
        "\n",
        "        # Other examples\n",
        "        people.add(prob_counts)\n",
        "        right_people.add(odds_count)\n",
        "\n",
        "        def get_example(n_pos, n_all):\n",
        "            new_prob = OldTex(\n",
        "                f\"{int(100 * n_pos / n_all)}\\\\%\",\n",
        "                font_size=72\n",
        "            )\n",
        "            new_odds = get_odds_label(n_pos, n_all - n_pos)\n",
        "            new_odds.next_to(new_prob, RIGHT, buff=1.5)\n",
        "            arrow = Arrow(\n",
        "                new_prob.get_right(),\n",
        "                new_odds.get_left(),\n",
        "                thickness=0.05\n",
        "            )\n",
        "            arrow.set_fill(GREY_A)\n",
        "            example = VGroup(new_prob, arrow, new_odds)\n",
        "            example.scale(0.5)\n",
        "            return example\n",
        "\n",
        "        def generate_example_movement(prob, arrow, odds, example):\n",
        "            mover = VGroup(prob, arrow.copy(), odds)\n",
        "            return ReplacementTransform(mover, example)\n",
        "\n",
        "        def transition_to_new_example(n_pos, n_all, example,\n",
        "                                      scene=self,\n",
        "                                      people=people,\n",
        "                                      right_people=right_people,\n",
        "                                      prob=prob,\n",
        "                                      odds=odds,\n",
        "                                      arrow=arrow\n",
        "                                      ):\n",
        "\n",
        "            new_people = get_people_row(n_all, n_pos)\n",
        "            new_people.set_x(-FRAME_WIDTH / 4)\n",
        "            new_right_people = new_people.copy()\n",
        "            new_right_people.set_x(FRAME_WIDTH / 4)\n",
        "\n",
        "            new_prob = OldTex(\n",
        "                f\"{int(100 * n_pos / n_all)}\\\\%\",\n",
        "                font_size=72\n",
        "            )\n",
        "            new_odds = get_odds_label(n_pos, n_all - n_pos)\n",
        "            new_prob.move_to(prob)\n",
        "            new_odds.move_to(odds)\n",
        "\n",
        "            scene.play(\n",
        "                generate_example_movement(prob, arrow, odds, example),\n",
        "                FadeOut(people),\n",
        "                FadeOut(right_people),\n",
        "                FadeIn(new_prob),\n",
        "                FadeIn(new_odds),\n",
        "                FadeIn(new_people),\n",
        "                FadeIn(new_right_people),\n",
        "            )\n",
        "            return {\n",
        "                \"people\": new_people,\n",
        "                \"right_people\": new_right_people,\n",
        "                \"prob\": new_prob,\n",
        "                \"odds\": new_odds,\n",
        "            }\n",
        "\n",
        "        examples = VGroup(*(\n",
        "            get_example(n, k)\n",
        "            for n, k in [(1, 10), (1, 5), (1, 2), (4, 5), (9, 10)]\n",
        "        ))\n",
        "        examples.arrange(UP)\n",
        "        examples.to_edge(DOWN)\n",
        "\n",
        "        kw = {}\n",
        "        for n, k, ei in (1, 2, 1), (1, 10, 2), (4, 5, 0), (9, 10, 3):\n",
        "            kw = transition_to_new_example(\n",
        "                n, k, examples[ei], **kw\n",
        "            )\n",
        "            self.wait(2)\n",
        "\n",
        "        self.remove(arrow)\n",
        "        self.play(\n",
        "            generate_example_movement(\n",
        "                kw[\"prob\"], arrow, kw[\"odds\"], examples[4],\n",
        "            ),\n",
        "            FadeOut(kw[\"people\"]),\n",
        "            FadeOut(kw[\"right_people\"]),\n",
        "        )\n",
        "\n",
        "        # Show ranges\n",
        "        left_range = UnitInterval((0, 1, 0.1), width=5)\n",
        "        left_range.set_y(1.5)\n",
        "        left_range.match_x(titles[0])\n",
        "\n",
        "        right_range = NumberLine((0, 5), width=5, include_tip=True)\n",
        "        right_range.match_y(left_range)\n",
        "        right_range.match_x(titles[1])\n",
        "        dots = OldTex(\"\\\\dots\")\n",
        "        dots.next_to(right_range, RIGHT)\n",
        "        right_range.add(dots)\n",
        "        right_range.add(*(\n",
        "            right_range.get_tick(\n",
        "                1 / n,\n",
        "                right_range.tick_size * (1 / n)**0.5,\n",
        "            ).set_opacity((1 / n)**0.5)\n",
        "            for n in range(2, 100)\n",
        "        ))\n",
        "\n",
        "        left_range.add_numbers([0, 0.2, 0.5, 0.8, 1])\n",
        "        right_range.add_numbers()\n",
        "\n",
        "        left_ticker = ArrowTip(angle=-90 * DEGREES)\n",
        "        left_ticker.set_fill(BLUE)\n",
        "        left_ticker.move_to(left_range.n2p(0.5), DOWN)\n",
        "        right_ticker = left_ticker.copy()\n",
        "        right_ticker.set_color(RED)\n",
        "        right_ticker.move_to(right_range.n2p(1), DOWN)\n",
        "\n",
        "        self.play(\n",
        "            Write(left_range),\n",
        "            Write(right_range),\n",
        "            run_time=1\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(left_ticker, shift=DOWN),\n",
        "            FadeIn(right_ticker, shift=DOWN),\n",
        "        )\n",
        "\n",
        "        rect = SurroundingRectangle(examples[0])\n",
        "        rect.set_opacity(0)\n",
        "\n",
        "        prob = ValueTracker(0.5)\n",
        "        left_ticker.add_updater(\n",
        "            lambda m: m.move_to(left_range.n2p(prob.get_value()), DOWN)\n",
        "        )\n",
        "        right_ticker.add_updater(\n",
        "            lambda m: m.move_to(right_range.n2p(\n",
        "                prob.get_value() / (1 - prob.get_value())\n",
        "            ), DOWN)\n",
        "        )\n",
        "\n",
        "        for i, p in enumerate([0.1, 0.2, 0.5, 0.8, 0.9]):\n",
        "            self.play(\n",
        "                prob.set_value, p,\n",
        "                rect.become,\n",
        "                SurroundingRectangle(examples[i]),\n",
        "            )\n",
        "            self.wait()\n",
        "        self.play(\n",
        "            FadeOut(rect),\n",
        "            ApplyMethod(prob.set_value, 0.5, run_time=4),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class OddsComments(Scene):\n",
        "    def construct(self):\n",
        "        morty = Mortimer()\n",
        "        morty.to_corner(DR)\n",
        "        randy = Randolph()\n",
        "        randy.next_to(morty, LEFT, buff=2)\n",
        "\n",
        "        self.play(FadeIn(morty))\n",
        "        self.play(\n",
        "            PiCreatureSays(\n",
        "                morty,\n",
        "                \"The chances are\\\\\\\\1 to 1\",\n",
        "                run_time=1\n",
        "            ),\n",
        "            FadeIn(randy)\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.play(\n",
        "            PiCreatureSays(randy, \"The chances are\\\\\\\\2 to 1\", run_time=1),\n",
        "            RemovePiCreatureBubble(morty, target_mode=\"happy\")\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class NewSnazzyBayesRuleSteps(Scene):\n",
        "    def construct(self):\n",
        "        # Add title\n",
        "        title = OldTexText(\n",
        "            \"Bayes' rule, the snazzy way\",\n",
        "            font_size=72\n",
        "        )\n",
        "        title.to_edge(UP)\n",
        "        title.set_stroke(BLACK, 2, background=True)\n",
        "        underline = Underline(title)\n",
        "        underline.scale(1.2)\n",
        "        underline.shift(0.2 * UP)\n",
        "        underline.set_stroke(GREY, 3)\n",
        "        self.add(underline, title)\n",
        "\n",
        "        # Completely accurate\n",
        "        accurate_words = OldTexText(\n",
        "            *\"Completely accurate\\\\\\\\ Not even approximating things\".split(\" \"),\n",
        "            font_size=72,\n",
        "            arg_separator=\" \"\n",
        "        )\n",
        "        accurate_words.set_color(BLUE)\n",
        "        for word in accurate_words:\n",
        "            self.add(word)\n",
        "            self.wait(0.05 * len(word))\n",
        "\n",
        "        # Population\n",
        "        population = VGroup(*(\n",
        "            WomanIcon()\n",
        "            for x in range(100)\n",
        "        ))\n",
        "        population.arrange_in_grid(h_buff=1, v_buff=0.5, fill_rows_first=False)\n",
        "        population.set_height(5)\n",
        "        population.to_corner(DR)\n",
        "        population[0].set_color(YELLOW)\n",
        "\n",
        "        # Step labels\n",
        "        step_labels = VGroup(\n",
        "            OldTexText(\"Step 1)\"),\n",
        "            OldTexText(\"Step 2)\"),\n",
        "            OldTexText(\"Step 3)\"),\n",
        "        )\n",
        "        step_labels.arrange(DOWN, buff=1.5, aligned_edge=LEFT)\n",
        "        step_labels.next_to(title, DOWN, MED_LARGE_BUFF)\n",
        "        step_labels.to_edge(LEFT)\n",
        "\n",
        "        step1, step2, step3 = steps = VGroup(\n",
        "            OldTexText(\"Express the prior with odds\"),\n",
        "            OldTexText(\"Compute Bayes' factor\"),\n",
        "            OldTexText(\"Multiply\"),\n",
        "        )\n",
        "\n",
        "        colors = [YELLOW, GREEN, BLUE]\n",
        "        for step, label, color in zip(steps, step_labels, colors):\n",
        "            step.set_color(color)\n",
        "            step.next_to(label, RIGHT)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeIn, step_labels, shift=0.5 * RIGHT),\n",
        "            LaggedStartMap(FadeIn, steps, shift=RIGHT),\n",
        "            FadeOut(accurate_words),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Step 2 details\n",
        "        tex_to_color_map = {\n",
        "            \"+\": GREEN,\n",
        "            \"\\\\text{Cancer}\": YELLOW,\n",
        "            \"\\\\text{No cancer}\": GREY_B,\n",
        "            \"=\": WHITE,\n",
        "            \"\\\\over\": WHITE,\n",
        "            \"{90\\\\%\": GREEN,\n",
        "            \"9\\\\%}\": GREEN,\n",
        "            \"1\\\\%}\": TEAL,\n",
        "            \"10\": WHITE,\n",
        "        }\n",
        "        bf_computation = OldTex(\n",
        "            \"\"\"\n",
        "            {\n",
        "            P(+ \\\\, | \\\\, \\\\text{Cancer}) \\\\over\n",
        "            P(+ \\\\, | \\\\, \\\\text{No cancer})\n",
        "            } =\n",
        "            {90\\\\% \\\\over 9\\\\%} = 10\n",
        "            \"\"\",\n",
        "            tex_to_color_map=tex_to_color_map\n",
        "        )\n",
        "        bf_computation[-1].scale(1.2)\n",
        "        bf_computation.scale(0.6)\n",
        "        bf_computation.next_to(step2, DOWN, aligned_edge=LEFT)\n",
        "        bf_computation.save_state()\n",
        "        bf_computation.scale(1.5)\n",
        "        bf_computation.next_to(steps[1], RIGHT, LARGE_BUFF)\n",
        "\n",
        "        lr_words = OldTexText(\"``Likelihood ratio''\", font_size=30)\n",
        "        lr_words.next_to(bf_computation[-1], RIGHT, MED_LARGE_BUFF, DOWN)\n",
        "        lr_words.set_color(GREY_A)\n",
        "\n",
        "        sens_part = bf_computation.get_part_by_tex(\"90\\\\%\")\n",
        "        sens_word = OldTexText(\"Sensitivity\")\n",
        "        sens_word.next_to(sens_part, UP, buff=1)\n",
        "        sens_arrow = Arrow(sens_word.get_bottom(), sens_part.get_top(), buff=0.1)\n",
        "\n",
        "        fpr_part = bf_computation.get_part_by_tex(\"9\\\\%\")\n",
        "        fpr_word = OldTexText(\"FPR\")\n",
        "        fpr_word.next_to(fpr_part, DOWN, buff=1)\n",
        "        fpr_arrow = Arrow(fpr_word.get_top(), fpr_part.get_bottom(), buff=0.1)\n",
        "\n",
        "        self.play(FadeIn(bf_computation, lag_ratio=0.1))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Indicate(sens_part),\n",
        "            FadeIn(sens_word),\n",
        "            GrowArrow(sens_arrow)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Indicate(fpr_part),\n",
        "            FadeIn(fpr_word),\n",
        "            GrowArrow(fpr_arrow),\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            Restore(bf_computation),\n",
        "            FadeOut(VGroup(sens_word, sens_arrow, fpr_word, fpr_arrow))\n",
        "        )\n",
        "\n",
        "        # Step 1 details\n",
        "        step1_subtext = OldTexText(\"E.g.\", \" 1\\\\% \", \" $\\\\rightarrow$ \", \"1:99\")\n",
        "        step1_subtext.set_color(GREY_A)\n",
        "        step1_subtext.scale(0.9)\n",
        "        step1_subtext.next_to(step1, DOWN, aligned_edge=LEFT)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(step1_subtext[:2]),\n",
        "            ShowIncreasingSubsets(population),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(step1_subtext[1], step1_subtext[3]),\n",
        "            Write(step1_subtext[2]),\n",
        "        )\n",
        "        self.play(ShowCreationThenFadeAround(step1_subtext[3]))\n",
        "        self.wait()\n",
        "\n",
        "        # Step 3\n",
        "        multiplication = OldTex(\n",
        "            \"(\", \"1:99\", \")\", \"\\\\times\", \"10\",\n",
        "            \"=\", \"10:99\",\n",
        "            \"\\\\rightarrow\", \"{10 \\\\over 109}\",\n",
        "            \"\\\\approx\", \"{1 \\\\over 11}\",\n",
        "            font_size=36,\n",
        "        )\n",
        "        multiplication.next_to(step3, DOWN, aligned_edge=LEFT)\n",
        "\n",
        "        odds_rect = SurroundingRectangle(step1_subtext[-1], color=YELLOW)\n",
        "        bf_rect = SurroundingRectangle(bf_computation[-1], color=GREEN)\n",
        "        self.play(\n",
        "            ShowCreation(odds_rect),\n",
        "            ShowCreation(bf_rect),\n",
        "        )\n",
        "        self.play(\n",
        "            Write(VGroup(*(multiplication[i] for i in [0, 2, 3]))),\n",
        "            TransformFromCopy(step1_subtext[-1], multiplication[1]),\n",
        "            odds_rect.move_to, multiplication[1],\n",
        "            odds_rect.set_opacity, 0,\n",
        "            TransformFromCopy(bf_computation[-1], multiplication[4]),\n",
        "            bf_rect.move_to, multiplication[4],\n",
        "            bf_rect.set_opacity, 0,\n",
        "        )\n",
        "        self.remove(odds_rect, bf_rect)\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(multiplication.get_part_by_tex(\"=\")),\n",
        "            TransformFromCopy(\n",
        "                multiplication.get_part_by_tex(\"1:99\"),\n",
        "                multiplication.get_part_by_tex(\"10:99\"),\n",
        "                path_arc=30 * DEGREES,\n",
        "            ),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(multiplication.get_part_by_tex(\"\\\\rightarrow\")),\n",
        "            FadeIn(multiplication.get_part_by_tex(\"10 \\\\over 109\")),\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(multiplication.get_part_by_tex(\"\\\\approx\")),\n",
        "            FadeIn(multiplication.get_part_by_tex(\"1 \\\\over 11\")),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # 10% prior example\n",
        "        prior_odds = step1_subtext[1:]\n",
        "        alt_prior_odds = OldTex(\n",
        "            \"10\\\\%\", \"\\\\rightarrow\", \"\\\\text{1:9}\"\n",
        "        )\n",
        "        alt_prior_odds.match_height(prior_odds)\n",
        "        alt_prior_odds.move_to(prior_odds, LEFT)\n",
        "        alt_prior_odds.match_style(prior_odds)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(multiplication, shift=DOWN),\n",
        "            FadeOut(prior_odds, shift=DOWN),\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(alt_prior_odds[0], scale=2),\n",
        "        )\n",
        "        self.play(\n",
        "            population[:10].set_color, YELLOW,\n",
        "            LaggedStartMap(\n",
        "                ShowCreationThenFadeOut,\n",
        "                VGroup(*(\n",
        "                    SurroundingRectangle(person, buff=0.05)\n",
        "                    for person in population[:10]\n",
        "                ))\n",
        "            )\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Write(alt_prior_odds[1]),\n",
        "            FadeIn(alt_prior_odds[2], shift=0.5 * RIGHT)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        new_multiplication = OldTex(\n",
        "            \"(1:9)\", \"\\\\times\", \"10\",\n",
        "            \"=\", \"10:9\",\n",
        "            \"\\\\rightarrow\", \"{10 \\\\over 19}\",\n",
        "            \"\\\\approx\", \"0.53\",\n",
        "            font_size=36,\n",
        "        )\n",
        "        new_multiplication.move_to(multiplication, LEFT)\n",
        "        rects = VGroup(\n",
        "            SurroundingRectangle(alt_prior_odds.get_part_by_tex(\"1:9\"), color=YELLOW),\n",
        "            SurroundingRectangle(bf_computation.get_part_by_tex(\"10\"), color=GREEN),\n",
        "            SurroundingRectangle(new_multiplication.get_part_by_tex(\"10:9\"), color=RED),\n",
        "        )\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(rects[:2], lag_ratio=0.6, run_time=1.5)\n",
        "        )\n",
        "        self.play(\n",
        "            ReplacementTransform(rects[0], rects[2]),\n",
        "            ReplacementTransform(rects[1], rects[2]),\n",
        "            FadeIn(new_multiplication[:5]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        alt_rhs = OldTex(\"> 1:1\", font_size=36)\n",
        "        alt_rhs.next_to(new_multiplication[4], RIGHT)\n",
        "        self.play(\n",
        "            FadeOut(rects[2]),\n",
        "            Write(alt_rhs)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(alt_rhs, shift=0.5 * UP),\n",
        "            FadeIn(new_multiplication[5:7], shift=0.5 * UP),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Write(new_multiplication[7:]))\n",
        "        self.wait()\n",
        "\n",
        "        # Return to original prior\n",
        "        self.play(\n",
        "            FadeOut(new_multiplication, shift=DOWN),\n",
        "            FadeOut(alt_prior_odds, shift=DOWN),\n",
        "            FadeIn(prior_odds, shift=DOWN)\n",
        "        )\n",
        "        self.play(population[1:].set_color, GREY_B)\n",
        "        self.play(Indicate(population[0], color=RED))\n",
        "        self.play(LaggedStartMap(\n",
        "            Indicate, population[1:], color=GREY_A,\n",
        "            lag_ratio=0.01\n",
        "        ))\n",
        "        self.wait()\n",
        "\n",
        "        # Change test accuracy\n",
        "        new_bf_computation = OldTex(\n",
        "            \"\"\"\n",
        "            {\n",
        "            P(+ \\\\, | \\\\, \\\\text{Cancer}) \\\\over\n",
        "            P(+ \\\\, | \\\\, \\\\text{No cancer})\n",
        "            } =\n",
        "            {90\\\\% \\\\over 1\\\\%} = 90\n",
        "            \"\"\",\n",
        "            tex_to_color_map=tex_to_color_map\n",
        "        )\n",
        "        new_bf_computation.replace(bf_computation)\n",
        "        new_bf_computation[-2:].scale(1.5, about_edge=LEFT)\n",
        "\n",
        "        rects = VGroup(*(\n",
        "            SurroundingRectangle(bf_computation[i:j], buff=0.05)\n",
        "            for (i, j) in [(5, 8), (14, 15)]\n",
        "        ))\n",
        "        rects.set_color(RED)\n",
        "\n",
        "        self.play(ShowCreation(rects))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(bf_computation),\n",
        "            FadeIn(new_bf_computation[:-2])\n",
        "        )\n",
        "        self.play(FadeOut(rects))\n",
        "        self.wait()\n",
        "        self.play(Write(new_bf_computation[-2:]))\n",
        "        self.wait()\n",
        "\n",
        "        # New posterior (largely copy-pasted)\n",
        "        final_multiplication = OldTex(\n",
        "            \"(1:99)\", \"\\\\times\", \"90\",\n",
        "            \"=\", \"90:99\",\n",
        "            \"\\\\rightarrow\", \"{90 \\\\over 189}\",\n",
        "            \"\\\\approx\", \"0.48\",\n",
        "            font_size=36,\n",
        "        )\n",
        "        final_multiplication.move_to(multiplication, LEFT)\n",
        "        rects = VGroup(\n",
        "            SurroundingRectangle(step1_subtext.get_part_by_tex(\"1:99\"), color=YELLOW),\n",
        "            SurroundingRectangle(new_bf_computation.get_parts_by_tex(\"90\")[1], color=GREEN),\n",
        "            SurroundingRectangle(final_multiplication.get_part_by_tex(\"90:99\"), color=RED),\n",
        "        )\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(rects[:2], lag_ratio=0.6, run_time=1.5)\n",
        "        )\n",
        "        self.play(\n",
        "            ReplacementTransform(rects[0], rects[2]),\n",
        "            ReplacementTransform(rects[1], rects[2]),\n",
        "            FadeIn(final_multiplication[:5]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        alt_rhs = OldTex(\"< 1:1\", font_size=36)\n",
        "        alt_rhs.next_to(final_multiplication[4], RIGHT)\n",
        "        self.play(\n",
        "            FadeOut(rects[2]),\n",
        "            Write(alt_rhs)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(alt_rhs, shift=0.5 * UP),\n",
        "            FadeIn(final_multiplication[5:7], shift=0.5 * UP),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Write(final_multiplication[7:]))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class AskWhyItWorks(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        self.student_says(\n",
        "            \"Huh?  Why does\\\\\\\\that work?\",\n",
        "            target_mode=\"confused\",\n",
        "        )\n",
        "        self.play_student_changes(\n",
        "            \"pondering\", \"erm\", \"confused\",\n",
        "            look_at=self.screen,\n",
        "        )\n",
        "        self.play(self.teacher.change, \"happy\")\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class WhyTheBayesFactorTrickWorks(Scene):\n",
        "    def construct(self):\n",
        "        # Setup before and after\n",
        "        titles = VGroup(\n",
        "            OldTexText(\"Before test\"),\n",
        "            OldTexText(\"After test\"),\n",
        "        )\n",
        "        titles.scale(1.25)\n",
        "        for title, u in zip(titles, [-1, 1]):\n",
        "            title.set_x(u * FRAME_WIDTH / 4)\n",
        "            title.to_edge(UP, buff=MED_SMALL_BUFF)\n",
        "        h_line = Line(LEFT, RIGHT)\n",
        "        h_line.set_width(FRAME_WIDTH)\n",
        "        h_line.next_to(titles, DOWN)\n",
        "        h_line.set_x(0)\n",
        "        v_line = Line(UP, DOWN).set_height(FRAME_HEIGHT)\n",
        "        lines = VGroup(h_line, v_line)\n",
        "        lines.set_stroke(GREY, 2)\n",
        "\n",
        "        self.add(titles)\n",
        "        self.add(lines)\n",
        "\n",
        "        # Show population before\n",
        "        population = VGroup(*(WomanIcon() for x in range(100)))\n",
        "        population.arrange_in_grid(h_buff=0.7, fill_rows_first=False)\n",
        "        population.set_height(5)\n",
        "        population[:10].set_fill(YELLOW)\n",
        "        population[:10].shift(MED_SMALL_BUFF * LEFT)\n",
        "        population.match_x(titles[0])\n",
        "        population.to_edge(DOWN, buff=MED_LARGE_BUFF)\n",
        "\n",
        "        w_tex = \"(\\\\text{\\\\# With})\"\n",
        "        wo_tex = \"(\\\\text{\\\\# Without})\"\n",
        "        t2c = {\n",
        "            w_tex: YELLOW,\n",
        "            wo_tex: GREY_B,\n",
        "        }\n",
        "        odds = OldTex(w_tex, \":\", wo_tex, tex_to_color_map=t2c)\n",
        "        odds.next_to(population, UP, buff=MED_LARGE_BUFF)\n",
        "        odds.match_x(titles[0])\n",
        "\n",
        "        self.add(population)\n",
        "        self.add(odds)\n",
        "        self.play(\n",
        "            ShowCreationThenDestruction(Underline(odds[0])),\n",
        "            LaggedStartMap(\n",
        "                ShowCreationThenFadeOut,\n",
        "                VGroup(*(\n",
        "                    SurroundingRectangle(icon, stroke_width=1, buff=0.05)\n",
        "                    for icon in population[:10]\n",
        "                ))\n",
        "            ),\n",
        "        )\n",
        "        self.play(\n",
        "            ShowCreationThenDestruction(Underline(odds[2])),\n",
        "            LaggedStartMap(\n",
        "                ShowCreationThenFadeOut,\n",
        "                VGroup(*(\n",
        "                    SurroundingRectangle(icon, color=GREY, stroke_width=1, buff=0.05)\n",
        "                    for icon in population[10:]\n",
        "                )),\n",
        "                lag_ratio=0.01\n",
        "            ),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Turn odds into fraction\n",
        "        frac = OldTex(\n",
        "            w_tex, \"\\\\over\", wo_tex, tex_to_color_map=t2c,\n",
        "            font_size=36\n",
        "        )\n",
        "        frac.next_to(h_line, DOWN, MED_LARGE_BUFF)\n",
        "        frac.match_x(titles[0])\n",
        "\n",
        "        self.play(\n",
        "            ReplacementTransform(odds, frac),\n",
        "            population.set_height, 4.5,\n",
        "            population.next_to, frac, DOWN, MED_LARGE_BUFF,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show filtration\n",
        "        pop_copy = population.copy()\n",
        "        pop_copy.match_x(titles[1])\n",
        "\n",
        "        tp_cases = pop_copy[:9]\n",
        "        fn_cases = pop_copy[9:10]\n",
        "        fp_cases = pop_copy[10::10]\n",
        "        tn_cases = VGroup(*(\n",
        "            case\n",
        "            for case in pop_copy[10:]\n",
        "            if case not in fp_cases\n",
        "        ))\n",
        "\n",
        "        VGroup(fn_cases, tn_cases).set_opacity(0.1)\n",
        "        VGroup(tp_cases, tp_cases).set_stroke(GREEN, 3, background=True)\n",
        "\n",
        "        pos_boxes = VGroup()\n",
        "        for case in it.chain(tp_cases, fp_cases):\n",
        "            box = SurroundingRectangle(case, buff=0.025)\n",
        "            box.set_stroke(GREEN, 0)\n",
        "            plus = OldTex(\"+\", font_size=24)\n",
        "            plus.move_to(box.get_corner(UR))\n",
        "            plus.shift(DR * plus.get_height() / 4)\n",
        "            plus.set_color(GREEN)\n",
        "            box.add(plus)\n",
        "            pos_boxes.add(box)\n",
        "\n",
        "        self.play(\n",
        "            TransformFromCopy(population, pop_copy),\n",
        "            path_arc=30 * DEGREES\n",
        "        )\n",
        "        self.play(LaggedStartMap(DrawBorderThenFill, pos_boxes))\n",
        "        self.wait()\n",
        "\n",
        "        # Final fraction\n",
        "        t2c.update({\n",
        "            \"\\\\text{Cancer}\": YELLOW,\n",
        "            \"\\\\text{No cancer}\": GREY,\n",
        "            \"+\": GREEN,\n",
        "            \"\\\\cdot\": WHITE,\n",
        "        })\n",
        "        final_frac = OldTex(\n",
        "            w_tex, \"\\\\cdot P(+ \\\\,|\\\\, \\\\text{Cancer})\",\n",
        "            \"\\\\over\",\n",
        "            wo_tex, \"\\\\cdot P(+ \\\\,|\\\\, \\\\text{No cancer})\",\n",
        "            tex_to_color_map=t2c,\n",
        "            font_size=36,\n",
        "        )\n",
        "        final_frac.match_x(pop_copy)\n",
        "        final_frac.match_y(frac)\n",
        "\n",
        "        left_brace = Brace(tp_cases, LEFT)\n",
        "        right_brace = Brace(fp_cases, RIGHT, min_num_quads=1)\n",
        "        big_left_brace = Brace(VGroup(tp_cases, fn_cases), LEFT)\n",
        "        big_right_brace = Brace(VGroup(fp_cases, tn_cases), RIGHT)\n",
        "        big_left_brace.set_opacity(0)\n",
        "        big_right_brace.set_opacity(0)\n",
        "\n",
        "        self.play(*(\n",
        "            TransformFromCopy(\n",
        "                frac.get_part_by_tex(tex),\n",
        "                final_frac.get_part_by_tex(tex)\n",
        "            )\n",
        "            for tex in (w_tex, \"\\\\over\")\n",
        "        ))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(big_left_brace, left_brace),\n",
        "            Write(final_frac[1:7])\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(*(\n",
        "            TransformFromCopy(\n",
        "                frac.get_part_by_tex(tex),\n",
        "                final_frac.get_part_by_tex(tex)\n",
        "            )\n",
        "            for tex in (wo_tex,)\n",
        "        ))\n",
        "        self.play(\n",
        "            TransformFromCopy(big_right_brace, right_brace),\n",
        "            Write(final_frac[9:])\n",
        "        )\n",
        "        self.wait()\n",
        "        self.add(final_frac)\n",
        "\n",
        "        # Circle likelihood ratio\n",
        "        likelihood_ratio = VGroup(\n",
        "            final_frac[2:7],\n",
        "            final_frac[10:]\n",
        "        )\n",
        "        lr_rect = SurroundingRectangle(likelihood_ratio)\n",
        "        lr_rect.set_stroke(BLUE, 3)\n",
        "\n",
        "        self.play(ShowCreation(lr_rect))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ReframeWhatTestsDo(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Question\n",
        "        question = OldTexText(\"What do tests tell you?\")\n",
        "        self.teacher_holds_up(question)\n",
        "        self.wait()\n",
        "\n",
        "        question.generate_target()\n",
        "        question.target.set_height(0.6)\n",
        "        question.target.center()\n",
        "        question.target.to_edge(UP)\n",
        "        self.play(\n",
        "            MoveToTarget(question),\n",
        "            *[\n",
        "                ApplyMethod(pi.change, \"pondering\", question.target)\n",
        "                for pi in self.pi_creatures\n",
        "            ]\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        # Possible answers\n",
        "        answers = VGroup(\n",
        "            OldTexText(\"Tests\", \" determine\", \" if you have\", \" a disease.\"),\n",
        "            OldTexText(\"Tests\", \" determine\", \" your chances of having\", \" a disease.\"),\n",
        "            OldTexText(\"Tests\", \" update\", \" your chances of having\", \" a disease.\"),\n",
        "        )\n",
        "        students = self.students\n",
        "        answers.set_color(BLUE_C)\n",
        "        answers.arrange(DOWN)\n",
        "        answers.next_to(question, DOWN, MED_LARGE_BUFF)\n",
        "\n",
        "        answers[1][2].set_fill(GREY_A)\n",
        "        answers[2][2].set_fill(GREY_A)\n",
        "        answers[2][1].set_fill(YELLOW)\n",
        "\n",
        "        def add_strike_anim(words):\n",
        "            strike = Line()\n",
        "            strike.replace(words, dim_to_match=0)\n",
        "            strike.set_stroke(RED, 5)\n",
        "            anim = ShowCreation(strike)\n",
        "            words.add(strike)\n",
        "            return anim\n",
        "\n",
        "        self.play(\n",
        "            GrowFromPoint(answers[0], students[0].get_corner(UR)),\n",
        "            students[0].change, \"raise_right_hand\", answers[0],\n",
        "            students[1].change, \"sassy\", students[0].eyes,\n",
        "            students[2].change, \"sassy\", students[0].eyes,\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            add_strike_anim(answers[0]),\n",
        "            students[0].change, \"guilty\",\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        answers[1][2].save_state()\n",
        "        answers[1][2].replace(answers[0][2], stretch=True)\n",
        "        answers[1][2].set_opacity(0)\n",
        "        self.play(\n",
        "            TransformFromCopy(\n",
        "                answers[0][:2],\n",
        "                answers[1][:2],\n",
        "            ),\n",
        "            TransformFromCopy(\n",
        "                answers[0][3],\n",
        "                answers[1][3],\n",
        "            ),\n",
        "            Restore(answers[1][2]),\n",
        "            students[0].set_opacity, 0.5,\n",
        "            students[0].change, \"pondering\", answers[1],\n",
        "            students[1].change, \"raise_right_hand\", answers[1],\n",
        "            students[2].change, \"pondering\", answers[1],\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            add_strike_anim(answers[1]),\n",
        "            students[1].change, \"guilty\",\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        answers[2][1].save_state()\n",
        "        answers[2][1].replace(answers[1][1], stretch=True)\n",
        "        answers[2][1].set_opacity(0)\n",
        "        self.play(\n",
        "            *(\n",
        "                TransformFromCopy(\n",
        "                    answers[1][i],\n",
        "                    answers[2][i],\n",
        "                )\n",
        "                for i in [0, 2, 3]\n",
        "            ),\n",
        "            Restore(answers[2][1]),\n",
        "            students[0].change, \"pondering\", answers[1],\n",
        "            students[1].set_opacity, 0.5,\n",
        "            students[1].change, \"pondering\", answers[1],\n",
        "            students[2].change, \"raise_left_hand\", answers[1],\n",
        "        )\n",
        "        self.play(\n",
        "            self.teacher.change, \"happy\", students[2].eyes,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # The fundamental reframing\n",
        "        new_title = OldTexText(\n",
        "            \"The Fundamental Reframing\",\n",
        "            font_size=72,\n",
        "        )\n",
        "        new_title.add(Underline(new_title))\n",
        "        new_title.to_edge(UP)\n",
        "\n",
        "        self.play(\n",
        "            Write(new_title),\n",
        "            FadeOut(question),\n",
        "            self.students[2].change, \"hooray\", new_title,\n",
        "            answers.shift, 0.5 * DOWN,\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class PrevalenceVsPrior(Scene):\n",
        "    def construct(self):\n",
        "        # Prior and prevalence\n",
        "        eq = OldTexText(\n",
        "            \"Prevalence = Prior\",\n",
        "            tex_to_color_map={\n",
        "                \"Prevalence\": WHITE,\n",
        "                \"Prior\": YELLOW,\n",
        "            }\n",
        "        )\n",
        "        eq.shift(UP)\n",
        "        prior = eq[2]\n",
        "        prev = eq[0]\n",
        "\n",
        "        strike = Line(eq.get_left(), eq.get_right())\n",
        "        strike.set_stroke(RED, 4)\n",
        "        not_words = OldTexText(\"Not necessarily!\")\n",
        "        not_words.set_color(RED)\n",
        "        not_words.match_width(eq)\n",
        "        not_words.next_to(eq, DOWN, MED_LARGE_BUFF)\n",
        "\n",
        "        factors = VGroup(\n",
        "            OldTexText(\"Prevalence\"),\n",
        "            OldTexText(\"Symptoms\"),\n",
        "            OldTexText(\"Contacts\\\\\\\\\", \"(if contagious)\"),\n",
        "        )\n",
        "        factors.arrange(DOWN, buff=MED_LARGE_BUFF, aligned_edge=LEFT)\n",
        "        factors.shift(prev.get_center() - factors[0].get_center())\n",
        "\n",
        "        prior.generate_target()\n",
        "        prior.target.match_y(factors[1])\n",
        "        prior.target.shift(0.5 * RIGHT)\n",
        "        arrows = VGroup(*(\n",
        "            Arrow(\n",
        "                factor.get_right(), prior.target.get_corner(LEFT + u * UP),\n",
        "                buff=0.1,\n",
        "                max_tip_length_to_length_ratio=0.25,\n",
        "            )\n",
        "            for u, factor in zip([1, 0, -1], factors)\n",
        "        ))\n",
        "\n",
        "        population = Population(100)\n",
        "        population.set_height(7)\n",
        "        population.to_edge(LEFT)\n",
        "        population.set_fill(GREY_C)\n",
        "        random.choice(population).set_color(YELLOW)\n",
        "\n",
        "        self.play(Write(prev))\n",
        "        self.play(ShowIncreasingSubsets(population, run_time=3))\n",
        "        self.wait()\n",
        "        self.play(Write(eq[1:]))\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(strike),\n",
        "            FadeIn(not_words, shift=0.2 * DOWN, rate_func=squish_rate_func(smooth, 0.3, 1))\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            Uncreate(strike),\n",
        "            MoveToTarget(prior),\n",
        "            ReplacementTransform(eq[1], arrows),\n",
        "            LaggedStartMap(FadeIn, factors[1:], shift=0.25 * DOWN),\n",
        "            FadeOut(not_words, shift=DOWN)\n",
        "        )\n",
        "        self.remove(prev)\n",
        "        self.add(factors)\n",
        "        self.wait()\n",
        "\n",
        "        # Symptoms\n",
        "        randy = Randolph(height=1.5)\n",
        "        randy.to_corner(UR)\n",
        "        randy.shift(LEFT)\n",
        "\n",
        "        self.play(FadeIn(randy))\n",
        "        self.play(\n",
        "            ShowCreationThenFadeOut(Underline(factors[1], color=RED)),\n",
        "            randy.change, \"sick\",\n",
        "            randy.set_color, SICKLY_GREEN,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Contagion (implicit)\n",
        "        self.play(\n",
        "            ShowCreationThenFadeOut(Underline(factors[2][0], color=RED)),\n",
        "            ShowCreationThenFadeOut(Underline(factors[2][1], color=RED)),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(\n",
        "                FadeOut, VGroup(\n",
        "                    randy, prior, *arrows, *factors,\n",
        "                ),\n",
        "                shift=DOWN,\n",
        "            )\n",
        "        )\n",
        "\n",
        "\n",
        "class WhatAboutANegativeResult(Scene):\n",
        "    def construct(self):\n",
        "        # Test results\n",
        "        h_line = Line(LEFT, RIGHT)\n",
        "        h_line.set_width(FRAME_WIDTH)\n",
        "        h_line.set_stroke(GREY_B, 2)\n",
        "\n",
        "        randys = VGroup(Randolph(), Randolph())\n",
        "        randys.set_height(2)\n",
        "        clipboards = VGroup(\n",
        "            get_covid_clipboard(\"Cancer\", \"+\", \"Detected\", GREEN),\n",
        "            get_covid_clipboard(\"Cancer\", \"$-$\", \"Not Detected\", RED),\n",
        "        )\n",
        "\n",
        "        for randy, clipboard, y in zip(randys, clipboards, [2, -2]):\n",
        "            randy.set_y(y)\n",
        "            randy.to_edge(LEFT)\n",
        "            clipboard.match_height(randy)\n",
        "            clipboard.next_to(randy, RIGHT)\n",
        "\n",
        "        self.add(randys, h_line)\n",
        "        self.play(\n",
        "            FadeIn(clipboards[0], LEFT),\n",
        "            randys[0].change, \"horrified\", clipboards[0],\n",
        "            randys[1].change, \"guilty\", clipboards[0],\n",
        "        )\n",
        "        self.play(Blink(randys[0]))\n",
        "        self.play(\n",
        "            FadeIn(clipboards[1], LEFT),\n",
        "            randys[1].change, \"hooray\", clipboards[1]\n",
        "        )\n",
        "        self.play(Blink(randys[1]))\n",
        "        self.wait()\n",
        "\n",
        "        # Formulas\n",
        "        t2c = {\n",
        "            \"+\": GREEN,\n",
        "            \"-\": RED,\n",
        "            \"=\": WHITE,\n",
        "            \"\\\\approx\": WHITE,\n",
        "            \"\\\\over\": WHITE,\n",
        "            \"\\\\text{Cancer}\": YELLOW,\n",
        "            \"\\\\text{No cancer}\": GREY_B,\n",
        "            \"90\\\\%\": GREEN,\n",
        "            \"9\\\\%\": GREEN_D,\n",
        "            \"10\\\\%\": RED_D,\n",
        "            \"91\\\\%\": RED,\n",
        "        }\n",
        "        equations = VGroup(\n",
        "            OldTex(\n",
        "                \"={P(+ \\\\,|\\\\, \\\\text{Cancer}) \\\\over P(+ \\\\,|\\\\, \\\\text{No cancer})}\",\n",
        "                \"={90\\\\% \\\\over 9\\\\%} = 10\",\n",
        "                tex_to_color_map=t2c,\n",
        "            ),\n",
        "            OldTex(\n",
        "                \"={P(- \\\\,|\\\\, \\\\text{Cancer}) \\\\over P(- \\\\,|\\\\, \\\\text{No cancer})}\",\n",
        "                \"={10\\\\% \\\\over 91\\\\%} \\\\approx {1 \\\\over 9}\",\n",
        "                tex_to_color_map=t2c,\n",
        "            ),\n",
        "        )\n",
        "\n",
        "        for equation, clipboard in zip(equations, clipboards):\n",
        "            bf = OldTexText(\"Bayes\\\\\\\\Factor\")\n",
        "            bf.next_to(equation, LEFT)\n",
        "            equation.add_to_back(bf)\n",
        "            equation.next_to(clipboard, RIGHT, MED_LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            *(\n",
        "                FadeIn(equation, lag_ratio=0.1, run_time=2)\n",
        "                for equation in equations\n",
        "            ),\n",
        "            randys[0].change, \"pondering\", equations[0],\n",
        "            randys[1].change, \"thinking\", equations[0],\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Highlight parts\n",
        "        eq = equations[1]\n",
        "        frac_parts = VGroup(eq[2:7], eq[8:13])\n",
        "        rects = VGroup(*(\n",
        "            SurroundingRectangle(part, buff=0.1, stroke_color=TEAL, stroke_width=3)\n",
        "            for part in frac_parts\n",
        "        ))\n",
        "\n",
        "        self.play(ShowCreationThenFadeOut(rects[0]))\n",
        "        self.wait()\n",
        "        self.play(ShowCreationThenFadeOut(rects[1]))\n",
        "        self.wait()\n",
        "\n",
        "        fnr = eq.get_part_by_tex(\"10\\\\%\")\n",
        "        fnr_word = OldTexText(\"FNR\", font_size=36)\n",
        "        fnr_word.next_to(fnr, UP, buff=0.8)\n",
        "        fnr_arrow = Arrow(fnr_word.get_bottom(), fnr.get_top(), buff=0.1)\n",
        "\n",
        "        spec = eq.get_part_by_tex(\"91\\\\%\")\n",
        "        spec_word = OldTexText(\"Specificity\", font_size=36)\n",
        "        spec_word.next_to(spec, DOWN, buff=0.8)\n",
        "        spec_arrow = Arrow(spec_word.get_top(), spec.get_bottom(), buff=0.1)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(fnr_word, 0.5 * UP),\n",
        "            GrowArrow(fnr_arrow),\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(spec_word, 0.5 * DOWN),\n",
        "            GrowArrow(spec_arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "        for randy in randys:\n",
        "            self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class BayesTheorem(Scene):\n",
        "    def construct(self):\n",
        "        # Add title\n",
        "        title = OldTexText(\"The usual version of Bayes' rule\", font_size=60)\n",
        "        title.to_edge(UP, buff=MED_SMALL_BUFF)\n",
        "        title_line = Underline(title)\n",
        "        title_line.set_stroke(GREY, 2)\n",
        "        title_line.shift(SMALL_BUFF * UP)\n",
        "        title.add(title_line)\n",
        "\n",
        "        # Population\n",
        "        prior = 1 / 12\n",
        "        sensitivity = 0.8\n",
        "        specificity = 0.9\n",
        "\n",
        "        rects = VGroup(*[Square() for x in range(4)])\n",
        "        rects.set_stroke(WHITE, 2)\n",
        "        rects[:2].set_stroke(YELLOW)\n",
        "        rects.set_fill(GREY_D, 1)\n",
        "        rects.set_height(3)\n",
        "        rects.set_width(3, stretch=True)\n",
        "        rects.move_to(3.5 * LEFT + DOWN)\n",
        "\n",
        "        rects[:2].stretch(prior, 0, about_edge=LEFT)\n",
        "        rects[2:].stretch(1 - prior, 0, about_edge=RIGHT)\n",
        "        rects[0].stretch(sensitivity, 1, about_edge=UP)\n",
        "        rects[1].stretch(1 - sensitivity, 1, about_edge=DOWN)\n",
        "        rects[2].stretch(1 - specificity, 1, about_edge=UP)\n",
        "        rects[3].stretch(specificity, 1, about_edge=DOWN)\n",
        "\n",
        "        rects[0].set_fill(GREEN_D)\n",
        "        rects[1].set_fill(interpolate_color(RED_E, BLACK, 0.5))\n",
        "        rects[2].set_fill(GREEN_E, 0.75)\n",
        "        rects[3].set_fill(interpolate_color(RED_E, BLACK, 0.75))\n",
        "\n",
        "        icons = VGroup(*(WomanIcon() for x in range(120)))\n",
        "        icons.arrange_in_grid(\n",
        "            10, 12,\n",
        "            h_buff=1, v_buff=0.5,\n",
        "            fill_rows_first=False,\n",
        "        )\n",
        "        icons.replace(rects, dim_to_match=1)\n",
        "        icons.scale(0.98)\n",
        "        icons.set_fill(GREY_C)\n",
        "        icons[:10].set_fill(YELLOW)\n",
        "\n",
        "        # Add terminology\n",
        "        t2c = {\n",
        "            \"\\\\text{Disease}\": YELLOW,\n",
        "            \"\\\\text{D}\": YELLOW,\n",
        "            \"\\\\text{$\\\\neg$D}\": GREY_B,\n",
        "            \"\\\\text{Not sick}\": GREY_B,\n",
        "            \"{+}\": GREEN,\n",
        "            \"{-}\": RED,\n",
        "            \"\\\\text{Prior}\": YELLOW,\n",
        "            \"\\\\text{Sensitivity}\": GREEN,\n",
        "            \"\\\\text{FPR}\": GREEN_D,\n",
        "            \"\\\\text{TP}\": GREEN,\n",
        "            \"\\\\text{FP}\": GREEN_D,\n",
        "            \"(\": WHITE,\n",
        "            \")\": WHITE,\n",
        "            \"\\\\over\": WHITE,\n",
        "        }\n",
        "        kw = {\n",
        "            \"tex_to_color_map\": t2c,\n",
        "            \"font_size\": 30,\n",
        "        }\n",
        "\n",
        "        braces = VGroup(\n",
        "            Brace(rects[1], DOWN, buff=SMALL_BUFF),\n",
        "            *(\n",
        "                Brace(rect, u * RIGHT, buff=SMALL_BUFF)\n",
        "                for rect, u in zip(rects, [-1, -1, 1, 1])\n",
        "            )\n",
        "        )\n",
        "        braces.set_fill(GREY_B)\n",
        "        terms = VGroup(\n",
        "            OldTexText(\"Prior\"),\n",
        "            OldTexText(\"Sens.\"),\n",
        "            OldTexText(\"FNR\"),\n",
        "            OldTexText(\"FPR\"),\n",
        "            OldTexText(\"Spec.\"),\n",
        "        )\n",
        "        terms[0].set_color(YELLOW)\n",
        "        symbols = VGroup(\n",
        "            OldTex(\"P(\\\\text{D})\", **kw),\n",
        "            OldTex(\"P({+} | \\\\text{D})\", **kw),\n",
        "            OldTex(\"P({-} | \\\\text{D})\", **kw),\n",
        "            OldTex(\"P({+} | \\\\text{$\\\\neg$D})\", **kw),\n",
        "            OldTex(\"P({-} | \\\\text{$\\\\neg$D})\", **kw),\n",
        "        )\n",
        "        for term, symbol, brace in zip(terms, symbols, braces):\n",
        "            term.scale(0.75)\n",
        "            term.next_to(brace, brace.direction, buff=SMALL_BUFF)\n",
        "            symbol.next_to(brace, brace.direction, buff=SMALL_BUFF)\n",
        "\n",
        "        pop_group = VGroup(rects, icons, braces, symbols)\n",
        "        pop_group.save_state()\n",
        "        pop_group.set_height(5)\n",
        "        pop_group.center().to_edge(DOWN)\n",
        "\n",
        "        # Formula with jargon\n",
        "        lhs = OldTex(\"P(\\\\text{Disease} \\\\text{ given } {+})\", **kw)\n",
        "        lhs.scale(48 / 30)\n",
        "\n",
        "        term_formula = OldTex(\n",
        "            \"\"\"\n",
        "            {(\\\\text{Prior})(\\\\text{Sensitivity})\n",
        "            \\\\over\n",
        "            (\\\\text{Prior})(\\\\text{Sensitivity})\n",
        "            +\n",
        "            (1 - \\\\text{Prior})(\\\\text{FPR})\n",
        "            \"\"\",\n",
        "            **kw,\n",
        "        )\n",
        "\n",
        "        tp_formula = OldTex(\"{\\\\text{TP} \\\\over \\\\text{TP} + \\\\text{FP}}\", **kw)\n",
        "        tp_formula.scale(1.25)\n",
        "\n",
        "        prob_formula = OldTex(\n",
        "            \"\"\"\n",
        "            P(\\\\text{D}) P({+} \\\\,|\\\\, \\\\text{D})\n",
        "            \\\\over\n",
        "            P(\\\\text{D}) P({+} \\\\,|\\\\, \\\\text{D})\n",
        "            +\n",
        "            \"\"\",\n",
        "            \"\"\"\n",
        "            P(\\\\text{$\\\\neg$D}) P({+} \\\\,|\\\\, \\\\text{$\\\\neg$D})\n",
        "            \"\"\",\n",
        "            **kw\n",
        "        )\n",
        "        simple_prob_formula = OldTex(\n",
        "            \"P(\\\\text{D}) P({+} \\\\,|\\\\, \\\\text{D}) \\\\over P({+})\",\n",
        "            **kw\n",
        "        )\n",
        "        simple_prob_formula.scale(48 / 30)\n",
        "\n",
        "        equals = VGroup(*(OldTex(\"=\") for x in range(4)))\n",
        "        equals[2:].scale(1.5).rotate(90 * DEGREES)\n",
        "\n",
        "        formula = VGroup(lhs, equals[0], tp_formula, equals[1], term_formula)\n",
        "        formula.arrange(RIGHT)\n",
        "        formula.next_to(title, DOWN, MED_LARGE_BUFF)\n",
        "\n",
        "        prob_group = VGroup(\n",
        "            equals[2], prob_formula, equals[3], simple_prob_formula,\n",
        "        )\n",
        "        prob_group.arrange(DOWN, buff=0.35)\n",
        "        prob_group.next_to(term_formula, DOWN, buff=0.35)\n",
        "\n",
        "        # Show population\n",
        "        self.add(title)\n",
        "        self.play(FadeIn(lhs, DL))\n",
        "        self.play(Write(equals[0]))\n",
        "        self.wait()\n",
        "        self.play(ShowIncreasingSubsets(icons, run_time=2))\n",
        "        self.add(*pop_group)\n",
        "        self.play(\n",
        "            FadeIn(rects),\n",
        "            LaggedStartMap(GrowFromCenter, braces),\n",
        "            LaggedStartMap(FadeIn, symbols),\n",
        "            run_time=1,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        pop_to_fade = VGroup(*icons[8:])\n",
        "        pop_to_fade.remove(*icons[10::10])\n",
        "        self.play(\n",
        "            FadeIn(tp_formula),\n",
        "            pop_to_fade.set_opacity, 0.1,\n",
        "            symbols.set_opacity, 0.25,\n",
        "            braces.set_fill, GREY_E, 1,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show formula piece by piece\n",
        "        prob_formula.save_state()\n",
        "        prob_formula.move_to(term_formula, LEFT)\n",
        "\n",
        "        srkw = {\"buff\": 0.025}\n",
        "        blank_rects = VGroup(\n",
        "            SurroundingRectangle(VGroup(prob_formula[0:10]), **srkw),\n",
        "            SurroundingRectangle(VGroup(prob_formula[11:21]), **srkw),\n",
        "            SurroundingRectangle(VGroup(prob_formula[22:]), **srkw),\n",
        "        )\n",
        "        blank_rects.set_stroke(GREEN, 2)\n",
        "        blank_rects.set_fill(GREEN, 0.2)\n",
        "\n",
        "        self.play(\n",
        "            Write(equals[1]),\n",
        "            LaggedStartMap(FadeIn, VGroup(\n",
        "                prob_formula.get_part_by_tex(\"\\\\over\"),\n",
        "                prob_formula[21],\n",
        "                *blank_rects\n",
        "            ))\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            symbols[0].set_opacity, 1,\n",
        "            braces[0].set_fill, GREY_B,\n",
        "            FadeIn(prob_formula[0:4]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            symbols[1].set_opacity, 1,\n",
        "            braces[1].set_fill, GREY_B,\n",
        "            FadeIn(prob_formula[4:10]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(prob_formula[0:10], prob_formula[11:21])\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(prob_formula[22:26])\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(prob_formula[26:]),\n",
        "            braces[3].set_fill, GREY_B,\n",
        "            symbols[3].set_opacity, 1,\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(FadeOut(blank_rects))\n",
        "        self.wait()\n",
        "\n",
        "        # Words over symbols\n",
        "        self.play(\n",
        "            pop_group.replace, pop_group.saved_state,\n",
        "            Restore(prob_formula),\n",
        "            FadeIn(term_formula, scale=2),\n",
        "            FadeIn(equals[2], DOWN),\n",
        "        )\n",
        "        terms[2::2].set_opacity(0.2)\n",
        "        self.play(\n",
        "            FadeOut(symbols),\n",
        "            FadeIn(terms),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Show confused\n",
        "        randy = Randolph(height=2)\n",
        "        randy.to_edge(DOWN)\n",
        "        randy.shift(RIGHT)\n",
        "\n",
        "        self.play(\n",
        "            VFadeIn(randy),\n",
        "            randy.change, 'maybe', prob_formula\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.play(randy.change, 'confused', prob_formula)\n",
        "        self.wait()\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            randy.change, 'pondering', pop_group,\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        # Show simplify denominator\n",
        "        denom_rects = VGroup(\n",
        "            SurroundingRectangle(prob_formula[11:], buff=0.025),\n",
        "            SurroundingRectangle(simple_prob_formula[11:], buff=0.05),\n",
        "        )\n",
        "        denom_rects.set_stroke(GREY_B, 2)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(denom_rects[0]),\n",
        "            randy.look_at, denom_rects[0],\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(*denom_rects),\n",
        "            FadeIn(simple_prob_formula, DOWN),\n",
        "            FadeIn(equals[3], DOWN),\n",
        "            randy.change, 'erm', simple_prob_formula\n",
        "        )\n",
        "        self.play(FadeOut(denom_rects))\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "        self.play(randy.change, \"thinking\")\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        self.play(ShowCreation(denom_rects[1]))\n",
        "        self.play(\n",
        "            TransformFromCopy(*reversed(denom_rects)),\n",
        "            randy.change, \"sassy\", denom_rects[0],\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ContrastTwoFormulas(Scene):\n",
        "    def construct(self):\n",
        "        # Talk through odds formula\n",
        "        t2c = {\n",
        "            \"\\\\text{D}\": YELLOW,\n",
        "            \"\\\\text{$\\\\neg$D}\": GREY_B,\n",
        "            \"{+}\": GREEN,\n",
        "            \"(\": WHITE,\n",
        "            \")\": WHITE,\n",
        "            \"\\\\over\": WHITE,\n",
        "            \"O\": WHITE,\n",
        "            \"=\": WHITE,\n",
        "            \"\\\\text{Prior}\": YELLOW,\n",
        "            \"\\\\text{Sensitivity}\": GREEN,\n",
        "            \"\\\\text{Sens.}\": GREEN,\n",
        "            \"\\\\text{FPR}\": GREEN_D,\n",
        "        }\n",
        "        kw = {\"tex_to_color_map\": t2c}\n",
        "\n",
        "        odds_formula = OldTex(\n",
        "            \"O(\\\\text{D} | {+}) =\"\n",
        "            \"O(\\\\text{D})\"\n",
        "            \"{P({+} | \\\\text{D}) \\\\over P({+} | \\\\text{$\\\\neg$D})}\",\n",
        "            **kw\n",
        "        )\n",
        "        odds_formula.scale(1.25)\n",
        "        bf_part = odds_formula[11:]\n",
        "        post_part = odds_formula[:6]\n",
        "        prior_part = odds_formula[7:11]\n",
        "\n",
        "        post_words = OldTexText(\n",
        "            \"Odds of having the disease\\\\\\\\ \\\\emph{given} a positive test result\",\n",
        "            tex_to_color_map={\n",
        "                \"disease\": YELLOW,\n",
        "                \"positive\": GREEN,\n",
        "            }\n",
        "        )\n",
        "        post_words.next_to(post_part, UP, buff=1.5)\n",
        "        post_words.shift(LEFT)\n",
        "        post_arrow = Arrow(post_words.get_bottom(), post_part[:2].get_top(), buff=0.2)\n",
        "        prior_words = OldTexText(\"Prior odds\")\n",
        "        prior_words.next_to(prior_part, DOWN, buff=1.5)\n",
        "        prior_words.shift(LEFT)\n",
        "        prior_arrow = Arrow(prior_words.get_top(), prior_part[:2].get_bottom(), buff=0.2)\n",
        "\n",
        "        bf_rect = SurroundingRectangle(bf_part, buff=0.1)\n",
        "        bf_rect.set_stroke(TEAL, 2)\n",
        "        bf_words = OldTexText(\"Bayes factor\")\n",
        "        bf_words.next_to(bf_rect, UP)\n",
        "        bf_words.match_color(bf_rect)\n",
        "\n",
        "        self.play(Write(odds_formula))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(post_words, lag_ratio=0.1),\n",
        "            GrowArrow(post_arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(prior_words),\n",
        "            GrowArrow(prior_arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "        VGroup(bf_rect, bf_words).shift(SMALL_BUFF * RIGHT)\n",
        "        self.play(\n",
        "            FadeIn(bf_words, 0.25 * UP),\n",
        "            ShowCreation(bf_rect),\n",
        "            bf_part.shift, SMALL_BUFF * RIGHT,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Sweep aside\n",
        "        to_fade = VGroup(post_words, post_arrow, prior_words, prior_arrow)\n",
        "        odds_formula.add(bf_rect, bf_words)\n",
        "\n",
        "        v_line = Line(UP, DOWN).set_height(FRAME_HEIGHT)\n",
        "        v_line.set_stroke(GREY_B, 2)\n",
        "\n",
        "        titles = VGroup(\n",
        "            OldTexText(\"Using probability\"),\n",
        "            OldTexText(\"Using odds\"),\n",
        "        )\n",
        "        titles.scale(1.25)\n",
        "        for title, u in zip(titles, [-1, 1]):\n",
        "            title.set_x(u * FRAME_WIDTH / 4)\n",
        "        titles.to_edge(UP)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(v_line),\n",
        "            FadeOut(to_fade, shift=UR, scale=0.5),\n",
        "            odds_formula.scale, 0.7,\n",
        "            odds_formula.next_to, titles[1], DOWN, LARGE_BUFF,\n",
        "            FadeIn(titles[0], LEFT),\n",
        "            FadeIn(titles[1], RIGHT),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Contrast with usual formula\n",
        "        prob_formula = OldTex(\n",
        "            \"\"\"\n",
        "            P(\\\\text{D} | {+}) =\n",
        "            {P(\\\\text{D}) P({+} \\\\,|\\\\, \\\\text{D})\n",
        "            \\\\over\n",
        "            P(\\\\text{D}) P({+} \\\\,|\\\\, \\\\text{D})\n",
        "            +\n",
        "            P(\\\\text{$\\\\neg$D}) P({+} \\\\,|\\\\, \\\\text{$\\\\neg$D})}\n",
        "            \"\"\",\n",
        "            **kw\n",
        "        )\n",
        "        prob_rhs = prob_formula[7:]\n",
        "        prob_formula.set_width(FRAME_WIDTH / 2 - 1)\n",
        "        prob_formula.set_x(-FRAME_WIDTH / 4)\n",
        "        prob_formula.match_y(bf_part)\n",
        "\n",
        "        self.play(FadeIn(prob_formula, shift=0.25 * DOWN, scale=1.2))\n",
        "        self.wait()\n",
        "\n",
        "        # Use term-based formulas\n",
        "        term_formula = OldTex(\n",
        "            \"\"\"\n",
        "            {(\\\\text{Prior})(\\\\text{Sensitivity})\n",
        "            \\\\over\n",
        "            (\\\\text{Prior})(\\\\text{Sensitivity})\n",
        "            +\n",
        "            (1 - \\\\text{Prior})(\\\\text{FPR})\n",
        "            \"\"\",\n",
        "            **kw\n",
        "        )\n",
        "        term_formula.replace(prob_rhs, 0)\n",
        "        bf_terms = OldTex(\n",
        "            \"\\\\text{Sensitivity} \\\\over \\\\text{FPR}\",\n",
        "            **kw\n",
        "        )\n",
        "        bf_terms.replace(bf_part, 0)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(prob_rhs, 0.5 * UP),\n",
        "            FadeIn(term_formula, 0.5 * UP),\n",
        "            FadeOut(bf_part, 0.5 * UP),\n",
        "            FadeIn(bf_terms, 0.5 * UP),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Comment on prior/test separation\n",
        "        kw2 = {\n",
        "            \"tex_to_color_map\": {\n",
        "                \"Prior\": YELLOW,\n",
        "                \"test accuracy\": GREEN,\n",
        "                \"separate\": GREY_A,\n",
        "                \"intermingled\": GREY_A,\n",
        "            }\n",
        "        }\n",
        "        pt_comments = VGroup(\n",
        "            OldTexText(\"Prior and test accuracy\\\\\\\\are intermingled\", **kw2),\n",
        "            OldTexText(\"Prior and test accuracy\\\\\\\\are separate\", **kw2),\n",
        "        )\n",
        "        for comment, formula in zip(pt_comments, [prob_formula, odds_formula]):\n",
        "            comment.match_x(formula)\n",
        "        pt_comments.set_y(-2)\n",
        "\n",
        "        self.play(Write(pt_comments[1], run_time=1))\n",
        "        self.play(\n",
        "            VGroup(bf_terms, bf_rect, bf_words).shift, 0.25 * UR,\n",
        "            prior_part.shift, 0.25 * UL,\n",
        "            rate_func=there_and_back_with_pause,\n",
        "            run_time=2,\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(pt_comments[1][:-1], pt_comments[0][:-1], path_arc=-20 * DEGREES),\n",
        "            GrowFromPoint(pt_comments[0][-1], pt_comments[1][-1].get_left(), path_arc=20 * DEGREES),\n",
        "            run_time=1,\n",
        "        )\n",
        "        words_to_move = VGroup(\n",
        "            *term_formula.get_parts_by_tex(\"\\\\text{Prior}\"),\n",
        "            *term_formula.get_parts_by_tex(\"\\\\text{Sensitivity}\"),\n",
        "            *term_formula.get_parts_by_tex(\"\\\\text{FPR}\"),\n",
        "        )\n",
        "        self.play(LaggedStart(*(\n",
        "            ApplyMethod(\n",
        "                part.shift, 0.25 * vect,\n",
        "                rate_func=there_and_back_with_pause,\n",
        "                run_time=2,\n",
        "            )\n",
        "            for part, vect in zip(words_to_move, [UP, DOWN, DOWN, UP, DOWN, DOWN])\n",
        "        ), lag_ratio=0.05))\n",
        "        self.wait()\n",
        "\n",
        "        # Comment on multiple updates\n",
        "        kw[\"tex_to_color_map\"].update({\n",
        "            \"{E_1}\": GREEN,\n",
        "            \"{E_2}\": BLUE,\n",
        "        })\n",
        "        mult_formula = OldTex(\n",
        "            \"O(\\\\text{D} | {E_1}, {E_2}) =\",\n",
        "            \"O(\\\\text{D})\\\\,\\\\,\",\n",
        "            \"{P({E_1} | \\\\text{D}) \\\\over P({E_1} | \\\\text{$\\\\neg$D})}\\\\,\\\\,\",\n",
        "            \"{P({E_2} | \\\\text{D}, {E_1}) \\\\over P({E_2} | \\\\text{$\\\\neg$D}, {E_1})}\",\n",
        "            **kw\n",
        "        )\n",
        "        mult_formula.set_width(FRAME_WIDTH / 2 - 1)\n",
        "        mult_formula.next_to(odds_formula, DOWN, buff=1.5)\n",
        "\n",
        "        new_bf_parts = VGroup(mult_formula[14:27], mult_formula[27:])\n",
        "        new_bf_rects = VGroup(*(\n",
        "            SurroundingRectangle(part, buff=0.05)\n",
        "            for part in new_bf_parts\n",
        "        ))\n",
        "        new_bf_rects[0].set_stroke(GREEN, 2)\n",
        "        new_bf_rects[1].set_stroke(BLUE, 2)\n",
        "        new_bf_labels = VGroup()\n",
        "        for n, rect in zip(it.count(1), new_bf_rects):\n",
        "            words = OldTexText(f\"Bayes\\\\\\\\Factor {n}\", font_size=28)\n",
        "            parens = OldTex(*\"()\")\n",
        "            parens.set_height(1.2 * words.get_height(), stretch=True)\n",
        "            parens[0].next_to(words, LEFT, buff=0)\n",
        "            parens[1].next_to(words, RIGHT, buff=0)\n",
        "            words.add(parens)\n",
        "            words.match_color(rect)\n",
        "            words.next_to(rect, UP, MED_SMALL_BUFF)\n",
        "            new_bf_labels.add(words)\n",
        "            words.save_state()\n",
        "\n",
        "        new_bf_labels.match_y(new_bf_parts)\n",
        "        for part in new_bf_parts:\n",
        "            part.save_state()\n",
        "            part.set_color(BLACK)\n",
        "\n",
        "        clipboards = VGroup(*(\n",
        "            get_covid_clipboard(\"Disease\").set_height(1.5).next_to(rect, DOWN)\n",
        "            for rect in new_bf_rects\n",
        "        ))\n",
        "        sick_randy = Randolph(height=1.5)\n",
        "        sick_randy.move_to(clipboards[1])\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(pt_comments),\n",
        "            FadeIn(mult_formula, lag_ratio=0.1),\n",
        "            FadeIn(new_bf_labels, lag_ratio=0.1),\n",
        "            FadeIn(new_bf_rects, lag_ratio=0.1),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeIn, clipboards, shift=0.5 * DOWN, lag_ratio=0.3)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(sick_randy, 0.5 * DOWN),\n",
        "            FadeOut(clipboards[1], 0.5 * DOWN),\n",
        "        )\n",
        "        self.play(\n",
        "            sick_randy.change, \"sick\",\n",
        "            sick_randy.set_color, SICKLY_GREEN,\n",
        "        )\n",
        "        self.play(Blink(sick_randy))\n",
        "        self.wait()\n",
        "        for i in (0, 1):\n",
        "            new_bf_parts[i].restore()\n",
        "            self.play(\n",
        "                Restore(new_bf_labels[i]),\n",
        "                FadeIn(new_bf_parts[i]),\n",
        "                sick_randy.look_at, new_bf_labels[i],\n",
        "            )\n",
        "            self.wait()\n",
        "        self.play(Blink(sick_randy))\n",
        "        self.wait()\n",
        "\n",
        "        to_fade = VGroup(mult_formula, new_bf_labels, new_bf_rects, clipboards[0], sick_randy)\n",
        "        self.play(LaggedStartMap(FadeOut, to_fade, shift=DOWN))\n",
        "\n",
        "        # Comment\n",
        "        randy = Randolph(height=1.5)\n",
        "        morty = Mortimer(height=1.5)\n",
        "        pis = VGroup(randy, morty)\n",
        "        pis.arrange(RIGHT, buff=2)\n",
        "        pis.to_corner(DR)\n",
        "        pis.to_edge(DOWN)\n",
        "\n",
        "        self.play(FadeIn(pis))\n",
        "        self.play(PiCreatureSays(\n",
        "            randy, \"How accurate is\\\\\\\\the test?\",\n",
        "            bubble_config={\"height\": 2, \"width\": 3},\n",
        "            content_introduction_class=FadeIn,\n",
        "            bubble_creation_class=FadeIn,\n",
        "            target_mode=\"raise_left_hand\",\n",
        "            look_at=morty.eyes,\n",
        "            run_time=1,\n",
        "        ))\n",
        "        content = OldTexText(\"Bayes factor 100\", tex_to_color_map={\"$+$\": GREEN})\n",
        "        self.play(PiCreatureSays(\n",
        "            morty, content,\n",
        "            target_mode=\"hooray\",\n",
        "            bubble_config={\"height\": 2, \"width\": 3},\n",
        "            content_introduction_class=FadeIn,\n",
        "            bubble_creation_class=FadeIn,\n",
        "            look_at=randy.eyes,\n",
        "            run_time=1\n",
        "        ))\n",
        "        for x in range(2):\n",
        "            self.play(Blink(randy))\n",
        "            self.play(Blink(morty))\n",
        "            self.wait()\n",
        "\n",
        "\n",
        "class ConfusedByFPR(Scene):\n",
        "    def construct(self):\n",
        "        # Background\n",
        "        br = FullScreenFadeRectangle()\n",
        "        br.set_fill(GREY_E, 1)\n",
        "        self.add(br)\n",
        "\n",
        "        # State FPR\n",
        "        randy = Randolph(height=2.5, color=BLUE_C)\n",
        "        randy.to_corner(DL, buff=LARGE_BUFF)\n",
        "\n",
        "        clipboard = get_covid_clipboard(\"Cancer\")\n",
        "        clipboard.set_height(2)\n",
        "        clipboard.next_to(randy.get_corner(UR), RIGHT)\n",
        "\n",
        "        doctor = SVGMobject(\"female_doctor\")\n",
        "        doctor.remove(doctor[0])\n",
        "        doctor.set_stroke(width=0)\n",
        "        doctor.set_fill(GREY_B)\n",
        "        doctor.set_height(2.5)\n",
        "        doctor.to_corner(DR, buff=LARGE_BUFF)\n",
        "\n",
        "        fpr_words = OldTexText(\n",
        "            \"This test's\\\\\\\\false positive rate\\\\\\\\is 9\\\\%\",\n",
        "            tex_to_color_map={\n",
        "                \"false positive rate\": GREEN,\n",
        "                \"9\\\\%\": WHITE,\n",
        "            }\n",
        "        )\n",
        "        bubble = SpeechBubble(height=3, width=4)\n",
        "        bubble.pin_to(doctor)\n",
        "        bubble.add_content(fpr_words)\n",
        "\n",
        "        self.add(randy)\n",
        "        self.add(doctor)\n",
        "        self.play(\n",
        "            FadeIn(clipboard, LEFT),\n",
        "            randy.change, \"guilty\"\n",
        "        )\n",
        "        self.play(\n",
        "            DrawBorderThenFill(bubble),\n",
        "            Write(fpr_words)\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        # Misinterpret\n",
        "        false_prob = OldTex(\n",
        "            \"P(\\\\text{Test is false}) = 9\\\\%\",\n",
        "            tex_to_color_map={\"9\\\\%\": WHITE}\n",
        "        )\n",
        "        thought_bubble = ThoughtBubble(height=3, width=4)\n",
        "        thought_bubble.pin_to(randy)\n",
        "        thought_bubble.add_content(false_prob)\n",
        "        cross = Cross(thought_bubble[-1])\n",
        "\n",
        "        self.play(\n",
        "            randy.change, 'confused', false_prob,\n",
        "            DrawBorderThenFill(thought_bubble),\n",
        "            FadeIn(false_prob),\n",
        "            clipboard.shift, DOWN,\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.play(\n",
        "            ShowCreation(cross),\n",
        "            randy.change, \"maybe\", cross,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Sweep away\n",
        "        self.play(\n",
        "            randy.change, \"hesitant\",\n",
        "            LaggedStartMap(\n",
        "                FadeOut, VGroup(thought_bubble, false_prob, cross),\n",
        "                scale=0.5,\n",
        "                run_time=1,\n",
        "            )\n",
        "        )\n",
        "\n",
        "        # Mention Bayes factor instead\n",
        "        bf_words = OldTexText(\n",
        "            \"This test's\\\\\\\\positive Bayes factor\\\\\\\\is 10\",\n",
        "            tex_to_color_map={\n",
        "                \"positive Bayes factor\": YELLOW,\n",
        "                \"10\": WHITE,\n",
        "            }\n",
        "        )\n",
        "        bf_words.replace(fpr_words, 1)\n",
        "        anims = []\n",
        "        for m1, m2 in zip(fpr_words, bf_words):\n",
        "            m1.generate_target()\n",
        "            m1.target.replace(m2, stretch=True)\n",
        "            m1.target.set_opacity(0)\n",
        "            anims.append(MoveToTarget(m1, remover=True))\n",
        "\n",
        "            m2.save_state()\n",
        "            m2.replace(m1, stretch=True)\n",
        "            m2.set_opacity(0)\n",
        "            anims.append(Restore(m2))\n",
        "\n",
        "        self.play(*anims)\n",
        "        self.play(randy.change, \"pondering\")\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ShowContrastingMethods(Scene):\n",
        "    def construct(self):\n",
        "        # Prepare stats\n",
        "        stats = VGroup(\n",
        "            OldTexText(\"Prior: \", \"2\\\\%\"),\n",
        "            OldTexText(\"Sensitivity: \", \"90\\\\%\"),\n",
        "            OldTexText(\"Specificity: \", \"99\\\\%\"),\n",
        "        )\n",
        "        stats.arrange(DOWN, aligned_edge=LEFT)\n",
        "        colors = [YELLOW, GREEN, BLUE]\n",
        "        for stat, color in zip(stats, colors):\n",
        "            stat[0].set_color(color)\n",
        "            stat[1].align_to(stats[-1][1], LEFT)\n",
        "\n",
        "        stat_rect = SurroundingRectangle(stats, buff=0.2)\n",
        "        stat_rect.set_fill(GREY_E, 1)\n",
        "        stat_rect.set_stroke(WHITE, 2)\n",
        "        stats.add_to_back(stat_rect)\n",
        "        stats.set_height(1.5)\n",
        "\n",
        "        # Setup division\n",
        "        h_line = Line(LEFT, RIGHT)\n",
        "        h_line.set_width(FRAME_WIDTH)\n",
        "        h_line.set_stroke(GREY, 2)\n",
        "\n",
        "        titles = VGroup(\n",
        "            OldTexText(\"Using odds\"),\n",
        "            OldTexText(\"Using probability\"),\n",
        "        )\n",
        "        titles.set_fill(GREY_A)\n",
        "        titles[0].to_edge(UP)\n",
        "        titles[1].next_to(ORIGIN, DOWN, MED_SMALL_BUFF)\n",
        "        for title in titles:\n",
        "            line = Underline(title)\n",
        "            line.shift(0.1 * UP)\n",
        "            line.set_stroke(GREY_B, 2)\n",
        "            title.add(line)\n",
        "\n",
        "        stats_pair = VGroup(stats, stats.copy())\n",
        "        anims = []\n",
        "        for sp, u in zip(stats_pair, [1, -1]):\n",
        "            y = u * FRAME_HEIGHT / 4\n",
        "            sp.set_y(y)\n",
        "            sp.shift(0.5 * DOWN)\n",
        "            sp.to_edge(LEFT)\n",
        "            anims.append(FadeIn(sp, shift=y * UP))\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(h_line),\n",
        "            FadeIn(titles),\n",
        "            *anims\n",
        "        )\n",
        "\n",
        "        # Bayes factor method\n",
        "        prior_odds = OldTexText(\"Prior odds = \", \"2:99\")\n",
        "        bf_eq = VGroup(\n",
        "            OldTexText(\"Bayes\\\\\\\\Factor\"),\n",
        "            OldTex(\n",
        "                \"= {90\\\\% \\\\over 1\\\\%} = 90\",\n",
        "                tex_to_color_map={\"90\\\\%\": GREEN, \"1\\\\%\": BLUE}\n",
        "            ),\n",
        "        )\n",
        "        bf_eq.arrange(RIGHT, buff=SMALL_BUFF)\n",
        "\n",
        "        steps = VGroup(prior_odds, bf_eq)\n",
        "        steps.scale(0.9)\n",
        "        steps.arrange(DOWN, buff=0.75, aligned_edge=LEFT)\n",
        "        steps.next_to(stats, RIGHT, buff=1.0)\n",
        "\n",
        "        p_rect = SurroundingRectangle(stats[1][1], buff=0.05)\n",
        "        ss_rect = SurroundingRectangle(VGroup(stats[2][1], stats[3][1]), buff=0.05)\n",
        "        ss_rect.set_stroke(GREEN)\n",
        "        p_rect.match_width(ss_rect, stretch=True, about_edge=LEFT)\n",
        "\n",
        "        p_arrow = Arrow(p_rect.get_right(), prior_odds.get_left(), buff=0.1)\n",
        "        p_arrow.match_color(p_rect)\n",
        "        ss_arrow = Arrow(ss_rect.get_right(), bf_eq.get_left(), buff=0.1)\n",
        "        ss_arrow.match_color(ss_rect)\n",
        "\n",
        "        ans = OldTex(\"\\\\text{180:99} \\\\approx 2:1 \\\\rightarrow {2 \\\\over 3}\")\n",
        "        ans.scale(0.9)\n",
        "        ans.next_to(steps, RIGHT, buff=1.0)\n",
        "        globals()['ans'] = ans\n",
        "        ans_arrows = VGroup(*(\n",
        "            Arrow(step.get_right(), ans.get_left(), buff=0.1)\n",
        "            for step in steps\n",
        "        ))\n",
        "\n",
        "        # PPV formula\n",
        "        ppv_formula = OldTex(\n",
        "            \"\"\"\n",
        "            \\\\text{PPV} = \n",
        "            {(0.02)(0.9) \\\\over (0.02)(0.9) + (1 - 0.02)(0.01)}\n",
        "            \\\\approx 0.647\n",
        "            \"\"\",\n",
        "            tex_to_color_map={\n",
        "                \"0.02\": YELLOW,\n",
        "                \"0.9\": GREEN,\n",
        "                \"0.01\": BLUE,\n",
        "            }\n",
        "        )\n",
        "        ppv_formula.scale(0.9)\n",
        "        ppv_formula.next_to(stats_pair[1], RIGHT, LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(steps, RIGHT),\n",
        "            ShowCreation(p_rect),\n",
        "            ShowCreation(ss_rect),\n",
        "            GrowArrow(p_arrow),\n",
        "            GrowArrow(ss_arrow),\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(ppv_formula, RIGHT)\n",
        "        )\n",
        "        self.play(\n",
        "            *map(GrowArrow, ans_arrows),\n",
        "            FadeIn(ans, RIGHT)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class FailedPromises(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        self.student_says(\n",
        "            \"Are you still doing\\\\\\\\``Probabilities\\\\\\\\of probabilities''?\",\n",
        "            bubble_config={\n",
        "                \"height\": 3.5,\n",
        "                \"width\": 4.5,\n",
        "            },\n",
        "            index=0,\n",
        "            target_mode=\"sassy\",\n",
        "            added_anims=[self.teacher.change, \"guilty\"]\n",
        "        )\n",
        "        self.students[0].bubble = None\n",
        "        self.student_says(\n",
        "            \"And what about\\\\\\\\Differential equations?\",\n",
        "            bubble_config={\n",
        "                \"height\": 3,\n",
        "                \"width\": 4,\n",
        "                \"direction\": LEFT,\n",
        "            },\n",
        "            index=2,\n",
        "            target_mode=\"angry\",\n",
        "            added_anims=[self.students[1].change, \"hesitant\"],\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class MentionPart2(Scene):\n",
        "    def construct(self):\n",
        "        self.add(FullScreenFadeRectangle(fill_color=GREY_E, fill_opacity=1))\n",
        "\n",
        "        tweet = ImageMobject(\"twitter_covid_test_poll\")\n",
        "        tweet.set_height(5)\n",
        "        tweet.to_edge(LEFT)\n",
        "\n",
        "        words = OldTexText(\n",
        "            \"Possible follow-up\\\\\\\\breaking this down\",\n",
        "            alignment=\"\",\n",
        "            font_size=60\n",
        "        )\n",
        "        words.to_edge(RIGHT)\n",
        "        words.align_to(tweet, UP)\n",
        "        arrow = Arrow(words.get_bottom() + SMALL_BUFF * DOWN, tweet.get_right(), path_arc=-45 * DEGREES)\n",
        "\n",
        "        low_words = OldTexText(\"How would you answer?\")\n",
        "        low_words.match_x(words)\n",
        "        low_words.align_to(tweet, DOWN)\n",
        "        low_words.set_color(BLUE)\n",
        "\n",
        "        self.add(words)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(tweet, shift=LEFT, scale=1.2),\n",
        "            DrawBorderThenFill(arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Write(low_words, run_time=1))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class EndScreen(PatreonEndScreen):\n",
        "    pass\n",
        "\n",
        "\n",
        "# Everything above has been combed through after the rewrite\n",
        "\n",
        "class OldBayesFactorCode(Scene):\n",
        "    def construct(self):\n",
        "        # Show test statistics\n",
        "        def get_prob_bars(p_positive):\n",
        "            rects = VGroup(Square(), Square())\n",
        "            rects.set_width(0.2, stretch=True)\n",
        "            rects.set_stroke(WHITE, 2)\n",
        "            rects[0].stretch(p_positive, 1, about_edge=UP)\n",
        "            rects[1].stretch(1 - p_positive, 1, about_edge=DOWN)\n",
        "            rects[0].set_fill(GREEN, 1)\n",
        "            rects[1].set_fill(RED_E, 1)\n",
        "\n",
        "            braces = VGroup(*[\n",
        "                Brace(rect, LEFT, buff=SMALL_BUFF)\n",
        "                for rect in rects\n",
        "            ])\n",
        "            positive_percent = int(p_positive * 100)\n",
        "            percentages = VGroup(\n",
        "                OldTexText(f\"{positive_percent}\\\\% +\", color=GREEN),\n",
        "                OldTexText(f\"{100 - positive_percent}\\\\% $-$\", color=RED),\n",
        "            )\n",
        "            percentages.scale(0.7)\n",
        "            for percentage, brace in zip(percentages, braces):\n",
        "                percentage.next_to(brace, LEFT, SMALL_BUFF)\n",
        "\n",
        "            result = VGroup(\n",
        "                rects,\n",
        "                braces,\n",
        "                percentages,\n",
        "            )\n",
        "\n",
        "            return result\n",
        "\n",
        "        boxes = VGroup(\n",
        "            Square(color=YELLOW),\n",
        "            Square(color=GREY_B)\n",
        "        )\n",
        "        boxes.set_height(3)\n",
        "        labels = VGroup(\n",
        "            OldTexText(\"With cancer\"),\n",
        "            OldTexText(\"Without cancer\"),\n",
        "        )\n",
        "        for box, label in zip(boxes, labels):\n",
        "            label.next_to(box, UP)\n",
        "            label.match_color(box)\n",
        "            box.push_self_into_submobjects()\n",
        "            box.add(label)\n",
        "\n",
        "        boxes.arrange(DOWN, buff=0.5)\n",
        "        boxes.to_edge(RIGHT)\n",
        "\n",
        "        sens_bars = get_prob_bars(0.9)\n",
        "        spec_bars = get_prob_bars(0.09)\n",
        "        bar_groups = VGroup(sens_bars, spec_bars)\n",
        "        for bars, box in zip(bar_groups, boxes):\n",
        "            bars.shift(box[0].get_right() - bars[0].get_center())\n",
        "            bars.shift(0.75 * LEFT)\n",
        "            box.add(bars)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(boxes[0], lag_ratio=0.1),\n",
        "            post_group.scale, 0.1, {\"about_point\": FRAME_HEIGHT * DOWN / 2}\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(boxes[1], lag_ratio=0.1)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Pull out Bayes factor\n",
        "        ratio = VGroup(\n",
        "            sens_bars[2][0].copy(),\n",
        "            OldTex(\"\\\\phantom{90\\\\%+} \\\\over \\\\phantom{9\\\\%+}\"),\n",
        "            spec_bars[2][0].copy(),\n",
        "            *Tex(\"=\", \"10\"),\n",
        "        )\n",
        "        ratio.generate_target()\n",
        "        ratio.target[:3].arrange(DOWN, buff=0.2)\n",
        "        ratio.target[3:].arrange(RIGHT, buff=0.2)\n",
        "        ratio.target[3:].next_to(ratio.target[:3], RIGHT, buff=0.2)\n",
        "        ratio.target.center()\n",
        "\n",
        "        ratio[1].scale(0)\n",
        "        ratio[3:].scale(0)\n",
        "\n",
        "        new_boxes = VGroup(boxes[0][0], boxes[1][0]).copy()\n",
        "        new_boxes.generate_target()\n",
        "        for box, part in zip(new_boxes.target, ratio.target[::2]):\n",
        "            box.replace(part, stretch=True)\n",
        "            box.scale(1.2)\n",
        "            box.set_stroke(width=2)\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(ratio),\n",
        "            MoveToTarget(new_boxes),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        for part, box in zip(ratio[0:3:2], new_boxes):\n",
        "            part.add(box)\n",
        "\n",
        "        self.remove(new_boxes)\n",
        "        self.add(ratio)\n",
        "\n",
        "        bayes_factor_label = OldTexText(\"``Bayes factor''\")\n",
        "        bayes_factor_label.next_to(ratio, UP, LARGE_BUFF)\n",
        "        self.play(Write(bayes_factor_label))\n",
        "        self.wait()\n",
        "\n",
        "        # Show updated result\n",
        "        bayes_factor_label.generate_target()\n",
        "        bayes_factor_label.target.scale(0.8)\n",
        "        bayes_factor_label.target.next_to(\n",
        "            post_group.saved_state[0], DOWN,\n",
        "            buff=LARGE_BUFF,\n",
        "        )\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(bayes_factor_label),\n",
        "            ratio.scale, 0.8,\n",
        "            ratio.next_to, bayes_factor_label.target, DOWN,\n",
        "            Restore(post_group),\n",
        "            FadeOut(boxes, shift=2 * RIGHT),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class AskAboutHowItsSoLow(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        question = OldTexText(\n",
        "            \"How can it be 1 in 11\\\\\\\\\"\n",
        "            \"if the test is accurate more\\\\\\\\\"\n",
        "            \"than 90\\\\% of the time?\",\n",
        "            tex_to_color_map={\n",
        "                \"1 in 11\": BLUE,\n",
        "                \"90\\\\%\": YELLOW,\n",
        "            }\n",
        "        )\n",
        "        self.student_says(\n",
        "            question,\n",
        "            index=1,\n",
        "            target_mode=\"maybe\",\n",
        "        )\n",
        "        self.play_student_changes(\n",
        "            \"confused\", \"maybe\", \"confused\",\n",
        "            look_at=question,\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(self.teacher.change, \"tease\", question)\n",
        "        self.wait(2)\n",
        "\n",
        "\n",
        "class HowDoesUpdatingWork(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        students = self.students\n",
        "        teacher = self.teacher\n",
        "\n",
        "        self.student_says(\n",
        "            \"Where are these\\\\\\\\numbers coming\\\\\\\\from?\",\n",
        "            target_mode=\"raise_right_hand\"\n",
        "        )\n",
        "        self.play(\n",
        "            teacher.change, \"happy\",\n",
        "            self.change_students(\"confused\", \"erm\", \"raise_right_hand\"),\n",
        "        )\n",
        "        self.look_at(self.screen)\n",
        "        self.wait(3)\n",
        "\n",
        "        sample_pop = OldTexText(\"Sample populations (most intuitive)\")\n",
        "        bayes_factor = OldTexText(\"Bayes' factor (most fun)\")\n",
        "        for words in sample_pop, bayes_factor:\n",
        "            words.move_to(self.hold_up_spot, DOWN)\n",
        "            words.shift_onto_screen()\n",
        "\n",
        "        bayes_factor.set_fill(YELLOW)\n",
        "\n",
        "        self.play(\n",
        "            RemovePiCreatureBubble(students[2]),\n",
        "            teacher.change, \"raise_right_hand\",\n",
        "            FadeIn(sample_pop, shift=UP, scale=1.5),\n",
        "            self.change_students(\n",
        "                \"pondering\", \"thinking\", \"pondering\",\n",
        "                look_at=sample_pop,\n",
        "            )\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            FadeIn(bayes_factor, shift=UP, scale=1.5),\n",
        "            sample_pop.shift, UP,\n",
        "            teacher.change, \"hooray\",\n",
        "            self.change_students(\n",
        "                \"thinking\", \"confused\", \"erm\",\n",
        "            )\n",
        "        )\n",
        "        self.look_at(bayes_factor)\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class HighlightBayesFactorOverlay(Scene):\n",
        "    def construct(self):\n",
        "        rect = Rectangle(height=2, width=3)\n",
        "        rect.set_stroke(BLUE, 3)\n",
        "        words = OldTexText(\"How to\\\\\\\\use this\")\n",
        "        words.next_to(rect, DOWN, buff=1.5)\n",
        "        words.shift(2 * RIGHT)\n",
        "        words.match_color(rect)\n",
        "        arrow = Arrow(\n",
        "            words.get_left(),\n",
        "            rect.get_bottom(),\n",
        "            path_arc=-60 * DEGREES\n",
        "        )\n",
        "        arrow.match_color(words)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(words, scale=1.1),\n",
        "            DrawBorderThenFill(arrow),\n",
        "        )\n",
        "        self.play(\n",
        "            ShowCreation(rect),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class CompressedBayesFactorSteps(Scene):\n",
        "    def construct(self):\n",
        "        steps = OldTexText(\n",
        "            \"Step 1) \", \"Express the prior with odds\\\\\\\\\",\n",
        "            \"Step 2) \", \"Compute the Bayes factor\\\\\\\\\",\n",
        "            \"Step 3) \", \"Multiply\\\\\\\\\",\n",
        "            alignment=\"\",\n",
        "        )\n",
        "        steps[1].set_color(YELLOW)\n",
        "        steps[3].set_color(GREEN)\n",
        "        steps[5].set_color(BLUE)\n",
        "        steps.set_width(FRAME_WIDTH - 2)\n",
        "\n",
        "        self.add(steps)\n",
        "\n",
        "\n",
        "class LookOverTweet(Scene):\n",
        "    def construct(self):\n",
        "        # Tweet\n",
        "        bg_rect = FullScreenFadeRectangle()\n",
        "        bg_rect.set_fill(GREY_E, 1)\n",
        "        self.add(bg_rect)\n",
        "\n",
        "        tweet = ImageMobject(\"twitter_covid_test_poll\")\n",
        "        tweet.set_height(6)\n",
        "        tweet.to_edge(LEFT)\n",
        "        self.play(FadeIn(tweet, shift=UP, scale=1.2))\n",
        "        self.wait()\n",
        "\n",
        "        # Tweet highlights\n",
        "        lines = VGroup(\n",
        "            Line((-3.9, 1.7), (0.3, 1.7)),\n",
        "            Line((-3.4, 0.1), (-0.7, 0.1)),\n",
        "            VGroup(\n",
        "                Line((0.2, 0.1), (0.8, 0.1)),\n",
        "                Line((-6.4, -0.3), (-4, -0.3)),\n",
        "            ),\n",
        "        )\n",
        "        lines.set_color(RED)\n",
        "\n",
        "        rects = VGroup(*(Rectangle(3.2, 0.37) for x in range(4)))\n",
        "        rects.arrange(DOWN, buff=0.08)\n",
        "        rects.set_stroke(BLUE, 3)\n",
        "        rects.set_fill(BLUE, 0.25)\n",
        "        rects.move_to((-4.8, -1.66, 0.))\n",
        "\n",
        "        # Population\n",
        "        icon = SVGMobject(\"person\")\n",
        "        icon.set_stroke(width=0)\n",
        "        globals()['icon'] = icon\n",
        "        population = VGroup(*(icon.copy() for x in range(1000)))\n",
        "\n",
        "        population.scale(1 / population[0].get_height())\n",
        "        population.arrange_in_grid(\n",
        "            30, 33,\n",
        "            buff=MED_LARGE_BUFF,\n",
        "        )\n",
        "        population.set_width(4)\n",
        "        population.to_edge(RIGHT)\n",
        "        population.set_fill(GREY_B)\n",
        "        population[random.randint(0, 1000)].set_fill(YELLOW)\n",
        "\n",
        "        pop_title = OldTexText(\"1\", \" in \", \"1,000\")\n",
        "        pop_title[0].set_color(YELLOW)\n",
        "        pop_title.next_to(population, UP)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(pop_title, shift=0.25 * UP),\n",
        "            ShowIncreasingSubsets(population),\n",
        "            ShowCreation(lines[0])\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        pop_group = VGroup(population, pop_title)\n",
        "\n",
        "        # Positive result\n",
        "        clipboard = SVGMobject(\"clipboard\")\n",
        "        clipboard.set_stroke(width=0)\n",
        "        clipboard.set_fill(interpolate_color(GREY_BROWN, WHITE, 0.5), 1)\n",
        "        clipboard.set_width(2.5)\n",
        "        clipboard.move_to(population)\n",
        "        clipboard.to_edge(UP)\n",
        "\n",
        "        result = OldTexText(\n",
        "            \"+\\\\\\\\\",\n",
        "            \"SARS\\\\\\\\CoV-2\\\\\\\\\",\n",
        "            \"Detected\"\n",
        "        )\n",
        "        result[0].scale(1.5, about_edge=DOWN)\n",
        "        result[0].set_fill(GREEN)\n",
        "        result[0].set_stroke(GREEN, 2)\n",
        "        result[-1].set_fill(GREEN)\n",
        "        result.set_width(clipboard.get_width() * 0.7)\n",
        "        result.move_to(clipboard)\n",
        "        result.shift(0.2 * DOWN)\n",
        "        clipboard.add(result)\n",
        "\n",
        "        self.play(\n",
        "            pop_group.scale, 0.4,\n",
        "            pop_group.to_edge, DOWN,\n",
        "            FadeIn(clipboard, DOWN),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # FPR, FRN\n",
        "        self.play(ShowCreation(lines[1]))\n",
        "        self.wait()\n",
        "        self.play(ShowCreation(lines[2]))\n",
        "        self.wait()\n",
        "\n",
        "        # Answer choices\n",
        "        rect = rects[0].copy()\n",
        "        self.play(DrawBorderThenFill(rect))\n",
        "        self.wait()\n",
        "        for r2 in rects[1:]:\n",
        "            self.play(Transform(rect, r2))\n",
        "            self.wait()\n",
        "        self.play(FadeOut(rect))\n",
        "\n",
        "        # Focus on FPR\n",
        "        rect = Rectangle()\n",
        "        rect.match_width(lines[1])\n",
        "        rect.scale(1.02)\n",
        "        rect.set_height(0.4, stretch=True)\n",
        "        rect.match_style(lines[1])\n",
        "        rect.move_to(lines[1], DOWN)\n",
        "        rect.set_fill(RED, 0.2)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(lines[0]),\n",
        "            FadeOut(lines[2]),\n",
        "            DrawBorderThenFill(rect)\n",
        "        )\n",
        "\n",
        "        # Randy\n",
        "        randy = Randolph(height=2)\n",
        "        randy.flip()\n",
        "        randy.next_to(tweet, RIGHT, LARGE_BUFF, DOWN)\n",
        "\n",
        "        bubble = randy.get_bubble(height=3, width=3, direction=RIGHT)\n",
        "        bubble.flip()\n",
        "        bubble.write(\"99\\\\%\\\\\\\\right?\")\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(randy),\n",
        "            FadeOut(clipboard, RIGHT),\n",
        "            FadeOut(pop_group, 0.5 * RIGHT),\n",
        "        )\n",
        "        self.play(\n",
        "            randy.change, \"maybe\",\n",
        "            DrawBorderThenFill(bubble),\n",
        "            Write(bubble.content),\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class DisambiguateFPR(Scene):\n",
        "    def construct(self):\n",
        "        # Add title\n",
        "        title = OldTexText(\n",
        "            \"1\\\\% False Positive Rate\",\n",
        "            isolate=[\"F\", \"P\", \"R\"],\n",
        "            font_size=72\n",
        "        )\n",
        "        title.to_edge(UP)\n",
        "        title.set_color(GREY_A)\n",
        "        underline = Underline(title)\n",
        "        underline.match_color(title)\n",
        "\n",
        "        morty = Mortimer()\n",
        "        morty.to_corner(DR)\n",
        "        morty.look_at(title)\n",
        "\n",
        "        self.add(title)\n",
        "        self.play(\n",
        "            PiCreatureSays(\n",
        "                morty,\n",
        "                \"It's a confusing term!\",\n",
        "                target_mode=\"surprised\",\n",
        "                run_time=1,\n",
        "            )\n",
        "        )\n",
        "        self.play(\n",
        "            Blink(morty),\n",
        "            ShowCreation(underline),\n",
        "        )\n",
        "        self.play(morty.change, \"angry\")\n",
        "        self.play(Blink(morty))\n",
        "\n",
        "        # Draw out grid\n",
        "        word_grid = VGroup(\n",
        "            OldTexText(\"True positives\", color=GREEN),\n",
        "            OldTexText(\"False negatives\", color=RED_E),\n",
        "            OldTexText(\"False positives\", color=GREEN_D),\n",
        "            OldTexText(\"True negatives\", color=RED),\n",
        "        )\n",
        "        word_box = SurroundingRectangle(word_grid)\n",
        "        word_box.set_stroke(WHITE, 2)\n",
        "        word_box.stretch(2, 1)\n",
        "\n",
        "        word_grid.arrange_in_grid(\n",
        "            v_buff=1.0,\n",
        "            h_buff=0.5,\n",
        "            fill_rows_first=False\n",
        "        )\n",
        "        word_grid.move_to(2 * DOWN)\n",
        "\n",
        "        globals()['word_box'] = word_box\n",
        "        word_boxes = VGroup(*(\n",
        "            word_box.copy().move_to(word).match_color(word)\n",
        "            for word in word_grid\n",
        "        ))\n",
        "\n",
        "        group_boxes = VGroup(\n",
        "            SurroundingRectangle(word_boxes[:2], color=YELLOW),\n",
        "            SurroundingRectangle(word_boxes[2:], color=GREY_B),\n",
        "        )\n",
        "        group_titles = VGroup(\n",
        "            OldTexText(\"Have COVID-19\", font_size=36),\n",
        "            OldTexText(\"Don't have COVID-19\", font_size=36),\n",
        "        )\n",
        "        for box, gt in zip(group_boxes, group_titles):\n",
        "            gt.next_to(box, UP)\n",
        "            gt.match_color(box)\n",
        "\n",
        "        icon = SVGMobject(\"person\", stroke_width=0, fill_color=GREY_B)\n",
        "        globals()['icon'] = icon\n",
        "        with_pop = VGroup(*(icon.copy() for x in range(1)))\n",
        "        with_pop.set_color(YELLOW)\n",
        "        without_pop = VGroup(*(icon.copy() for x in range(999)))\n",
        "\n",
        "        with_pop.set_height(0.5)\n",
        "        with_pop.move_to(group_boxes[0])\n",
        "        without_pop.arrange_in_grid(n_rows=20)\n",
        "        without_pop.replace(group_boxes[1], dim_to_match=1)\n",
        "        without_pop.scale(0.9)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(group_boxes, lag_ratio=0.3),\n",
        "            DrawBorderThenFill(with_pop),\n",
        "            ShowIncreasingSubsets(without_pop),\n",
        "            FadeIn(group_titles, lag_ratio=0.3),\n",
        "            FadeOut(morty),\n",
        "            FadeOut(morty.bubble),\n",
        "            FadeOut(morty.bubble.content),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        arrow = Vector(DOWN)\n",
        "        arrow.next_to(group_titles[1], UP)\n",
        "        self.play(GrowArrow(arrow))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            LaggedStartMap(Write, word_grid[2:], lag_ratio=0.9),\n",
        "            LaggedStartMap(ShowCreation, word_boxes[2:], lag_ratio=0.9),\n",
        "            without_pop.set_opacity, 0.3,\n",
        "            run_time=1,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Two reasonable fractions\n",
        "        tp, fn, fp, tn = (\n",
        "            word\n",
        "            for word, box in zip(word_grid, word_boxes)\n",
        "        )\n",
        "\n",
        "        def create_fraction(m1, m2, scale_factor=0.75):\n",
        "            result = VGroup(\n",
        "                m1.copy(),\n",
        "                OldTex(\"\\\\quad \\\\over \\\\quad\"),\n",
        "                m1.copy(),\n",
        "                OldTex(\"+\"),\n",
        "                m2.copy()\n",
        "            )\n",
        "            result[0::2].scale(scale_factor)\n",
        "            result[2:].arrange(RIGHT, buff=SMALL_BUFF)\n",
        "            result[1].match_width(result[2:], stretch=True)\n",
        "            result[1].next_to(result[2:], UP, SMALL_BUFF)\n",
        "            result[0].next_to(result[1], UP, SMALL_BUFF)\n",
        "            return result\n",
        "\n",
        "        def fraction_anims(m1, m2, fraction):\n",
        "            return [\n",
        "                TransformFromCopy(m1, fraction[0]),\n",
        "                TransformFromCopy(m1, fraction[2]),\n",
        "                TransformFromCopy(m2, fraction[4]),\n",
        "                GrowFromPoint(\n",
        "                    fraction[1],\n",
        "                    VGroup(m1, m2).get_center(),\n",
        "                ),\n",
        "                GrowFromPoint(\n",
        "                    fraction[3],\n",
        "                    VGroup(m1, m2).get_center(),\n",
        "                ),\n",
        "            ]\n",
        "\n",
        "        frac1 = create_fraction(fp, tp)\n",
        "        frac2 = create_fraction(fp, tn)\n",
        "        fracs = VGroup(frac1, frac2)\n",
        "        fracs.arrange(RIGHT, buff=3)\n",
        "        fracs.to_edge(UP, buff=1.5)\n",
        "\n",
        "        title.add(underline)\n",
        "        fpr = OldTexText(\n",
        "            \"1\\\\% \", \"F\", \"\", \"P\", \"\", \"R\", \"\",\n",
        "            font_size=72\n",
        "        )\n",
        "        fpr.add(Underline(fpr))\n",
        "        fpr[-1].set_width(0)\n",
        "        fpr.match_style(title)\n",
        "        fpr.next_to(frac2, UP, MED_LARGE_BUFF)\n",
        "\n",
        "        frac2.save_state()\n",
        "        frac2.set_x(0)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(arrow),\n",
        "            LaggedStart(*fraction_anims(fp, tn, frac2))\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        self.play(\n",
        "            ReplacementTransform(title, fpr),\n",
        "            Restore(frac2)\n",
        "        )\n",
        "        self.play(\n",
        "            LaggedStartMap(Write, word_grid[:2], lag_ratio=0),\n",
        "            LaggedStartMap(ShowCreation, word_boxes[:2], lag_ratio=0),\n",
        "            with_pop.set_opacity, 0.2,\n",
        "            run_time=1,\n",
        "        )\n",
        "        self.play(\n",
        "            LaggedStart(*fraction_anims(fp, tp, frac1)),\n",
        "            fn.set_opacity, 0.5,\n",
        "            tn.set_opacity, 0.5,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        comment = OldTexText(\"What we actually want\")\n",
        "        comment.next_to(frac1, UP, buff=0.75)\n",
        "\n",
        "        self.play(FadeIn(comment, 0.5 * UP))\n",
        "        self.wait()\n",
        "\n",
        "        # Prep for Bayes calculation\n",
        "        right_brace = Brace(word_boxes[2], RIGHT, buff=SMALL_BUFF)\n",
        "        left_brace = Brace(word_boxes[1], LEFT, buff=SMALL_BUFF)\n",
        "        fpr.generate_target()\n",
        "        fpr.target.scale(48 / 72)\n",
        "        fpr.target.next_to(right_brace, RIGHT)\n",
        "        fnr = OldTexText(\"10\\\\% FNR\")\n",
        "        fnr.next_to(left_brace, LEFT)\n",
        "        VGroup(left_brace, right_brace, fnr).set_color(GREY_A)\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(fpr),\n",
        "            GrowFromCenter(left_brace),\n",
        "            GrowFromCenter(right_brace),\n",
        "            FadeIn(fnr),\n",
        "            FadeOut(comment),\n",
        "            FadeOut(fracs),\n",
        "            fn.set_opacity, 1.0,\n",
        "            tn.set_opacity, 1.0,\n",
        "        )\n",
        "\n",
        "        prior_title = OldTexText(\"Prior: 1 in 1,000\", font_size=72)\n",
        "        prior_title.to_edge(UP)\n",
        "        self.play(FadeIn(prior_title, UP))\n",
        "        self.wait()\n",
        "\n",
        "        # Show population counts\n",
        "        full_pop = VGroup(\n",
        "            OldTexText(\"Imagine\"),\n",
        "            Integer(10000),\n",
        "            OldTexText(\"People\")\n",
        "        )\n",
        "        full_pop.arrange(RIGHT, aligned_edge=DOWN)\n",
        "        full_pop.set_color(GREY_A)\n",
        "        full_pop.next_to(prior_title, DOWN, MED_LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(full_pop[0::2]),\n",
        "            CountInFrom(full_pop[1], 0),\n",
        "            FadeOut(with_pop),\n",
        "            FadeOut(without_pop),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        def move_number_above_word(number, word, target_count, buff=MED_SMALL_BUFF, scene=self):\n",
        "            mover = number.copy()\n",
        "            mover.original_bottom = mover.get_bottom()\n",
        "            start_count = number.get_value()\n",
        "            scene.play(\n",
        "                UpdateFromAlphaFunc(\n",
        "                    mover,\n",
        "                    lambda m, a, word=word, sc=start_count, tc=target_count, buff=buff: m.set_color(\n",
        "                        interpolate_color(GREY_A, word.get_color(), a)\n",
        "                    ).set_value(\n",
        "                        interpolate(sc, tc, a),\n",
        "                    ).move_to(\n",
        "                        interpolate(\n",
        "                            m.original_bottom,\n",
        "                            word.get_top() + buff * UP,\n",
        "                            a\n",
        "                        ),\n",
        "                        DOWN,\n",
        "                    )\n",
        "                )\n",
        "            )\n",
        "            return mover\n",
        "\n",
        "        with_count = move_number_above_word(full_pop[1], group_titles[0], 10, buff=0.3)\n",
        "        self.wait()\n",
        "        without_count = move_number_above_word(full_pop[1], group_titles[1], 9990)\n",
        "        self.wait()\n",
        "\n",
        "        self.play(word_grid.shift, 0.25 * DOWN)\n",
        "        tp_count = move_number_above_word(with_count, word_grid[0], 9, SMALL_BUFF)\n",
        "        fn_count = move_number_above_word(with_count, word_grid[1], 1, SMALL_BUFF)\n",
        "        self.wait()\n",
        "        fp_count = move_number_above_word(without_count, word_grid[2], 100, SMALL_BUFF)\n",
        "        tn_count = move_number_above_word(without_count, word_grid[3], 9890, buff=0.05)\n",
        "        self.wait()\n",
        "\n",
        "        faders = VGroup(\n",
        "            with_count, without_count,\n",
        "            group_titles,\n",
        "            fpr, fnr,\n",
        "            fn, tn, fn_count, tn_count,\n",
        "        )\n",
        "        braces = VGroup(left_brace, right_brace)\n",
        "        self.play(faders.set_opacity, 0.3, FadeOut(braces))\n",
        "        self.wait()\n",
        "\n",
        "        # Show posterior\n",
        "        prior_group = VGroup(prior_title, full_pop)\n",
        "        prior_group.generate_target()\n",
        "        prior_group.target.to_edge(LEFT)\n",
        "        prior_group.target.shift(0.5 * DOWN)\n",
        "\n",
        "        arrow = Vector(0.8 * RIGHT)\n",
        "        arrow.next_to(prior_group.target[0], RIGHT)\n",
        "\n",
        "        post_word = OldTexText(\"Posterior:\", font_size=72)\n",
        "        post_word.set_color(BLUE)\n",
        "        post_word.next_to(arrow, RIGHT)\n",
        "        post_word.align_to(prior_group.target[0][0][0], DOWN)\n",
        "        post_frac = create_fraction(tp_count, fp_count, scale_factor=1)\n",
        "        post_frac.next_to(post_word, RIGHT, MED_LARGE_BUFF)\n",
        "\n",
        "        rhs = OldTex(\"\\\\approx\", \"8.3\\\\%\")\n",
        "        rhs.next_to(post_frac, RIGHT)\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(prior_group),\n",
        "            GrowArrow(arrow),\n",
        "            Write(post_word, run_time=1),\n",
        "        )\n",
        "        self.play(*fraction_anims(tp_count, fp_count, post_frac))\n",
        "        self.wait()\n",
        "        self.play(Write(rhs))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class BayesFactorForCovidExample(Scene):\n",
        "    def construct(self):\n",
        "        # Titles\n",
        "        titles = VGroup(\n",
        "            OldTexText(\"Prior odds\", color=YELLOW),\n",
        "            OldTexText(\"Bayes factor\", color=GREEN),\n",
        "            OldTexText(\"Posterior odds\", color=BLUE),\n",
        "        )\n",
        "        titles.scale(1.25)\n",
        "        titles[0].shift(FRAME_WIDTH * LEFT / 3)\n",
        "        titles[2].shift(FRAME_WIDTH * RIGHT / 3)\n",
        "        titles.to_edge(UP)\n",
        "\n",
        "        v_lines = VGroup(*(\n",
        "            Line(UP, DOWN).set_height(FRAME_HEIGHT).move_to(\n",
        "                FRAME_WIDTH * x * RIGHT / 6,\n",
        "            )\n",
        "            for x in (-1, 1)\n",
        "        ))\n",
        "        self.add(titles, v_lines)\n",
        "\n",
        "        # Prior odds\n",
        "        prior_odds = OldTexText(\n",
        "            \"1\", \"\\\\,:\\\\,\", \"999\",\n",
        "            tex_to_color_map={\"1\": YELLOW}\n",
        "        )\n",
        "        prior_odds.next_to(titles[0], DOWN, buff=1)\n",
        "\n",
        "        population = Population(1000)\n",
        "        population.set_width(FRAME_WIDTH / 5)\n",
        "        population[0].set_color(YELLOW)\n",
        "        population[0].next_to(population[1:], LEFT, MED_LARGE_BUFF)\n",
        "        colon = OldTex(\":\")\n",
        "        colon.move_to(midpoint(population[0].get_right(), population[1:].get_left()))\n",
        "        pop_ratio = VGroup(population[0], colon, population[1:])\n",
        "        pop_ratio.next_to(prior_odds, DOWN, MED_LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(prior_odds, shift=0.2 * DOWN, scale=1.2),\n",
        "            FadeIn(pop_ratio, lag_ratio=0.01),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Bayes factor\n",
        "        bf_lhs = OldTex(\n",
        "            \"\"\"\n",
        "            {\n",
        "                P(+ \\\\,|\\\\, \\\\text{COVID})\n",
        "                \\\\over\n",
        "                P(+ \\\\,|\\\\, \\\\text{No COVID})\n",
        "            }\n",
        "            \"\"\",\n",
        "            tex_to_color_map={\n",
        "                \"+\": GREEN,\n",
        "                \"\\\\text{COVID}\": YELLOW,\n",
        "                \"\\\\text{No COVID}\": GREY_A,\n",
        "            }\n",
        "        )\n",
        "        bf_lhs.next_to(titles[1], DOWN)\n",
        "        bf_rhs = OldTex(\n",
        "            \"= {90\\\\%\", \"\\\\over\", \"1\\\\%}\",\n",
        "            tex_to_color_map={\n",
        "                \"90\\\\%\": GREEN_D,\n",
        "                \"1\\\\%\": GREEN,\n",
        "            }\n",
        "        )\n",
        "        bf = VGroup(bf_lhs, bf_rhs)\n",
        "        bf.arrange(RIGHT)\n",
        "        bf.set_width(0.9 * FRAME_WIDTH / 3)\n",
        "        bf.next_to(titles[1], DOWN, MED_LARGE_BUFF)\n",
        "\n",
        "        eq_90 = OldTex(\"=\", \"90\")\n",
        "        eq_90.next_to(bf, DOWN, MED_LARGE_BUFF)\n",
        "        eq_90[1].save_state()\n",
        "        eq_90[1].replace(bf_rhs[1:], stretch=True)\n",
        "        eq_90[1].set_opacity(0)\n",
        "        eq_90[1].set_color(GREEN)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(bf_lhs, lag_ratio=0.1),\n",
        "            FadeIn(bf_rhs[0::2], lag_ratio=0.1),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(Write(bf_rhs[1]))\n",
        "        self.wait()\n",
        "        self.play(Write(bf_rhs[3]))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(bf_rhs[0], eq_90[0]),\n",
        "            Restore(eq_90[1])\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Posterior\n",
        "        post_odds = OldTex(\"90\", \":\", \"999\")\n",
        "        post_odds.match_x(titles[2])\n",
        "        post_odds.match_y(prior_odds)\n",
        "\n",
        "        arrow = Vector(DOWN)\n",
        "        arrow.next_to(post_odds, DOWN)\n",
        "\n",
        "        fraction = OldTex(\n",
        "            \"{90\", \"\\\\over\", \"90\", \"+\", \"999}\",\n",
        "            \"\\\\approx\", \"8.3\\\\%\"\n",
        "        )\n",
        "        fraction.next_to(arrow, DOWN)\n",
        "\n",
        "        self.play(LaggedStart(\n",
        "            TransformFromCopy(eq_90[1], post_odds[0]),\n",
        "            TransformFromCopy(prior_odds[1:], post_odds[1:]),\n",
        "            lag_ratio=0.4\n",
        "        ))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            GrowArrow(arrow),\n",
        "            FadeIn(fraction, DOWN)\n",
        "        )\n",
        "\n",
        "        # Approximate\n",
        "        approx1 = OldTex(\"\\\\approx\", \"90\", \":\", \"1,000\")\n",
        "        approx2 = OldTex(\"\\\\approx\", \"9\", \":\", \"100\")\n",
        "        approx3 = OldTex(\"\\\\approx 9\\\\%\")\n",
        "\n",
        "        approx1.next_to(arrow, DOWN)\n",
        "        approx2.move_to(approx1)\n",
        "        arrow2 = arrow.copy()\n",
        "        arrow2.next_to(approx2, DOWN)\n",
        "        approx3.next_to(arrow2, DOWN)\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(fraction, 0.5 * DOWN),\n",
        "            FadeIn(approx1, 0.5 * DOWN),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            ReplacementTransform(approx1, approx2)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            GrowArrow(arrow2),\n",
        "            FadeIn(approx3, DOWN)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class WhyIsThisWrong(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Ask question\n",
        "        tweet = ImageMobject(\"twitter_covid_test_poll\")\n",
        "        tweet.replace(self.screen, dim_to_match=0)\n",
        "        tweet.to_edge(UP)\n",
        "        tweet.scale(0.9, about_edge=UP)\n",
        "\n",
        "        self.add(tweet)\n",
        "        self.student_says(\n",
        "            \"Bayes' rule says\\\\\\\\ 8.5\\\\%, right?\",\n",
        "            target_mode=\"hooray\",\n",
        "            index=1,\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            PiCreatureSays(\n",
        "                self.teacher,\n",
        "                \"Well...\",\n",
        "                bubble_config={\"height\": 2, \"width\": 2},\n",
        "                target_mode=\"hesitant\",\n",
        "            ),\n",
        "            self.change_students(\"confused\", \"erm\", \"pondering\")\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "        # Highlight symptoms\n",
        "        self.play(\n",
        "            RemovePiCreatureBubble(self.students[1]),\n",
        "            RemovePiCreatureBubble(self.teacher, target_mode=\"raise_right_hand\"),\n",
        "            tweet.move_to, self.hold_up_spot, DR,\n",
        "            tweet.shift, RIGHT,\n",
        "        )\n",
        "\n",
        "        underline = Line((-1.3, 2.65), (2.1, 2.65))\n",
        "        underline.shift(RIGHT)\n",
        "        underline.set_stroke(RED, 3)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(underline),\n",
        "            self.teacher.look_at, underline,\n",
        "            *(ApplyMethod(pi.change, \"pondering\", underline) for pi in self.students),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Change prior\n",
        "        ineq = OldTexText(\"Prior > $\\\\frac{1}{1,000}$\", font_size=72)\n",
        "        ineq.next_to(tweet, LEFT, LARGE_BUFF)\n",
        "\n",
        "        self.play(Write(ineq))\n",
        "        self.look_at(ineq)\n",
        "        self.wait()\n",
        "\n",
        "        # More severe symptoms\n",
        "        for pi in self.students:\n",
        "            pi.generate_target()\n",
        "            pi.target.change(\"sick\")\n",
        "            pi.target.set_color(SICKLY_GREEN)\n",
        "            pi.target.look(DR)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(MoveToTarget, self.students, lag_ratio=0.3),\n",
        "            self.teacher.change, \"erm\"\n",
        "        )\n",
        "\n",
        "        clipboard = get_covid_clipboard()\n",
        "        clipboard.to_corner(UL)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(clipboard, UP),\n",
        "            FadeOut(ineq, UP),\n",
        "            *(ApplyMethod(pi.look_at, clipboard) for pi in self.pi_creatures),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        percent = OldTex(\"8.3 \\\\%\", font_size=72)\n",
        "        percent.next_to(clipboard, RIGHT, buff=0.6)\n",
        "        percent_cross = Cross(percent, stroke_width=8)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(percent),\n",
        "            self.teacher.change, \"tease\"\n",
        "        )\n",
        "        self.play(ShowCreation(percent_cross))\n",
        "        self.wait()\n",
        "\n",
        "        self.student_says(\n",
        "            \"What's the appropriate\\\\\\\\math here?\",\n",
        "            index=1,\n",
        "            added_anims=[\n",
        "                FadeOut(tweet),\n",
        "                FadeOut(underline),\n",
        "                self.teacher.change, \"happy\"\n",
        "            ]\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "\n",
        "class TotalPopulationVsSymptomatic(Scene):\n",
        "    def construct(self):\n",
        "        # Titles\n",
        "        v_line = Line(UP, DOWN).set_height(2 * FRAME_HEIGHT)\n",
        "        v_line.to_edge(UP)\n",
        "        self.add(v_line)\n",
        "\n",
        "        titles = VGroup(\n",
        "            OldTexText(\"Population\"),\n",
        "            OldTexText(\"Population\", \" \\\\emph{with symptoms}\"),\n",
        "        )\n",
        "        titles[1][1].set_color(BLUE)\n",
        "        for title, u in zip(titles, [-1, 1]):\n",
        "            title.move_to(u * RIGHT * FRAME_WIDTH / 4)\n",
        "        titles.to_edge(UP)\n",
        "\n",
        "        self.add(titles[0])\n",
        "\n",
        "        # Actual populations\n",
        "        full_pop = VGroup(*(Dot() for x in range(10000)))\n",
        "        full_pop.arrange_in_grid(\n",
        "            buff=full_pop[0].get_width()\n",
        "        )\n",
        "        full_pop.set_width(FRAME_WIDTH / 2 - 1)\n",
        "        full_pop.next_to(titles[0], DOWN)\n",
        "        full_pop.to_edge(DOWN, buff=SMALL_BUFF)\n",
        "        covid_pop = full_pop[:10]\n",
        "        covid_pop.set_fill(YELLOW)\n",
        "        covid_pop.save_state()\n",
        "        covid_pop.scale(8, about_edge=UL)\n",
        "        covid_pop.shift(DOWN)\n",
        "\n",
        "        full_pop_words = VGroup(\n",
        "            OldTexText(\"10 \", \"with COVID\", color=YELLOW),\n",
        "            OldTexText(\"9990 \", \"without COVID\", color=GREY_B),\n",
        "        )\n",
        "        full_pop_words.arrange(RIGHT, buff=LARGE_BUFF)\n",
        "        full_pop_words.scale(0.7)\n",
        "        full_pop_words.next_to(full_pop, UP, SMALL_BUFF, LEFT)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(full_pop_words[0]),\n",
        "            Write(covid_pop),\n",
        "            run_time=1\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(full_pop_words[1]),\n",
        "            ShowIncreasingSubsets(full_pop[10:]),\n",
        "            Restore(covid_pop),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Mention symptoms\n",
        "        self.play(\n",
        "            TransformFromCopy(titles[0][0], titles[1][0]),\n",
        "            FadeInFromPoint(titles[1][1], titles[0].get_center()),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        arrow = Vector(DOWN).next_to(titles[1][1], DOWN)\n",
        "        arrow.set_color(BLUE)\n",
        "        prop_ex = OldTex(\"\\\\sim \\\\frac{1}{50}\", \"\\\\text{, say}\")\n",
        "        prop_ex[0].set_color(BLUE)\n",
        "        prop_ex.next_to(arrow, DOWN)\n",
        "\n",
        "        self.play(\n",
        "            GrowArrow(arrow),\n",
        "            FadeIn(prop_ex, DOWN)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Symptomatic population\n",
        "        left_sym_pop = VGroup(*random.sample(list(full_pop[10:]), 200))\n",
        "        sym_pop = left_sym_pop.copy()\n",
        "        sym_pop.generate_target()\n",
        "        buff = get_norm(full_pop[1].get_left() - full_pop[0].get_right())\n",
        "        sym_pop.target.arrange_in_grid(buff=buff)\n",
        "        sym_pop.target.set_width(3.5)\n",
        "        sym_pop.target.match_x(titles[1])\n",
        "        sym_pop.target.align_to(full_pop, UP)\n",
        "        sym_pop.target.shift(DOWN)\n",
        "        sym_pop.target.set_color(BLUE)\n",
        "\n",
        "        sym_pop_label = OldTexText(\"$\\\\sim 200$\", \" without COVID\")\n",
        "        sym_pop_label.set_color(GREY_B)\n",
        "        sym_pop_label.scale(0.7)\n",
        "        sym_pop_label.next_to(sym_pop.target, UP, buff=0.2)\n",
        "\n",
        "        self.play(\n",
        "            sym_pop.set_color, BLUE,\n",
        "            MoveToTarget(sym_pop, lag_ratio=0.01, run_time=2),\n",
        "            prop_ex.to_edge, DOWN,\n",
        "            FadeOut(arrow),\n",
        "            Write(sym_pop_label),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        sym_covid_pop = covid_pop[:5].copy()\n",
        "        sym_covid_pop.generate_target()\n",
        "        sym_covid_pop.target.arrange(DOWN, buff=buff)\n",
        "        sym_covid_pop.target.scale(\n",
        "            sym_pop[0].get_height() / sym_covid_pop[0].get_height()\n",
        "        )\n",
        "        sym_covid_pop.target.next_to(sym_pop, LEFT, aligned_edge=UP)\n",
        "\n",
        "        sym_covid_pop_label = OldTexText(\"5\", \" with COVID\")\n",
        "        sym_covid_pop_label.scale(0.7)\n",
        "        sym_covid_pop_label.next_to(sym_covid_pop.target, UP, buff=0.2)\n",
        "        sym_covid_pop_label.set_color(YELLOW)\n",
        "\n",
        "        self.play(ShowCreationThenFadeAround(sym_pop_label))\n",
        "        self.play(\n",
        "            VGroup(sym_pop, sym_pop_label).to_edge, RIGHT,\n",
        "            MoveToTarget(sym_covid_pop),\n",
        "            FadeIn(sym_covid_pop_label),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Apply test\n",
        "        left_movers = VGroup(\n",
        "            full_pop, full_pop_words,\n",
        "            titles[0], v_line,\n",
        "        )\n",
        "        right_movers = VGroup(\n",
        "            titles[1],\n",
        "            sym_covid_pop, sym_covid_pop_label,\n",
        "            sym_pop, sym_pop_label,\n",
        "        )\n",
        "        v_line_copy = v_line.copy()\n",
        "\n",
        "        left_vect = (FRAME_WIDTH + SMALL_BUFF) * LEFT / 2\n",
        "        self.play(\n",
        "            LaggedStartMap(\n",
        "                ApplyMethod, left_movers,\n",
        "                lambda m: (m.shift, left_vect),\n",
        "                lag_ratio=0.05,\n",
        "            ),\n",
        "            ApplyMethod(\n",
        "                right_movers.shift, left_vect,\n",
        "                rate_func=squish_rate_func(smooth, 0.3, 1),\n",
        "            ),\n",
        "            FadeOut(prop_ex),\n",
        "            run_time=2,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # With test result\n",
        "        right_title = OldTexText(\n",
        "            \"Population \", \"\\\\emph{with symptoms}\\\\\\\\\",\n",
        "            \"and a positive test result\"\n",
        "        )\n",
        "        right_title.set_color_by_tex(\"symptoms\", BLUE)\n",
        "        right_title.set_color_by_tex(\"positive\", GREEN)\n",
        "        right_title.set_x(FRAME_WIDTH / 4)\n",
        "        right_title.to_edge(UP)\n",
        "        titles.add(right_title)\n",
        "\n",
        "        self.play(\n",
        "            ShowCreation(v_line_copy),\n",
        "            FadeIn(right_title),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        right_vect = FRAME_WIDTH * RIGHT / 2\n",
        "\n",
        "        pc_pop = sym_covid_pop.copy()\n",
        "        pn_pop = VGroup(*random.sample(list(sym_pop), 2)).copy()\n",
        "\n",
        "        pn_pop.generate_target()\n",
        "        buff = get_norm(sym_pop[1].get_left() - sym_pop[0].get_right())\n",
        "        pn_pop.target.arrange(DOWN, buff=buff)\n",
        "        pn_pop.target.next_to(sym_pop_label, DOWN)\n",
        "        pn_pop.target.shift(right_vect)\n",
        "        pn_pop.target.scale(1.5, about_edge=UP)\n",
        "\n",
        "        black_rect = BackgroundRectangle(pc_pop[-1], fill_opacity=1)\n",
        "        black_rect.stretch(0.5, 1, about_edge=DOWN)\n",
        "        pc_pop.add(black_rect)\n",
        "        pc_pop.set_opacity(0)\n",
        "\n",
        "        pc_pop_label = OldTexText(\"4.5 with COVID\", color=YELLOW)\n",
        "        pn_pop_label = OldTexText(\"~2 without COVID\", color=GREY_B)\n",
        "        labels = VGroup(pc_pop_label, pn_pop_label)\n",
        "        labels.scale(0.7)\n",
        "        labels.set_opacity(0)\n",
        "\n",
        "        pc_pop_label.move_to(sym_covid_pop_label)\n",
        "        pn_pop_label.move_to(sym_pop_label)\n",
        "\n",
        "        def get_test_rects(mob):\n",
        "            return VGroup(*(\n",
        "                SurroundingRectangle(\n",
        "                    part,\n",
        "                    color=GREEN,\n",
        "                    buff=buff / 2,\n",
        "                    stroke_width=2,\n",
        "                )\n",
        "                for part in mob\n",
        "            ))\n",
        "\n",
        "        self.play(\n",
        "            pc_pop_label.shift, right_vect,\n",
        "            pc_pop_label.set_opacity, 1,\n",
        "            pc_pop.shift, right_vect,\n",
        "            pc_pop.set_opacity, 1,\n",
        "            pc_pop.scale, 1.5, {\"about_edge\": UP}\n",
        "        )\n",
        "        pc_pop_rects = get_test_rects(pc_pop[:5])\n",
        "        self.play(FadeIn(pc_pop_rects, lag_ratio=0.3))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            pn_pop_label.shift, right_vect,\n",
        "            pn_pop_label.set_opacity, 1,\n",
        "            MoveToTarget(pn_pop),\n",
        "        )\n",
        "        pn_pop_rects = get_test_rects(pn_pop)\n",
        "        self.play(FadeIn(pn_pop_rects, lag_ratio=0.3))\n",
        "        self.wait()\n",
        "\n",
        "        # Final fraction\n",
        "        equation = OldTex(\n",
        "            \"{4.5 \\\\over 4.5 + {2}} \\\\approx 69.2\\\\%\",\n",
        "            tex_to_color_map={\n",
        "                \"4.5\": YELLOW,\n",
        "                \"{2}\": GREY_B,\n",
        "            }\n",
        "        )\n",
        "        equation.move_to(FRAME_WIDTH * RIGHT / 4)\n",
        "        equation.to_edge(DOWN, buff=LARGE_BUFF)\n",
        "\n",
        "        self.play(FadeIn(equation, lag_ratio=0.1))\n",
        "        self.wait()\n",
        "\n",
        "        # Zoom out\n",
        "        frame = self.camera.frame\n",
        "\n",
        "        self.play(\n",
        "            frame.scale, 1.5, {\"about_edge\": UR},\n",
        "            run_time=3,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Prepare population groups to move\n",
        "        pop_groups = VGroup(\n",
        "            VGroup(\n",
        "                full_pop, full_pop_words,\n",
        "            ),\n",
        "            VGroup(\n",
        "                sym_covid_pop, sym_covid_pop_label,\n",
        "                sym_pop, sym_pop_label,\n",
        "            ),\n",
        "            VGroup(\n",
        "                pc_pop, pc_pop_label, pc_pop_rects,\n",
        "                pn_pop, pn_pop_label, pn_pop_rects,\n",
        "                equation\n",
        "            ),\n",
        "        )\n",
        "        pop_groups.generate_target()\n",
        "        for group in pop_groups.target:\n",
        "            group.scale(0.5, about_edge=DOWN)\n",
        "            group.shift(4.5 * DOWN)\n",
        "\n",
        "        pop_groups.target[0][0].set_opacity(0.5)\n",
        "\n",
        "        h_line = Line(pop_groups.get_left(), pop_groups.get_right())\n",
        "        h_line.next_to(pop_groups.target, UP)\n",
        "        h_line.set_stroke(WHITE, 1)\n",
        "\n",
        "        # Relevant odds labels\n",
        "        def get_odds_label(n, k, n_color=YELLOW, k_color=GREY_B):\n",
        "            result = VGroup(\n",
        "                OldTexText(\"Odds = \"),\n",
        "                Integer(n, color=n_color, edge_to_fix=UR),\n",
        "                OldTexText(\":\"),\n",
        "                Integer(k, color=k_color, edge_to_fix=UL),\n",
        "            )\n",
        "            result.scale(1.5)\n",
        "            result.arrange(RIGHT, buff=0.25)\n",
        "            result[3].align_to(result[1], UP)\n",
        "            return result\n",
        "\n",
        "        odds_labels = VGroup(\n",
        "            get_odds_label(1, 999),\n",
        "            get_odds_label(25, 1000),\n",
        "            get_odds_label(40, 90),\n",
        "        )\n",
        "        for label, title in zip(odds_labels, titles):\n",
        "            label.move_to(title, UP)\n",
        "            label.shift(2 * DOWN)\n",
        "\n",
        "        odds_underlines = VGroup(*(\n",
        "            Underline(label[1:])\n",
        "            for label in odds_labels\n",
        "        ))\n",
        "        odds_arrows = VGroup(*(\n",
        "            Arrow(o1.get_right(), o2.get_left())\n",
        "            for o1, o2 in zip(odds_labels, odds_labels[1:])\n",
        "        ))\n",
        "        odds_arrows.set_fill(GREY_B)\n",
        "        for arrow in odds_arrows:\n",
        "            arrow.set_angle(0)\n",
        "\n",
        "        self.play(\n",
        "            MoveToTarget(pop_groups),\n",
        "            FadeIn(odds_labels[0]),\n",
        "            ShowCreation(h_line),\n",
        "        )\n",
        "        for i in (1, 2):\n",
        "            self.play(\n",
        "                FadeIn(odds_labels[i][0], RIGHT),\n",
        "                FadeIn(odds_underlines[i], RIGHT),\n",
        "                GrowArrow(odds_arrows[i - 1]),\n",
        "            )\n",
        "        self.wait()\n",
        "\n",
        "        # Bayes factors\n",
        "        bf_labels = VGroup(\n",
        "            OldTexText(\n",
        "                \"Bayes factor for symptoms\",\n",
        "                tex_to_color_map={\"for symptoms\": BLUE}\n",
        "            ),\n",
        "            OldTexText(\n",
        "                \"Bayes factor positive test\",\n",
        "                tex_to_color_map={\"positive test\": GREEN}\n",
        "            ),\n",
        "        )\n",
        "        for label, title in zip(bf_labels, titles[1:]):\n",
        "            label.move_to(title, UP)\n",
        "            label.shift(4.5 * DOWN)\n",
        "\n",
        "        t2c = {\n",
        "            \"\\\\text{COVID}\": YELLOW,\n",
        "            \"\\\\text{No COVID}\": GREY_B,\n",
        "            \"\\\\text{Symp}\": BLUE,\n",
        "            \"+\": GREEN,\n",
        "            \"=\": WHITE,\n",
        "        }\n",
        "        bf_equations = VGroup(\n",
        "            OldTex(\n",
        "                \"\"\"\n",
        "                {P(\\\\text{Symp} \\\\,|\\\\, \\\\text{COVID})\n",
        "                \\\\over\n",
        "                P(\\\\text{Symp} \\\\,|\\\\, \\\\text{No COVID})}\n",
        "                = {50\\\\% \\\\over 2\\\\%} = 25\n",
        "                \"\"\",\n",
        "                tex_to_color_map=t2c,\n",
        "            ),\n",
        "            OldTex(\n",
        "                \"\"\"\n",
        "                {P(+ \\\\,|\\\\, \\\\text{COVID}) \\\\over P(+ \\\\,|\\\\, \\\\text{No COVID})}\n",
        "                = {90\\\\% \\\\over 1\\\\%} = 90\n",
        "                \"\"\",\n",
        "                tex_to_color_map=t2c,\n",
        "            ),\n",
        "        )\n",
        "        for label, eq in zip(bf_labels, bf_equations):\n",
        "            eq.scale(0.75)\n",
        "            eq[-1].scale(2, about_edge=LEFT)\n",
        "            eq.next_to(label, DOWN, buff=0.75)\n",
        "\n",
        "        assumption_brace = Brace(bf_equations[0][-3:], DOWN)\n",
        "        assumption_word = OldTexText(\"Assumption\")\n",
        "        assumption_word.next_to(assumption_brace, DOWN)\n",
        "\n",
        "        self.play(\n",
        "            Write(bf_labels[0]),\n",
        "            FadeIn(bf_equations[0][:-3]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            GrowFromCenter(assumption_brace),\n",
        "            FadeIn(assumption_word, shift=0.2 * DOWN),\n",
        "            FadeIn(bf_equations[0][-3:]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(ShowCreationThenFadeOut(odds_underlines[0]))\n",
        "        new_left_odds = get_odds_label(1, 1000)[1:]\n",
        "        new_left_odds.move_to(odds_labels[0][1:], UL)\n",
        "        approx = OldTex(\"\\\\approx\", font_size=72)\n",
        "        approx.rotate(90 * DEGREES)\n",
        "        approx.next_to(odds_labels[0][1:], DOWN, buff=0.5)\n",
        "        self.play(\n",
        "            FadeIn(approx, 0.25 * DOWN),\n",
        "            odds_labels[0][1:].next_to, approx, DOWN, {\"buff\": 0.5},\n",
        "            FadeIn(new_left_odds, 0.5 * DOWN),\n",
        "            odds_arrows[0].scale, 0.7, {\"about_edge\": RIGHT},\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        curr_odds = new_left_odds.copy()\n",
        "        self.play(\n",
        "            curr_odds.move_to, odds_labels[1][1:], UR,\n",
        "            path_arc=-30 * DEGREES\n",
        "        )\n",
        "        self.play(ChangeDecimalToValue(curr_odds[0], 25))\n",
        "        self.wait()\n",
        "\n",
        "        new_odds = curr_odds.copy()\n",
        "        new_odds[0].set_value(1)\n",
        "        new_odds[2].set_value(40)\n",
        "        self.play(\n",
        "            FadeOut(curr_odds, 0.5 * UP),\n",
        "            FadeIn(new_odds, 0.5 * UP),\n",
        "        )\n",
        "        curr_odds = new_odds\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            Write(bf_labels[1]),\n",
        "            FadeIn(bf_equations[1]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        mid_odds = curr_odds.copy()\n",
        "        self.add(mid_odds)\n",
        "\n",
        "        self.play(\n",
        "            curr_odds.move_to, odds_labels[2][1:], UR,\n",
        "            path_arc=-30 * DEGREES\n",
        "        )\n",
        "        self.play(\n",
        "            ChangeDecimalToValue(curr_odds[0], 90)\n",
        "        )\n",
        "        self.wait()\n",
        "        new_odds = curr_odds.copy()\n",
        "        new_odds[0].set_value(9)\n",
        "        new_odds[2].set_value(4)\n",
        "        self.play(\n",
        "            FadeOut(curr_odds, 0.5 * UP),\n",
        "            FadeIn(new_odds, 0.5 * UP),\n",
        "        )\n",
        "        curr_odds = new_odds\n",
        "        self.wait()\n",
        "\n",
        "        # Posterior as a probability\n",
        "        final_frac = OldTex(\n",
        "            \"{{9} \\\\over {9} + {4}} \\\\approx 69.2\\\\%\",\n",
        "            tex_to_color_map={\n",
        "                \"{9}\": YELLOW,\n",
        "                \"{4}\": GREY_B,\n",
        "            }\n",
        "        )\n",
        "\n",
        "        final_frac.next_to(odds_labels[2], DOWN, buff=0.4)\n",
        "        self.play(FadeIn(final_frac, lag_ratio=0.2))\n",
        "        self.wait()\n",
        "\n",
        "        # Get rid of population\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeOut, pop_groups, shift=DOWN, lag_ratio=0.3),\n",
        "            FadeOut(h_line),\n",
        "        )\n",
        "\n",
        "        # Change symptom Bayes factor\n",
        "        old_assumption = bf_equations[0][-3:]\n",
        "        new_assumption = OldTex(\"2\")\n",
        "        new_assumption.replace(old_assumption, 1)\n",
        "        new_assumption.scale(0.8)\n",
        "        new_assumption.set_color(BLUE)\n",
        "\n",
        "        change_word = OldTexText(\"Change this\", font_size=72)\n",
        "        change_word.next_to(assumption_word, DOWN, buff=1.5)\n",
        "        change_word.shift(LEFT)\n",
        "        change_word.set_color(RED)\n",
        "        change_arrow = Arrow(change_word.get_top(), assumption_word.get_bottom())\n",
        "        change_arrow.match_color(change_word)\n",
        "\n",
        "        self.play(\n",
        "            Write(change_word, run_time=1),\n",
        "            GrowArrow(change_arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(old_assumption, shift=0.5 * UP),\n",
        "            FadeIn(new_assumption, shift=0.5 * UP),\n",
        "            assumption_brace.set_width,\n",
        "            1.5 * new_assumption.get_width(), {\"stretch\": True},\n",
        "            FadeOut(mid_odds),\n",
        "            FadeOut(curr_odds),\n",
        "            FadeOut(final_frac),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # New odds calculation\n",
        "        curr_odds = new_left_odds.copy()\n",
        "\n",
        "        self.play(\n",
        "            curr_odds.move_to, mid_odds, UP,\n",
        "            curr_odds.shift, SMALL_BUFF * RIGHT,\n",
        "            FadeOut(odds_underlines[1]),\n",
        "            path_arc=-30 * DEGREES,\n",
        "        )\n",
        "        self.play(ChangeDecimalToValue(curr_odds[2], 500))\n",
        "        self.wait()\n",
        "\n",
        "        mid_odds = curr_odds.copy()\n",
        "        self.add(mid_odds)\n",
        "\n",
        "        self.play(\n",
        "            curr_odds.move_to, odds_labels[2][1:], UR,\n",
        "            curr_odds.shift, 0.35 * RIGHT,\n",
        "            FadeOut(odds_underlines[2]),\n",
        "            path_arc=-30 * DEGREES,\n",
        "        )\n",
        "        self.play(ChangeDecimalToValue(curr_odds[0], 90))\n",
        "        self.wait()\n",
        "\n",
        "        new_odds = curr_odds.copy()\n",
        "        new_odds[0].set_value(9)\n",
        "        new_odds[2].set_value(50)\n",
        "        new_odds.move_to(curr_odds, LEFT)\n",
        "        self.play(\n",
        "            FadeIn(new_odds, shift=0.5 * UP),\n",
        "            FadeOut(curr_odds, shift=0.5 * UP),\n",
        "        )\n",
        "        curr_odds = new_odds\n",
        "        self.wait()\n",
        "\n",
        "        # Prob calculation\n",
        "        new_final_frac = OldTex(\n",
        "            \"{{9} \\\\over {9} + {50}} \\\\approx 15.3\\\\%\",\n",
        "            tex_to_color_map={\n",
        "                \"{9}\": YELLOW,\n",
        "                \"{50}\": GREY_B,\n",
        "            }\n",
        "        )\n",
        "        new_final_frac.replace(final_frac, 1)\n",
        "\n",
        "        self.play(FadeIn(new_final_frac, lag_ratio=0.3))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ContrastTextbookAndRealWorld(Scene):\n",
        "    def construct(self):\n",
        "        pass\n",
        "\n",
        "\n",
        "class TwoMissteps(Scene):\n",
        "    def construct(self):\n",
        "        words = VGroup(\n",
        "            OldTexText(\n",
        "                \"Misstep 1: \",\n",
        "                \"Fail to consider the prevalence.\"\n",
        "            ),\n",
        "            OldTexText(\n",
        "                \"Misstep 2: \",\n",
        "                \"Assume prior = prevalence\"\n",
        "            ),\n",
        "        )\n",
        "        words[0][0].set_color(YELLOW)\n",
        "        words[1][0].set_color(BLUE)\n",
        "        words.scale(1.5)\n",
        "        words.arrange(DOWN, buff=1, aligned_edge=LEFT)\n",
        "        words.to_edge(LEFT)\n",
        "\n",
        "        self.add(words)\n",
        "\n",
        "        # Embed\n",
        "        self.embed()\n"
    ]
}