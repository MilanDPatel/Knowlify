{
    "topic": "demonstrates the concept of polarization and how it affects light.",
    "code": [
        "from manim_imports_ext import *\n",
        "from _2023.optics_puzzles.objects import *\n",
        "\n",
        "\n",
        "class AnnotateDemo(InteractiveScene):\n",
        "    def construct(self):\n",
        "        image = ImageMobject(\"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/images/DemoStill.jpg\")\n",
        "        image.set_height(FRAME_HEIGHT)\n",
        "        plane = NumberPlane().fade(0.25)\n",
        "        # self.add(image)\n",
        "        # self.add(plane)\n",
        "\n",
        "        # Label sugar\n",
        "        sugar_label = Text(\"Sugar solution\\n(0.75g sucrose/mL water)\")\n",
        "        sugar_label.move_to(2.5 * UP)\n",
        "        sugar_label.set_backstroke(BLACK, 3)\n",
        "        arrow_kw = dict(stroke_color=RED, stroke_width=10)\n",
        "        sugar_arrow = Arrow(sugar_label, plane.c2p(0, 0.5), **arrow_kw)\n",
        "\n",
        "        self.play(\n",
        "            Write(sugar_label, lag_ratio=0.01, run_time=2),\n",
        "            ShowCreation(sugar_arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Label light\n",
        "        light_label = Text(\"White light\\n(unpolarized)\")\n",
        "        light_label.match_y(sugar_label)\n",
        "        light_label.match_style(sugar_label)\n",
        "        light_label.to_edge(RIGHT)\n",
        "        light_arrow = Arrow(light_label, plane.c2p(4.75, 0.85), buff=0.1, **arrow_kw)\n",
        "\n",
        "        self.play(\n",
        "            FadeTransform(sugar_label, light_label),\n",
        "            ReplacementTransform(sugar_arrow, light_arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Label polarizer\n",
        "        filter_label = Text(\"Linearly polarizing filter\\n(variable angle)\")\n",
        "        filter_label.set_x(3.5).to_edge(UP)\n",
        "        filter_label.match_style(sugar_label)\n",
        "        filter_arrow = Arrow(filter_label, plane.c2p(3.4, 1.25), buff=0.1, **arrow_kw)\n",
        "\n",
        "        self.play(\n",
        "            FadeTransform(light_label, filter_label),\n",
        "            ReplacementTransform(light_arrow, filter_arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            filter_label.animate.set_x(-2.2).to_edge(UP, buff=0.5),\n",
        "            filter_arrow.animate.set_x(-3.3),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class HoldUp(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        arrow = Vector(LEFT, stroke_color=YELLOW)\n",
        "        arrow.to_edge(UP, buff=1.0)\n",
        "        # self.add(arrow)\n",
        "        self.play(\n",
        "            self.teacher.change(\"raise_right_hand\", look_at=3 * UR),\n",
        "            self.change_students(\"pondering\", \"erm\", \"sassy\", look_at=self.screen)\n",
        "        )\n",
        "        self.wait(3)\n",
        "        self.play(\n",
        "            self.change_students(\"maybe\", \"pondering\", \"hesitant\", look_at=3 * UR)\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class SteveVideoWrapper(VideoWrapper):\n",
        "    title = \"Steve Mould: Why Sugar Always Twists Light\"\n",
        "\n",
        "\n",
        "class DidntSteveCover(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        stds = self.students\n",
        "        morty = self.teacher\n",
        "        image = ImageMobject(\"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/chat with Steve/MouldThumbnail.jpg\")\n",
        "        image.set_height(3)\n",
        "        thumbnail = Group(\n",
        "            SurroundingRectangle(image, buff=0).set_stroke(WHITE, 3),\n",
        "            image\n",
        "        )\n",
        "        thumbnail.next_to(stds[2].get_corner(UR), UP, buff=1.0)\n",
        "        thumbnail.shift(RIGHT)\n",
        "\n",
        "        # Test\n",
        "        self.play(\n",
        "            stds[2].says(\"Didn't Steve Mould\\ncover this?\", mode=\"raise_right_hand\"),\n",
        "            morty.change(\"tease\"),\n",
        "            self.change_students(\"pondering\", \"pondering\", look_at=thumbnail),\n",
        "            FadeIn(thumbnail, UP)\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class FocusOnWall(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        words = Text(\"Notice what color comes out\", font_size=72)\n",
        "        words.set_backstroke(BLACK, 5)\n",
        "        words.to_edge(UP)\n",
        "        arrow = Arrow(\n",
        "            words[\"Notice what\"].get_bottom(), 6.5 * LEFT + 0.5 * UP,\n",
        "            buff=0.5,\n",
        "            stroke_color=RED, stroke_width=14,\n",
        "        )\n",
        "        self.play(\n",
        "            FadeIn(words, 0.25 * UP),\n",
        "            GrowArrow(arrow),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class WhatWeNeedToUnderstand(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        # React\n",
        "        self.play(\n",
        "            self.change_students(\"pondering\", \"maybe\", \"confused\", look_at=self.screen),\n",
        "            morty.change(\"tease\")\n",
        "        )\n",
        "        self.wait(3)\n",
        "        self.play(\n",
        "            self.change_students(\"erm\", \"sassy\", \"maybe\", look_at=self.screen)\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "        # Core concepts\n",
        "        concepts = VGroup(\n",
        "            Text(\"Polarization\"),\n",
        "            Text(\"Scattering\"),\n",
        "            Text(\"The index of refraction\"),\n",
        "        )\n",
        "        concepts.arrange(DOWN, aligned_edge=LEFT)\n",
        "        concepts.next_to(self.hold_up_spot, UP)\n",
        "\n",
        "        for i in range(3):\n",
        "            concepts[i].align_to(concepts, DOWN)\n",
        "            self.play(\n",
        "                FadeIn(concepts[i], 0.5 * UP),\n",
        "                concepts[:i].animate.shift(UP),\n",
        "                morty.change(\"raise_right_hand\", concepts),\n",
        "                *(pi.animate.look_at(concepts) for pi in stds),\n",
        "            )\n",
        "            self.wait()\n",
        "        self.wait()\n",
        "\n",
        "        # Start with an overview\n",
        "        self.play(\n",
        "            morty.says(\"To begin:\\nAn overview\"),\n",
        "            FadeOut(concepts, UP),\n",
        "            self.change_students(\"tease\", \"happy\", \"well\", look_at=morty.eyes)\n",
        "        )\n",
        "        self.look_at(self.screen)\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class ThisIsStillWhiteLight(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        words = Text(\"This is still white light\", font_size=60)\n",
        "        words.to_edge(UP)\n",
        "        arrow = Arrow(\n",
        "            words[\"This\"].get_bottom(), LEFT + 0.5 * UP,\n",
        "            stroke_color=WHITE, stroke_width=8,\n",
        "        )\n",
        "\n",
        "        self.play(\n",
        "            Write(words, run_time=1),\n",
        "            FadeIn(arrow, RIGHT, run_time=4.0, rate_func=rush_into),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class Questions(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Title\n",
        "        title = Text(\"Lingering questions\", font_size=72)\n",
        "        title.add(Underline(title))\n",
        "        title.to_edge(UP, buff=0.25)\n",
        "        self.add(title)\n",
        "\n",
        "        # Questions\n",
        "        questions = self.get_questions()\n",
        "\n",
        "        last_questions = questions[1:]\n",
        "        last_questions.save_state()\n",
        "        last_questions.set_height(6, about_edge=DL)\n",
        "\n",
        "        for question in last_questions:\n",
        "            self.play(FadeIn(question, 0.25 * UP))\n",
        "            self.wait()\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(questions[0], shift=0.25 * DOWN),\n",
        "            Restore(last_questions)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Check marks\n",
        "        marks = VGroup(*(\n",
        "            Checkmark(font_size=60).next_to(question[0], RIGHT).shift(0.15 * UP)\n",
        "            for question in questions\n",
        "        ))\n",
        "        for mark in marks:\n",
        "            mark.align_to(marks, RIGHT)\n",
        "\n",
        "        # Crossing off\n",
        "        cross_lines = VGroup()\n",
        "        for question in questions:\n",
        "            full_question = question[1]\n",
        "            phrases = full_question.get_text().split(\"\\n\")\n",
        "            cross_lines.add(VGroup(*(\n",
        "                Line(LEFT, RIGHT).set_stroke(YELLOW, 3).replace(full_question[phrase], dim_to_match=0)\n",
        "                for phrase in phrases\n",
        "            )))\n",
        "\n",
        "        # Mark off Q0\n",
        "        self.play(\n",
        "            Write(marks[0], stroke_color=GREEN),\n",
        "            ShowCreation(cross_lines[0]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Highlight question 3\n",
        "        rect = SurroundingRectangle(questions[3])\n",
        "        rect.set_stroke(YELLOW, 2)\n",
        "        arrow = Vector(LEFT, stroke_color=YELLOW)\n",
        "        arrow.next_to(rect, RIGHT)\n",
        "        self.play(\n",
        "            questions[:3].animate.set_opacity(0.5),\n",
        "            ShowCreation(rect),\n",
        "            FadeInFromPoint(arrow, ORIGIN),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(rect),\n",
        "            FadeOut(arrow),\n",
        "            ShowCreation(cross_lines[3]),\n",
        "            Write(marks[3], stroke_color=GREEN),\n",
        "            questions[:3].animate.set_opacity(1),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Question 1\n",
        "        rect.set_stroke(opacity=0)\n",
        "        arrow.set_stroke(opacity=0)\n",
        "        self.play(\n",
        "            rect.animate.surround(questions[1]).set_stroke(opacity=1),\n",
        "            arrow.animate.next_to(questions[1], RIGHT).set_stroke(opacity=1),\n",
        "        )\n",
        "        self.wait()\n",
        "        marks[1].set_fill(opacity=0)\n",
        "        marks[1].set_stroke(GREEN, 2)\n",
        "        self.play(\n",
        "            FadeOut(rect),\n",
        "            Write(marks[1]),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Question 2\n",
        "        self.play(\n",
        "            arrow.animate.next_to(questions[2], RIGHT)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "    def get_questions(self):\n",
        "        kw = dict(alignment=\"LEFT\")\n",
        "        question_texts = [\n",
        "            \"What exactly is wiggling?\",\n",
        "            \"Why does sugar make light twist?\",\n",
        "            \"Why does the twisting rate\\ndepend on frequency?\",\n",
        "            \"Why do we see colors\\nin diagonal stripes?\",\n",
        "        ]\n",
        "        questions = VGroup(*(\n",
        "            VGroup(\n",
        "                Text(f\"Question #{n}:\", **kw).set_fill(GREY_A),\n",
        "                Text(text, **kw),\n",
        "            ).arrange(DOWN, buff=0.25, aligned_edge=LEFT)\n",
        "            for n, text in enumerate(question_texts)\n",
        "        ))\n",
        "        questions.arrange(DOWN, buff=1.0, aligned_edge=LEFT)\n",
        "        questions.set_height(6)\n",
        "        questions.to_corner(DL)\n",
        "        return questions\n",
        "\n",
        "\n",
        "class TwoLines(InteractiveScene):\n",
        "    def construct(self):\n",
        "        h_line = Line(UP, DOWN).set_height(FRAME_HEIGHT)\n",
        "        v_line = Line(LEFT, RIGHT).set_width(FRAME_WIDTH)\n",
        "        lines = VGroup(h_line, v_line)\n",
        "        lines.set_stroke(WHITE, 3)\n",
        "        self.add(lines)\n",
        "\n",
        "\n",
        "class CyclingQuestions(Questions):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        questions = self.get_questions()[1:]\n",
        "        for question in questions:\n",
        "            question.scale(1.1)\n",
        "            question.to_corner(UL, buff=0.5)\n",
        "\n",
        "        self.add(questions[0])\n",
        "        self.wait()\n",
        "        for q1, q2 in zip(questions, questions[1:]):\n",
        "            self.play(FadeOut(q1, UP), FadeIn(q2, UP))\n",
        "            self.wait()\n",
        "\n",
        "\n",
        "class FromOnHigh(InteractiveScene):\n",
        "    def construct(self):\n",
        "        rects = ScreenRectangle().replicate(3)\n",
        "        rects.set_height(0.3 * FRAME_HEIGHT)\n",
        "        rects.arrange(RIGHT)\n",
        "        # self.add(rects)\n",
        "\n",
        "        top_words = Text(\"Authoritative explainer\")\n",
        "        top_words.to_edge(UP)\n",
        "        low_words = Text(\"Fundamental understanding\")\n",
        "        low_words.to_edge(DOWN)\n",
        "        cross = Cross(top_words)\n",
        "\n",
        "        top_arrows = VGroup(*(Arrow(top_words.get_bottom(), rect.get_top()) for rect in rects))\n",
        "        low_arrows = VGroup(*(Arrow(low_words.get_top(), rect.get_bottom()) for rect in rects))\n",
        "\n",
        "        # Test\n",
        "        self.add(top_words)\n",
        "        self.play(LaggedStartMap(GrowArrow, top_arrows))\n",
        "        self.play(ShowCreation(cross))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            Transform(top_arrows, low_arrows),\n",
        "            FadeTransform(VGroup(top_words, cross), low_words),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ThreeParts(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Setup\n",
        "        self.add(FullScreenRectangle())\n",
        "        parts = ScreenRectangle().replicate(3)\n",
        "        parts.set_height(0.3 * FRAME_HEIGHT)\n",
        "        parts.arrange(RIGHT)\n",
        "        parts.arrange_to_fit_width(FRAME_WIDTH - 0.5)\n",
        "        parts.set_fill(BLACK, 1)\n",
        "        parts.set_stroke(width=0)\n",
        "        self.add(parts)\n",
        "\n",
        "        self.clear()\n",
        "\n",
        "        rect = SurroundingRectangle(parts[0], buff=0)\n",
        "        rect.set_stroke(WHITE, 4)\n",
        "\n",
        "        self.add(rect)\n",
        "\n",
        "        # Test\n",
        "        self.wait()\n",
        "        for part in parts[1:]:\n",
        "            self.play(rect.animate.surround(part, buff=0))\n",
        "            self.wait()\n",
        "\n",
        "\n",
        "class UnitRVector(InteractiveScene):\n",
        "    def construct(self):\n",
        "        text = TexText(R\"Unit vector in \\\\ the direction of $\\vec{r}$\")\n",
        "        text.set_fill(YELLOW)\n",
        "        text.set_backstroke(BLACK, 10)\n",
        "        self.add(text)\n",
        "\n",
        "\n",
        "class RSquaredVsR(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Axes\n",
        "        axes = Axes((0, 10), (0, 1, 0.25), height=5, width=12)\n",
        "        axes.x_axis.add_numbers()\n",
        "        axes.y_axis.add_numbers(num_decimal_places=2)\n",
        "        self.add(axes)\n",
        "\n",
        "        # Add graphs\n",
        "        graph1 = axes.get_graph(lambda x: 1 / x**2, x_range=(0.1, 10)).set_stroke(YELLOW, 5)\n",
        "        graph2 = axes.get_graph(lambda x: 1 / x, x_range=(0.1, 10)).set_stroke(BLUE, 5)\n",
        "        graphs = VGroup(graph1, graph2)\n",
        "        labels = VGroup(\n",
        "            Tex(R\"f(r) = \\frac{1}{r^2}\").set_color(YELLOW),\n",
        "            Tex(R\"f(r) = \\frac{1}{r}\").set_color(BLUE),\n",
        "        )\n",
        "        labels.arrange(DOWN, buff=1.0, aligned_edge=LEFT)\n",
        "        labels.move_to(axes, UR)\n",
        "\n",
        "        for graph, label in zip(graphs, labels):\n",
        "            self.play(\n",
        "                ShowCreation(graph, run_time=3),\n",
        "                FadeIn(label, 0.5 * UP),\n",
        "            )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class SimpleRect(InteractiveScene):\n",
        "    def construct(self):\n",
        "        rad = Text(\"rad\")\n",
        "        rect = SurroundingRectangle(rad)\n",
        "        rect.set_stroke(YELLOW, 3)\n",
        "        arrow = Vector(UP)\n",
        "        arrow.set_stroke(YELLOW)\n",
        "        arrow.next_to(rect, DOWN)\n",
        "        self.play(ShowCreation(arrow), ShowCreation(rect))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ThisIsLight(InteractiveScene):\n",
        "    def construct(self):\n",
        "        morty = Mortimer(height=1.5)\n",
        "        morty.to_corner(DR)\n",
        "        self.play(morty.says(\"This is light!\", mode=\"surprised\"))\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class MentionMaxwell(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Introduce\n",
        "        stds = self.students\n",
        "        morty = self.teacher\n",
        "        kw = dict(\n",
        "            tex_to_color_map={\n",
        "                R\"\\mathbf{E}\": BLUE,\n",
        "                R\"\\mathbf{B}\": YELLOW,\n",
        "            },\n",
        "            font_size=30,\n",
        "        )\n",
        "        maxwells_equations = VGroup(\n",
        "            Tex(R\"\\nabla \\cdot \\mathbf{E}=\\frac{\\rho}{\\varepsilon_0}\", **kw),\n",
        "            Tex(R\"\\nabla \\cdot \\mathbf{B}=0\", **kw),\n",
        "            Tex(R\"\\nabla \\times \\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t}\", **kw),\n",
        "            Tex(R\"\\nabla \\times \\mathbf{B}=\\mu_0\\left(\\mathbf{J}+\\varepsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t}\\right)\", **kw),\n",
        "        )\n",
        "        maxwells_equations.arrange(DOWN, aligned_edge=LEFT)\n",
        "        equations_rect = SurroundingRectangle(maxwells_equations, buff=0.25)\n",
        "        equations_rect.set_stroke(WHITE, 1)\n",
        "        equations_rect.set_fill(BLACK, 1)\n",
        "        maxwells_equations.add_to_back(equations_rect)\n",
        "\n",
        "        maxwells_equations.next_to(stds[2].get_corner(UR), UP)\n",
        "        maxwells_equations.shift(MED_SMALL_BUFF * UP)\n",
        "        equations_title = Text(\"Maxwell's Equations\")\n",
        "        equations_title.next_to(maxwells_equations, UP, buff=0.25)\n",
        "\n",
        "        self.play(\n",
        "            stds[2].says(TexText(R\"What about \\\\ Maxwell's equations?\")),\n",
        "            morty.change(\"tease\"),\n",
        "            self.change_students(\"confused\", \"pondering\")\n",
        "        )\n",
        "        self.play(\n",
        "            stds[2].change(\"raise_right_hand\"),\n",
        "            FadeIn(maxwells_equations, UP),\n",
        "        )\n",
        "        self.play(\n",
        "            FadeTransform(stds[2].bubble.content[\"Maxwell's equations\"].copy(), equations_title),\n",
        "            stds[2].debubble(),\n",
        "            *(pi.animate.look_at(equations_title) for pi in [morty, *stds[:2]]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(self.change_students(\"maybe\", \"erm\", look_at=maxwells_equations))\n",
        "        self.wait(4)\n",
        "\n",
        "        maxwells_equations.add(equations_title)\n",
        "\n",
        "        # Lorentz law\n",
        "        maxwells_equations.generate_target()\n",
        "        maxwells_equations.target.scale(0.7).to_edge(LEFT)\n",
        "\n",
        "        equation = Tex(R\"\"\"\n",
        "            \\vec{E}_{\\text{rad}}(\\vec{r}, t) = \n",
        "            {-q \\over 4\\pi \\epsilon_0 c^2}\n",
        "            {1 \\over ||\\vec{r}||}\n",
        "            \\vec{a}_\\perp(t - ||\\vec{r}|| / c)\n",
        "        \"\"\", font_size=42)\n",
        "        lhs = equation[R\"\\vec{E}_{\\text{rad}}(\\vec{r}, t)\"]\n",
        "        lhs.set_color(BLUE)\n",
        "        equation[R\"\\vec{a}_\\perp(\"].set_color(PINK)\n",
        "        equation[R\")\"][1].set_color(PINK)\n",
        "\n",
        "        equation.next_to(morty.get_corner(UL), UP)\n",
        "        equation.shift_onto_screen()\n",
        "        equation.match_y(maxwells_equations)\n",
        "        eq_rect = SurroundingRectangle(equation)\n",
        "        eq_rect.set_stroke(BLUE, 2)\n",
        "        eq_rect.set_fill(BLUE, 0.1)\n",
        "\n",
        "        implies_arrow = Arrow(eq_rect, maxwells_equations.target)\n",
        "        implies_word = Text(\"Derived from these\", font_size=30)\n",
        "        implies_word.next_to(implies_arrow, UP)\n",
        "\n",
        "        question = Text(\"How far will this take us?\")\n",
        "        question.next_to(equation, UP, buff=2.0)\n",
        "        question.shift_onto_screen()\n",
        "        arrow = Arrow(equation, question)\n",
        "\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            FadeIn(equation, 0.5 * UP),\n",
        "            MoveToTarget(maxwells_equations),\n",
        "            GrowArrow(implies_arrow),\n",
        "            FadeIn(implies_word, lag_ratio=0.1),\n",
        "            self.change_students(\"well\", \"happy\")\n",
        "        )\n",
        "        self.wait()\n",
        "        self.add(eq_rect, equation)\n",
        "        self.play(\n",
        "            FadeIn(eq_rect),\n",
        "            ShowCreation(arrow),\n",
        "            FadeIn(question, lag_ratio=0.1),\n",
        "            morty.change(\"tease\", look_at=question),\n",
        "            self.change_students(\"tease\", \"well\", \"happy\", look_at=equation)\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "        # Remove\n",
        "        self.remove(equation)\n",
        "        everything = Group(*self.mobjects)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeOut, everything),\n",
        "            equation.copy().animate.scale(36.0 / 42).to_corner(UR),\n",
        "            run_time=1,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class BasicallyZ(InteractiveScene):\n",
        "    def construct(self):\n",
        "        rect = Rectangle(6.0, 2.0)\n",
        "        rect.set_stroke(YELLOW, 2)\n",
        "        rect.set_fill(YELLOW, 0.2)\n",
        "        rect.to_edge(RIGHT, buff=0.25)\n",
        "        words = Text(\"Essentially parallel\\nto the z-axis\")\n",
        "        words.next_to(rect, UP)\n",
        "        self.play(\n",
        "            FadeIn(words, 0.25 * UP),\n",
        "            FadeIn(rect)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class StrengthInDifferentDirectionsWithDecimal(InteractiveScene):\n",
        "    def construct(self):\n",
        "        line = Line(ORIGIN, 7 * RIGHT)\n",
        "        line.set_stroke(TEAL, 4)\n",
        "        arc = always_redraw(lambda: Arc(angle=line.get_angle(), radius=0.5))\n",
        "        angle_label = Integer(0, unit=R\"^\\circ\")\n",
        "        angle_label.add_updater(lambda m: m.set_value(line.get_angle() / DEGREES))\n",
        "        angle_label.add_updater(lambda m: m.set_height(clip(arc.get_height(), 0.01, 0.4)))\n",
        "        angle_label.add_updater(lambda m: m.next_to(arc.pfp(0.3), normalize(arc.pfp(0.3)), SMALL_BUFF, aligned_edge=DOWN))\n",
        "\n",
        "        strong_words = Text(\"Strongest in this direction\")\n",
        "        strong_words.next_to(line, UP)\n",
        "        cos_temp_text = \"cos(00*)=0.00\"\n",
        "        weak_words = Text(f\"Weaker by a factor of {cos_temp_text}\", font_size=36)\n",
        "        cos_template = weak_words[cos_temp_text][0]\n",
        "        cos_template.set_opacity(0)\n",
        "        weak_words.next_to(line, UP)\n",
        "\n",
        "        strong_words.set_backstroke(BLACK, 10)\n",
        "        weak_words.set_backstroke(BLACK, 10)\n",
        "\n",
        "        def get_cos_tex():\n",
        "            cos_tex = Tex(R\"\\cos(10^\\circ) = 0.00\", font_size=36)\n",
        "            cos_tex.make_number_changeable(\"10\", edge_to_fix=RIGHT).set_value(line.get_angle() / DEGREES)\n",
        "            cos_tex.make_number_changeable(\"0.00\").set_value(math.cos(line.get_angle()))\n",
        "            cos_tex.rotate(line.get_angle())\n",
        "            cos_tex.move_to(weak_words[-len(cos_temp_text) + 1:])\n",
        "            cos_tex.set_backstroke(BLACK, 10)\n",
        "            return cos_tex\n",
        "\n",
        "        cos_tex = always_redraw(get_cos_tex)\n",
        "\n",
        "        # Test\n",
        "        self.play(ShowCreation(line), Write(strong_words, run_time=1))\n",
        "        self.wait(2)\n",
        "        self.add(arc, angle_label, weak_words, cos_tex)\n",
        "        self.remove(strong_words)\n",
        "        rot_group = VGroup(line, weak_words)\n",
        "        self.play(\n",
        "            Rotate(rot_group, 30 * DEGREES, about_point=ORIGIN),\n",
        "            run_time=3\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            self.frame.animate.set_height(12),\n",
        "            Rotate(rot_group, 30 * DEGREES, about_point=ORIGIN),\n",
        "            run_time=3\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            self.frame.animate.set_height(15),\n",
        "            Rotate(rot_group, 30 * DEGREES, about_point=ORIGIN),\n",
        "            run_time=3\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "\n",
        "class ERadEquation(InteractiveScene):\n",
        "    def construct(self):\n",
        "        equation = Tex(R\"\"\"\n",
        "            \\vec{E}_{\\text{rad}}(\\vec{r}, t) = \n",
        "            {-q \\over 4\\pi \\epsilon_0 c^2}\n",
        "            {1 \\over ||\\vec{r}||}\n",
        "            \\vec{a}_\\perp(t - ||\\vec{r}|| / c)\n",
        "        \"\"\", font_size=36)\n",
        "        lhs = equation[R\"\\vec{E}_{\\text{rad}}(\\vec{r}, t)\"]\n",
        "        lhs.set_color(BLUE)\n",
        "        equation[R\"\\vec{a}_\\perp(\"].set_color(PINK)\n",
        "        equation[R\")\"][1].set_color(PINK)\n",
        "        self.add(equation)\n",
        "\n",
        "\n",
        "class XZLabel(InteractiveScene):\n",
        "    def construct(self):\n",
        "        xz_label = Tex(\"xz\")\n",
        "        x, z = xz_label\n",
        "        x.next_to(ORIGIN, UP, SMALL_BUFF).to_edge(RIGHT, buff=0.2)\n",
        "        z.next_to(ORIGIN, RIGHT, SMALL_BUFF).to_edge(UP, buff=0.2)\n",
        "        self.add(xz_label)\n",
        "\n",
        "\n",
        "class TransitionBeforePolarization(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        self.play(\n",
        "            self.change_students(\"pondering\", \"thinking\", \"happy\", look_at=self.screen),\n",
        "        )\n",
        "        self.wait(3)\n",
        "        self.play(\n",
        "            self.teacher.change(\"raise_left_hand\", look_at=3 * UR),\n",
        "            self.change_students(\"well\", \"tease\", \"happy\", look_at=3 * UR),\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class AskAboutQuantum(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        # Question\n",
        "        self.play(\n",
        "            stds[0].says(\"What about, like,\\nphotons and quantum stuff?\"),\n",
        "            morty.change(\"well\"),\n",
        "            self.change_students(None, \"sassy\", \"hesitant\", look_at=stds[0].eyes),\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "        # Create T chart\n",
        "        titles = VGroup(\n",
        "            Text(\"Classical\"),\n",
        "            Text(\"Quantum\"),\n",
        "        )\n",
        "        v_lines = Line(UP, DOWN).replicate(2).set_height(4.5)\n",
        "        v_lines.arrange(RIGHT, buff=titles[0].get_width() + 0.75)\n",
        "        v_lines.to_edge(UP, buff=0)\n",
        "        v_lines.shift(1.5 * RIGHT)\n",
        "        h_line = Line(LEFT, RIGHT)\n",
        "        h_line.set_width(13.25)\n",
        "        h_line.to_edge(UP, buff=titles.get_height() + 0.5)\n",
        "        h_line.set_x(0)\n",
        "        lines = VGroup(h_line, *v_lines)\n",
        "        lines.set_stroke(WHITE, 2)\n",
        "\n",
        "        titles[0].move_to(v_lines).to_edge(UP, buff=0.25)\n",
        "        titles[1].next_to(v_lines, RIGHT, buff=0.5).match_y(titles[0])\n",
        "\n",
        "        # Points\n",
        "        points = VGroup(\n",
        "            Text(\"Waves radiate away from changing charges\"),\n",
        "            Text(\"These waves have polarization\"),\n",
        "            Text(\"Energy scales continuously\"),\n",
        "        )\n",
        "        points.scale(0.7)\n",
        "        points.arrange(DOWN, buff=0.5, aligned_edge=LEFT)\n",
        "        points.next_to(h_line, DOWN, buff=0.5, aligned_edge=LEFT)\n",
        "\n",
        "        soft_h_lines = h_line.replicate(len(points))\n",
        "        soft_h_lines.set_stroke(WHITE, 1, opacity=0.5)\n",
        "        for point, soft_line in zip(points, soft_h_lines):\n",
        "            soft_line.next_to(point, DOWN, buff=0.25)\n",
        "            soft_line.align_to(h_line, LEFT)\n",
        "\n",
        "        checks = VGroup(*(\n",
        "            Checkmark().match_x(title).match_y(point)\n",
        "            for point in points\n",
        "            for title in titles\n",
        "        ))\n",
        "        cross = Exmark().move_to(checks[-1])\n",
        "\n",
        "        last_q_point = Text(\n",
        "            \"\"\"\n",
        "            Energy comes in\n",
        "            discrete chunks\n",
        "            (that is, in quanta)\n",
        "            \"\"\",\n",
        "            alignment=\"LEFT\"\n",
        "        )\n",
        "        last_q_point.scale(0.7)\n",
        "        last_q_point.next_to(cross, DOWN, buff=0.5)\n",
        "        last_q_point.align_to(titles[1], LEFT)\n",
        "        last_q_point.set_color(YELLOW)\n",
        "\n",
        "        # Animate in the charge\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            FadeTransform(stds[0].bubble.content[\"quantum\"].copy(), titles[1]),\n",
        "            FadeIn(titles[0], shift=0.25 * UP),\n",
        "            ShowCreation(h_line),\n",
        "            ShowCreation(v_lines),\n",
        "            Write(soft_h_lines),\n",
        "            stds[0].debubble(mode=\"pondering\"),\n",
        "            self.change_students(None, \"pondering\", \"pondering\", look_at=UP),\n",
        "            run_time=2,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Points\n",
        "        self.play(\n",
        "            FadeIn(points[0], lag_ratio=0.1),\n",
        "            Write(checks[:2], lag_ratio=0.7, stroke_color=GREEN),\n",
        "            *(pi.animate.look_at(titles) for pi in self.pi_creatures)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(points[1], lag_ratio=0.1),\n",
        "            Write(checks[2:4], lag_ratio=0.7, stroke_color=GREEN)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(points[2], lag_ratio=0.1),\n",
        "            Write(checks[4], stroke_color=GREEN),\n",
        "            FadeIn(cross, scale=0.5),\n",
        "            morty.change(\"sassy\", look_at=cross)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(self.pi_creatures, DOWN),\n",
        "            FadeOut(soft_h_lines[-1]),\n",
        "            # FadeIn(last_q_point, lag_ratio=0.1),\n",
        "            v_lines.animate.set_height(7, about_edge=UP, stretch=True),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ContinuousWave(InteractiveScene):\n",
        "    def construct(self):\n",
        "        wave = self.get_wave()\n",
        "        points = wave.get_points().copy()\n",
        "        wave.add_updater(lambda m: m.set_points(points).stretch(\n",
        "            (1 - math.sin(self.time)), 1,\n",
        "        ))\n",
        "        self.add(wave)\n",
        "        self.wait(20)\n",
        "\n",
        "    def get_wave(self):\n",
        "        axes = Axes((0, 2 * TAU), (0, 1))\n",
        "        wave = axes.get_graph(np.sin)\n",
        "        wave.set_stroke(BLUE, 4)\n",
        "        wave.set_width(2.0)\n",
        "        return wave\n",
        "\n",
        "\n",
        "class DiscreteWave(ContinuousWave):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        waves = self.get_wave().replicate(3)\n",
        "        waves.scale(2)\n",
        "        waves.arrange(DOWN, buff=1.0)\n",
        "        labels = VGroup()\n",
        "        for n, wave in zip(it.count(1), waves):\n",
        "            wave.stretch(0.5 * n, 1)\n",
        "            label = TexText(f\"{n} $hf$\" + (\"\" if n > 1 else \"\"))\n",
        "            label.scale(0.5)\n",
        "            label.next_to(wave, UP, buff=0.2)\n",
        "            labels.add(label)\n",
        "            self.play(\n",
        "                FadeIn(wave),\n",
        "                FadeIn(label),\n",
        "            )\n",
        "\n",
        "        dots = Tex(R\"\\vdots\", font_size=60)\n",
        "        dots.next_to(waves, DOWN)\n",
        "        self.play(Write(dots))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ContinuousGraph(InteractiveScene):\n",
        "    def construct(self):\n",
        "        axes = Axes((0, 5), (0, 5), width=4, height=4)\n",
        "        graph = axes.get_graph(lambda x: (x**2) / 5)\n",
        "        graph.set_stroke(YELLOW, 3)\n",
        "        self.add(axes)\n",
        "        self.play(ShowCreation(graph))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class DiscreteGraph(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        axes = Axes((0, 5), (0, 5), width=4, height=4)\n",
        "        graph = axes.get_graph(\n",
        "            lambda x: np.floor(x) + 0.5,\n",
        "            discontinuities=np.arange(0, 8),\n",
        "            x_range=(0, 4.99),\n",
        "        )\n",
        "        graph.set_stroke(RED, 5)\n",
        "        self.add(axes)\n",
        "        self.play(ShowCreation(graph))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class LightQuantumWrapper(VideoWrapper):\n",
        "    title = \"Some light quantum mechanics\"\n",
        "\n",
        "\n",
        "class RedFilter(InteractiveScene):\n",
        "    def construct(self):\n",
        "        image = ImageMobject(\"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/images/RedFilter.jpg\")\n",
        "        image.set_height(FRAME_HEIGHT)\n",
        "\n",
        "        # self.add(image)\n",
        "\n",
        "        plane = NumberPlane()\n",
        "        plane.fade(0.75)\n",
        "\n",
        "        # Pixel indicator\n",
        "        indicator = self.get_pixel_indicator(image)\n",
        "        indicator.move_to(plane.c2p(5.25, -0.25), DOWN)\n",
        "\n",
        "        self.add(indicator)\n",
        "\n",
        "        # Move around\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            indicator.animate.move_to(plane.c2p(1.5, -0.125), DOWN),\n",
        "            run_time=6,\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            indicator.animate.move_to(plane.c2p(-3.5, 0), DOWN),\n",
        "            run_time=6,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "    def get_pixel_indicator(self, image, vect_len=2.0, direction=DOWN, square_size=1.0):\n",
        "        vect = Vector(vect_len * direction, stroke_color=WHITE)\n",
        "        square = Square(side_length=square_size)\n",
        "        square.set_stroke(WHITE, 1)\n",
        "        square.next_to(vect, -direction)\n",
        "\n",
        "        def get_color():\n",
        "            points = vect.get_end() + 0.05 * compass_directions(12)\n",
        "            rgbs = np.array([image.point_to_rgb(point) for point in points])\n",
        "            return rgb_to_color(rgbs.mean(0))\n",
        "\n",
        "        square.add_updater(lambda s: s.set_fill(get_color(), 1))\n",
        "        return VGroup(square, vect)\n",
        "\n",
        "\n",
        "class LengthsOnDifferentColors(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Setup\n",
        "        image = ImageMobject(\"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/images/RainbowTubes.jpg\")\n",
        "        image.set_height(FRAME_HEIGHT)\n",
        "        # self.add(image)\n",
        "\n",
        "        plane = NumberPlane()\n",
        "        plane.fade(0.75)\n",
        "        # self.add(plane)\n",
        "\n",
        "        # Rectangles\n",
        "        rects = Rectangle().replicate(4)\n",
        "        rects.set_stroke(width=0)\n",
        "        rects.set_fill(BLACK, opacity=0)\n",
        "        rects.set_height(2)\n",
        "        rects.set_width(FRAME_WIDTH, stretch=True)\n",
        "        rects.arrange(DOWN, buff=0)\n",
        "\n",
        "        # Braces\n",
        "        lines = VGroup(\n",
        "            Line(plane.c2p(3.2, 2.8), plane.c2p(-0.5, 2.8)),\n",
        "            Line(plane.c2p(3.2, 0.9), plane.c2p(0.6, 0.9)),\n",
        "            Line(plane.c2p(3.2, -1.0), plane.c2p(1.0, -1.0)),\n",
        "            Line(plane.c2p(3.2, -3.0), plane.c2p(1.3, -3.0)),\n",
        "        )\n",
        "        braces = VGroup(*(\n",
        "            Brace(line, DOWN, buff=SMALL_BUFF)\n",
        "            for line in lines\n",
        "        ))\n",
        "        braces.set_backstroke(BLACK, 3)\n",
        "        numbers = VGroup(*(\n",
        "            DecimalNumber(line.get_length() / 7, font_size=36, unit=R\" \\text{m}\")\n",
        "            for line in lines\n",
        "        ))\n",
        "        for number, brace in zip(numbers, braces):\n",
        "            number.next_to(brace, DOWN, buff=SMALL_BUFF)\n",
        "\n",
        "        # Show braces\n",
        "        for brace, rect, number in zip(braces, rects, numbers):\n",
        "            other_rects = VGroup(*(r for r in rects if r is not rect))\n",
        "            self.play(\n",
        "                GrowFromPoint(brace, brace.get_right()),\n",
        "                CountInFrom(number, 0),\n",
        "                UpdateFromFunc(VGroup(), lambda m: number.next_to(brace, DOWN, SMALL_BUFF)),\n",
        "                rect.animate.set_opacity(0),\n",
        "                other_rects.animate.set_opacity(0.8),\n",
        "            )\n",
        "            self.wait(2)\n",
        "        self.play(FadeOut(rects))\n",
        "\n",
        "        # Ribbons\n",
        "        axes_3d = ThreeDAxes((0, 6))\n",
        "        ribbons = Group()\n",
        "        twist_rates = [1.0 / PI / line.get_length() for line in lines]\n",
        "        twist_rates = [0.09, 0.11, 0.115, 0.12]\n",
        "        for line, twist_rate in zip(lines, twist_rates):\n",
        "            ribbon = TwistedRibbon(\n",
        "                axes_3d,\n",
        "                amplitude=0.25,\n",
        "                twist_rate=twist_rate,\n",
        "                color=rgb_to_color(image.point_to_rgb(line.get_start())),\n",
        "            )\n",
        "            ribbon.rotate(PI / 2, RIGHT)\n",
        "            ribbon.set_opacity(0.75)\n",
        "            ribbon.flip(UP)\n",
        "            ribbon.next_to(line, UP, MED_LARGE_BUFF, aligned_edge=RIGHT)\n",
        "            ribbons.add(ribbon)\n",
        "\n",
        "        for ribbon in ribbons:\n",
        "            self.play(ShowCreation(ribbon, run_time=2))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class AskAboutDiagonal(InteractiveScene):\n",
        "    def construct(self):\n",
        "        randy = Randolph(height=2)\n",
        "        self.play(randy.says(\"Why diagonal?\", mode=\"maybe\", look_at=DOWN))\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class AskNoteVerticalVariation(RedFilter):\n",
        "    def construct(self):\n",
        "        image = ImageMobject(\"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/images/GreenFilter.jpg\")\n",
        "        image.set_height(FRAME_HEIGHT)\n",
        "        # self.add(image)\n",
        "\n",
        "        plane = NumberPlane()\n",
        "        plane.fade(0.75)\n",
        "        # self.add(plane)\n",
        "\n",
        "        indicator = self.get_pixel_indicator(image)\n",
        "\n",
        "        # Scan horizontally, then vertically\n",
        "        indicator.move_to(plane.c2p(-0.5, -0.5), DOWN)\n",
        "\n",
        "        lr_arrows = VGroup(Vector(LEFT), Vector(RIGHT))\n",
        "        lr_arrows.arrange(RIGHT, buff=1.0)\n",
        "        lr_arrows.move_to(plane.c2p(0.5, -1.5))\n",
        "        ud_arrows = VGroup(Vector(UP), Vector(DOWN))\n",
        "        ud_arrows.arrange(DOWN, buff=1.0)\n",
        "        ud_arrows.move_to(plane.c2p(0, -0.6))\n",
        "\n",
        "        self.add(indicator)\n",
        "        self.play(\n",
        "            FadeIn(lr_arrows, time_span=(0, 1)),\n",
        "            indicator.animate.move_to(plane.c2p(3, -0.5), DOWN),\n",
        "            run_time=3\n",
        "        )\n",
        "        self.play(indicator.animate.move_to(plane.c2p(1.5, -0.5), DOWN), run_time=3)\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(ud_arrows, time_span=(0, 1)),\n",
        "            FadeOut(lr_arrows, time_span=(0, 1)),\n",
        "            indicator.animate.move_to(plane.c2p(1.5, -0.2), DOWN),\n",
        "            run_time=3\n",
        "        )\n",
        "        self.play(indicator.animate.move_to(plane.c2p(1.5, -0.9), DOWN), run_time=3)\n",
        "        self.play(indicator.animate.move_to(plane.c2p(1.5, -0.5), DOWN), run_time=3)\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class CombineColors(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Get images\n",
        "        folder = \"/Users/grant/3Blue1Brown Dropbox/3Blue1Brown/videos/2023/barber_pole/images/\"\n",
        "        images = Group(*(\n",
        "            ImageMobject(os.path.join(folder, ext + \"Still.jpg\"))\n",
        "            for ext in [\"Red\", \"Orange\", \"Green\", \"Blue\", \"Rainbow\"]\n",
        "        ))\n",
        "        colors = images[:4]\n",
        "        rainbow = images[4]\n",
        "        colors.set_height(FRAME_HEIGHT / 2)\n",
        "        colors.arrange_in_grid(buff=0)\n",
        "        rainbow.set_height(FRAME_HEIGHT)\n",
        "\n",
        "        self.add(*colors)\n",
        "\n",
        "\n",
        "class SteveMouldMention(InteractiveScene):\n",
        "    def construct(self):\n",
        "        morty = Mortimer(height=2)\n",
        "        morty.to_edge(DOWN)\n",
        "        self.play(\n",
        "            morty.says(\"\"\"\n",
        "                This is the part that\n",
        "                Steve Mould explains\n",
        "                quite well, by the way\n",
        "            \"\"\", mode=\"tease\")\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class IndexOfRefraction(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        equation = Tex(R\"{\\text{Speed in a vacuum} \\over \\text{Speed in water}} \\approx 1.33\")\n",
        "        equation.shift(UP)\n",
        "        rhs = equation[R\"\\approx 1.33\"]\n",
        "        equation.scale(0.75)\n",
        "        rhs.scale(1 / 0.75, about_edge=LEFT)\n",
        "        arrow = Vector(DOWN)\n",
        "        arrow.next_to(rhs, DOWN, SMALL_BUFF)\n",
        "        words = TexText(\"``Index of refraction''\")\n",
        "        words.next_to(arrow, DOWN, SMALL_BUFF)\n",
        "        words.set_color(BLUE)\n",
        "\n",
        "        self.play(FadeIn(equation, 0.5 * UP))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            GrowArrow(arrow),\n",
        "            Write(words)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class LayerKickBackLabel(InteractiveScene):\n",
        "    def construct(self):\n",
        "        layer_label = Text(\"Each layer kicks back the phase\")\n",
        "        layer_label.to_edge(UP)\n",
        "        self.play(Write(layer_label))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class SugarIsChiral(InteractiveScene):\n",
        "    default_frame_orientation = (-33, 85)\n",
        "    title = R\"Sucrose $\\text{C}_{12}\\text{H}_{22}\\text{O}_{11}$ \"\n",
        "    subtitle = \"(D-Glucose + D-Fructose)\"\n",
        "    molecule_height = 3\n",
        "\n",
        "    def construct(self):\n",
        "        axes = ThreeDAxes()\n",
        "        axes.set_stroke(opacity=0.5)\n",
        "        # self.add(axes)\n",
        "\n",
        "        # Set up\n",
        "        frame = self.frame\n",
        "        title = VGroup(\n",
        "            TexText(self.title),\n",
        "            TexText(self.subtitle),\n",
        "        )\n",
        "        title[1].scale(0.7).set_color(GREY_A)\n",
        "        title.arrange(DOWN)\n",
        "        title.fix_in_frame()\n",
        "        title.to_edge(UP, buff=0.25)\n",
        "\n",
        "        sucrose = Sucrose()\n",
        "        sucrose.set_height(self.molecule_height)\n",
        "\n",
        "        # Introduce\n",
        "        frame.reorient(24, 74, 0)\n",
        "        self.add(title)\n",
        "        self.play(\n",
        "            FadeIn(sucrose, scale=5),\n",
        "        )\n",
        "        self.play(\n",
        "            self.frame.animate.reorient(-16, 75, 0).set_anim_args(run_time=6)\n",
        "        )\n",
        "        self.add(sucrose)\n",
        "        self.wait()\n",
        "\n",
        "        # Show mirror image\n",
        "        mirror = Square(side_length=6)\n",
        "        mirror.set_fill(BLUE, 0.35)\n",
        "        mirror.set_stroke(width=0)\n",
        "        mirror.rotate(PI / 2, UP)\n",
        "        mirror.set_shading(0, 1, 0)\n",
        "        mirror.stretch(3, 1)\n",
        "\n",
        "        sucrose.target = sucrose.generate_target()\n",
        "        sucrose.target.next_to(mirror, LEFT, buff=1.0)\n",
        "\n",
        "        self.add(mirror, sucrose)\n",
        "        self.play(\n",
        "            frame.animate.move_to(0.75 * OUT),\n",
        "            MoveToTarget(sucrose),\n",
        "            FadeIn(mirror),\n",
        "            title.animate.scale(0.75).match_x(sucrose.target).set_y(1.75),\n",
        "            run_time=1.5,\n",
        "        )\n",
        "\n",
        "        mirror_image = sucrose.copy()\n",
        "        mirror_image.target = mirror_image.generate_target()\n",
        "        mirror_image.target.stretch(-1, 0, about_point=mirror.get_center())\n",
        "\n",
        "        mirror_words = Text(\"(mirror image)\", font_size=36, color=GREY_A)\n",
        "        mirror_words.fix_in_frame()\n",
        "        mirror_words.match_x(mirror_image.target)\n",
        "        mirror_words.match_y(title)\n",
        "\n",
        "        self.add(mirror_image, mirror, sucrose)\n",
        "        self.play(\n",
        "            MoveToTarget(mirror_image),\n",
        "            FadeIn(mirror_words),\n",
        "        )\n",
        "\n",
        "        # Chiral definition\n",
        "        definition = TexText(R\"Chiral $\\rightarrow$ Cannot be superimposed onto its mirror image\")\n",
        "        definition.fix_in_frame()\n",
        "        definition.to_edge(UP)\n",
        "\n",
        "        sucrose.add_updater(lambda m, dt: m.rotate(10 * DEGREES * dt, axis=OUT))\n",
        "        mirror_image.add_updater(lambda m, dt: m.rotate(-10 * DEGREES * dt, axis=OUT))\n",
        "        self.play(Write(definition))\n",
        "        self.play(\n",
        "            self.frame.animate.reorient(-8, 76, 0),\n",
        "            run_time=15,\n",
        "        )\n",
        "        self.wait(15)\n",
        "\n",
        "\n",
        "class SimplerChiralShape(InteractiveScene):\n",
        "    default_frame_orientation = (0, 70)\n",
        "\n",
        "    def construct(self):\n",
        "        # Ribbon\n",
        "        frame = self.frame\n",
        "        frame.set_field_of_view(1 * DEGREES)\n",
        "        axes = ThreeDAxes((-3, 3))\n",
        "        ribbon = TwistedRibbon(axes, amplitude=1, twist_rate=-0.35)\n",
        "        ribbon.rotate(PI / 2, DOWN)\n",
        "        ribbon.set_color(RED)\n",
        "        ribbon.set_opacity(0.9)\n",
        "        ribbon.set_shading(0.5, 0.5, 0.5)\n",
        "        always(ribbon.sort_faces_back_to_front, UP)\n",
        "        ribbon.set_x(-4)\n",
        "\n",
        "        mirror_image = ribbon.copy()\n",
        "        mirror_image.stretch(-1, 0)\n",
        "        mirror_image.set_x(-ribbon.get_x())\n",
        "        mirror_image.set_color(YELLOW_C)\n",
        "        mirror_image.set_opacity(0.9)\n",
        "\n",
        "        # Title\n",
        "        spiral_name = Text(\"Spiral\")\n",
        "        mirror_name = Text(\"Mirror image\")\n",
        "        for name, mob in [(spiral_name, ribbon), (mirror_name, mirror_image)]:\n",
        "            name.fix_in_frame()\n",
        "            name.to_edge(UP)\n",
        "            name.match_x(mob)\n",
        "\n",
        "        self.play(\n",
        "            FadeIn(spiral_name, 0.5 * UP),\n",
        "            ShowCreation(ribbon, run_time=3),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            ReplacementTransform(ribbon.copy().shift(0.1 * DOWN), mirror_image),\n",
        "            FadeTransformPieces(spiral_name.copy(), mirror_name),\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Reorient\n",
        "        r_copy = ribbon.copy()\n",
        "        self.play(r_copy.animate.next_to(mirror_image, LEFT))\n",
        "        self.play(Rotate(r_copy, PI, RIGHT, run_time=2))\n",
        "        self.play(Rotate(r_copy, PI, OUT, run_time=2))\n",
        "        self.play(Rotate(r_copy, PI, UP, run_time=2))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class SucroseAction(InteractiveScene):\n",
        "    just_sucrose = False\n",
        "\n",
        "    def construct(self):\n",
        "        # Sucrose\n",
        "        sucrose = Sucrose(height=1.5)\n",
        "        sucrose.balls.scale_radii(0.5)\n",
        "        sucrose.rotate(PI / 2, RIGHT)\n",
        "        sucrose.to_edge(LEFT)\n",
        "        sucrose.add_updater(lambda m, dt: m.rotate(10 * DEGREES * dt, UP))\n",
        "        if self.just_sucrose:\n",
        "            self.add(sucrose)\n",
        "            self.wait(36)\n",
        "            return\n",
        "\n",
        "        # Arrows\n",
        "        arrows = VGroup()\n",
        "        words = VGroup(\n",
        "            Text(\"The amount that sugar\\nslows this light...\"),\n",
        "            Text(\"...is different from how\\nit slows this light\"),\n",
        "        )\n",
        "        words.scale(0.75)\n",
        "        for sign, word in zip([+1, -1], words):\n",
        "            arrow = Line(ORIGIN, 5 * RIGHT + 1.5 * sign * UP, path_arc=-sign * 60 * DEGREES)\n",
        "            arrow.insert_n_curves(100)\n",
        "            arrow.add_tip(length=0.2, width=0.2)\n",
        "            arrow.shift(sucrose.get_right() + 0.5 * LEFT + sign * 1.25 * UP)\n",
        "            arrows.add(arrow)\n",
        "            word.next_to(arrow, sign * UP, buff=0.1)\n",
        "\n",
        "            self.play(\n",
        "                ShowCreation(arrow),\n",
        "                FadeIn(word, 0.25 * sign * UP)\n",
        "            )\n",
        "            self.wait(2)\n",
        "\n",
        "\n",
        "class SucroseActionSucrosePart(SucroseAction):\n",
        "    just_sucrose = True\n",
        "\n",
        "\n",
        "class ThatSeemsIrrelevant(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        stds = self.students\n",
        "        morty = self.teacher\n",
        "        self.play(\n",
        "            stds[0].says(\"That seems irrelevant\", mode=\"sassy\"),\n",
        "            self.change_students(None, \"erm\", \"hesitant\", look_at=stds[0].eyes),\n",
        "            morty.change(\"guilty\"),\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            stds[0].debubble(mode=\"raise_left_hand\", look_at=self.screen),\n",
        "            self.change_students(None, \"pondering\", \"pondering\", look_at=self.screen),\n",
        "        )\n",
        "        self.wait(5)\n",
        "\n",
        "\n",
        "class BigPlus(InteractiveScene):\n",
        "    def construct(self):\n",
        "        brace = Brace(Line(2 * DOWN, 2 * UP), RIGHT)\n",
        "        brace.set_height(7)\n",
        "        brace.move_to(2 * LEFT)\n",
        "        plus = Tex(\"+\", font_size=90)\n",
        "        plus.next_to(brace, LEFT, buff=2.5)\n",
        "        equals = Tex(\"=\", font_size=90)\n",
        "        equals.next_to(brace, RIGHT, buff=1.0)\n",
        "\n",
        "        self.add(plus, brace, equals)\n",
        "\n",
        "\n",
        "class CurvyCurvyArrow(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        kw = dict(path_arc=-PI, buff=0.2, stroke_width=30, tip_width_ratio=4)\n",
        "        arrows = VGroup(\n",
        "            Arrow(DOWN, UP, **kw),\n",
        "            Arrow(UP, DOWN, **kw),\n",
        "        )\n",
        "        arrows.set_color(WHITE)\n",
        "        arrows.set_height(5)\n",
        "        self.frame.reorient(-9, 75, 90)\n",
        "        self.frame.set_field_of_view(1 * DEGREES)\n",
        "        self.add(arrows)\n",
        "\n",
        "\n",
        "class GlowDot(InteractiveScene):\n",
        "    def construct(self):\n",
        "        self.add(GlowDot(radius=3, color=WHITE))\n",
        "\n",
        "        mid_point = 0.85 * LEFT\n",
        "        mask = VMobject().set_points_as_corners([\n",
        "            UR, mid_point, DR, DL, UL,\n",
        "        ])\n",
        "        mask.set_fill(BLACK, 1)\n",
        "        mask.set_stroke(width=0)\n",
        "        mask.set_height(20, about_point=mid_point)\n",
        "        self.add(mask)\n",
        "\n",
        "\n",
        "class Randy(InteractiveScene):\n",
        "    def construct(self):\n",
        "        self.add(Randolph(mode=\"confused\"))\n",
        "\n",
        "\n",
        "class EndScreen(PatreonEndScreen):\n",
        "    scroll_time = 25\n",
        "    show_pis = False\n",
        "    title_text = \"\"\n"
    ]
}