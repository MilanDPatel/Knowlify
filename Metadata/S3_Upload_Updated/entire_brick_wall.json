{
    "topic": "The mathematical concept being demonstrated is the construction of a brick wall with alternating colors and the counting of",
    "code": [
        "\n",
        "from manim_imports_ext import *\n",
        "from _2018.eop.reusable_imports import *\n",
        "from _2018.eop.chapter1.brick_row_scene import BrickRowScene\n",
        "\n",
        "class EntireBrickWall(BrickRowScene, MovingCameraScene):\n",
        "\n",
        "    def setup(self):\n",
        "        super(BrickRowScene, self).setup()\n",
        "        super(PiCreatureScene, self).setup()\n",
        "\n",
        "\n",
        "    def construct(self):\n",
        "\n",
        "        self.remove(self.get_primary_pi_creature())\n",
        "\n",
        "        row_height = 0.3\n",
        "        nb_rows = 20\n",
        "        start_point = 3 * UP + 1 * LEFT\n",
        "        \n",
        "        rows = VMobject()\n",
        "        rows.add(BrickRow(0, height = row_height))\n",
        "        rows.move_to(start_point)\n",
        "        self.add(rows)\n",
        "            \n",
        "        zero_counter = Integer(0).next_to(start_point + 0.5 * rows[0].width * RIGHT)\n",
        "        nb_flips_text = OldTexText(\"\\# of flips\")\n",
        "        nb_flips_text.next_to(zero_counter, RIGHT, buff = LARGE_BUFF)\n",
        "        self.add(zero_counter, nb_flips_text)\n",
        "        flip_counters = VGroup(zero_counter)\n",
        "\n",
        "        for i in range(1, nb_rows + 1):\n",
        "            rows.add(rows[-1].copy())\n",
        "            self.bring_to_back(rows[-1])\n",
        "            anims = [\n",
        "                rows[-1].shift, row_height * DOWN,\n",
        "                Animation(rows[-2])\n",
        "            ]\n",
        "            \n",
        "            if i % 5 == 0:\n",
        "                counter = Integer(i)\n",
        "                counter.next_to(rows[-1].get_right() + row_height * DOWN, RIGHT)\n",
        "                flip_counters.add(counter)\n",
        "                anims.append(FadeIn(counter))\n",
        "\n",
        "            self.play(*anims)\n",
        "\n",
        "            self.play(SplitRectsInBrickWall(rows[-1]))\n",
        "            rows.submobjects[-1] = self.merge_rects_by_subdiv(rows[-1])\n",
        "            rows.submobjects[-1] = self.merge_rects_by_coloring(rows[-1])\n",
        "\n",
        "\n",
        "        # draw indices under the last row for the number of tails\n",
        "        tails_counters = VGroup()\n",
        "        for (i, rect) in enumerate(rows[-1].rects):\n",
        "            if i < 6 or i > 14:\n",
        "                continue\n",
        "            if i == 6:\n",
        "                counter = OldTex(\"\\dots\", color = COLOR_TAILS)\n",
        "                counter.next_to(rect, DOWN, buff = 1.5 * MED_SMALL_BUFF)\n",
        "            elif i == 14:\n",
        "                counter = OldTex(\"\\dots\", color = COLOR_TAILS)\n",
        "                counter.next_to(rect, DOWN, buff = 1.5 * MED_SMALL_BUFF)\n",
        "                counter.shift(0.2 * RIGHT)\n",
        "            else:\n",
        "                counter = Integer(i, color = COLOR_TAILS)\n",
        "                counter.next_to(rect, DOWN)\n",
        "            tails_counters.add(counter)\n",
        "\n",
        "        nb_tails_text = OldTexText(\"\\# of tails\", color = COLOR_TAILS)\n",
        "        nb_tails_text.next_to(tails_counters[-1], RIGHT, buff = LARGE_BUFF)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeIn, tails_counters),\n",
        "            FadeIn(nb_tails_text)\n",
        "        )\n",
        "\n",
        "        # remove any hidden brick rows\n",
        "        self.clear()\n",
        "        self.add(nb_flips_text)\n",
        "\n",
        "        mobs_to_shift = VGroup(\n",
        "            rows, flip_counters, tails_counters, nb_tails_text, \n",
        "        )\n",
        "        self.play(mobs_to_shift.shift, 3 * UP)\n",
        "\n",
        "        last_row_rect = SurroundingRectangle(rows[-1], buff = 0)\n",
        "        last_row_rect.set_stroke(color = YELLOW, width = 6)\n",
        "\n",
        "        rows.save_state()\n",
        "        self.play(\n",
        "            rows.fade, 0.9,\n",
        "            ShowCreation(last_row_rect)\n",
        "        )\n",
        "\n",
        "        def highlighted_brick(row = 20, nb_tails = 10):\n",
        "            brick_copy = rows[row].rects[nb_tails].copy()\n",
        "            brick_copy.set_fill(color = YELLOW, opacity = 0.8)\n",
        "            prob_percentage = float(choose(row, nb_tails)) / 2**row * 100\n",
        "            brick_label = DecimalNumber(prob_percentage,\n",
        "                unit = \"\\%\", num_decimal_places = 1, color = BLACK)\n",
        "            brick_label.move_to(brick_copy)\n",
        "            brick_label.set_height(0.8 * brick_copy.get_height())\n",
        "            return VGroup(brick_copy, brick_label)\n",
        "\n",
        "        highlighted_bricks = [\n",
        "            highlighted_brick(row = 20, nb_tails = i)\n",
        "            for i in range(20)\n",
        "        ]\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeIn(highlighted_bricks[10])\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(highlighted_bricks[10]),\n",
        "            FadeIn(highlighted_bricks[9]),\n",
        "            FadeIn(highlighted_bricks[11]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(highlighted_bricks[9]),\n",
        "            FadeOut(highlighted_bricks[11]),\n",
        "            FadeIn(highlighted_bricks[8]),\n",
        "            FadeIn(highlighted_bricks[12]),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(highlighted_bricks[8]),\n",
        "            FadeOut(highlighted_bricks[12]),\n",
        "            FadeOut(last_row_rect),\n",
        "            rows.restore,\n",
        "        )\n",
        "        self.wait()\n",
        "        new_frame = self.camera_frame.copy()\n",
        "        new_frame.scale(0.0001).move_to(rows.get_corner(DR))\n",
        "\n",
        "        self.play(\n",
        "            Transform(self.camera_frame, new_frame,\n",
        "                run_time = 9,\n",
        "                rate_func = exponential_decay\n",
        "            )\n",
        "        )\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n",
        "\n"
    ]
}