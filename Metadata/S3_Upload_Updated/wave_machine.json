{
    "topic": "demonstrates the creation of a wave machine with multiple arms that oscillate in a sinus",
    "code": [
        "from manim_imports_ext import *\n",
        "\n",
        "\n",
        "class WaveMachine(Group):\n",
        "    def __init__(\n",
        "        self,\n",
        "        n_arms=100,\n",
        "        width=20,\n",
        "        delta_angle=2 * TAU / 50,\n",
        "        shaft_radius=0.1,\n",
        "        arm_radius=0.025,\n",
        "        arm_length=1.5,\n",
        "        arm_cap_radius=0.035,\n",
        "        shaft_color=GREY_D,\n",
        "        arm_color=GREY_BROWN,\n",
        "        cap_color=GREY_BROWN,\n",
        "    ):\n",
        "        shaft = Cylinder(\n",
        "            height=width,\n",
        "            radius=shaft_radius,\n",
        "            color=shaft_color,\n",
        "        )\n",
        "        for point in [shaft.get_zenith(), shaft.get_nadir()]:\n",
        "            disk = Circle(radius=shaft_radius)\n",
        "            disk.set_stroke(width=0)\n",
        "            disk.set_fill(shaft_color, 1)\n",
        "            disk.move_to(point)\n",
        "            shaft.add(disk)\n",
        "\n",
        "        angle = 0\n",
        "        arms = Group()\n",
        "        z_range = np.linspace(\n",
        "            shaft.get_z(IN) + arm_radius + 1e-2,\n",
        "            shaft.get_z(OUT) - arm_radius - 1e-2,\n",
        "            n_arms\n",
        "        )\n",
        "        for z in z_range:\n",
        "            arm = Cylinder(\n",
        "                height=arm_length,\n",
        "                radius=arm_radius,\n",
        "                color=arm_color,\n",
        "            )\n",
        "            arm.rotate(PI / 2, UP)\n",
        "            arm.next_to(ORIGIN, RIGHT, buff=0)\n",
        "            cap = Sphere(radius=arm_cap_radius, color=cap_color)\n",
        "            cap.move_to(arm.get_right())\n",
        "            # full_arm = Group(arm, cap)\n",
        "            full_arm = arm\n",
        "            full_arm.rotate(angle, about_point=ORIGIN)\n",
        "            full_arm.shift(z * OUT)\n",
        "            full_arm.angle = angle\n",
        "            arms.add(full_arm)\n",
        "\n",
        "            angle += delta_angle\n",
        "\n",
        "        super().__init__(shaft, arms)\n",
        "        self.shaft = shaft\n",
        "        self.arms = arms\n",
        "        self.rotate(PI / 2, UP)\n",
        "\n",
        "\n",
        "\n",
        "class WaveMachineDemo(InteractiveScene, ThreeDScene):\n",
        "    def construct(self):\n",
        "        # Add axes (or don't!)\n",
        "        frame = self.frame\n",
        "        axes = ThreeDAxes(width=14)\n",
        "        axes.set_stroke(width=1)\n",
        "\n",
        "        plane = NumberPlane(\n",
        "            background_line_style=dict(stroke_color=BLUE_D, stroke_width=1),\n",
        "            faded_line_style=dict(stroke_color=BLUE_D, stroke_width=0.5, stroke_opacity=0.25),\n",
        "        )\n",
        "        plane.axes.set_stroke(BLUE_D, 1)\n",
        "        plane.set_width(14)\n",
        "\n",
        "        # Add machine\n",
        "        machine = WaveMachine(width=14, delta_angle=2 * TAU / 25)\n",
        "        self.add(machine)\n",
        "\n",
        "        frame.set_field_of_view(0.2)\n",
        "        frame.reorient(-68, 79, 0).move_to([-2.41, 1.04, -0.68])\n",
        "        self.play(\n",
        "            frame.animate.reorient(0, 78, 0).move_to([-0.0, 0.01, 0.02]).set_height(9.5),\n",
        "            LaggedStartMap(ShowCreation, machine.arms, lag_ratio=0.1),\n",
        "            run_time=9,\n",
        "        )\n",
        "        self.play(\n",
        "            Rotating(machine, 5 * TAU, RIGHT, ORIGIN, run_time=20),\n",
        "        )\n",
        "\n",
        "        # Reposition\n",
        "        machine2 = WaveMachine(width=14, delta_angle=2 * TAU / 100)\n",
        "\n",
        "        self.play(\n",
        "            frame.animate.reorient(-80, 88, 0).move_to([0.21, -0.56, 0.39]).set_height(11.11),\n",
        "            run_time=2\n",
        "        )\n",
        "        self.play(*(\n",
        "            Transform(arm1, arm2, path_arc=arm2.angle - arm1.angle, path_arc_axis=RIGHT, run_time=3)\n",
        "            for arm1, arm2 in zip(machine.arms, machine2.arms)\n",
        "        ))\n",
        "        self.play(\n",
        "            frame.animate.reorient(0, 78, 0).move_to([-0.0, 0.01, 0.02]).set_height(9.5),\n",
        "            run_time=2\n",
        "        )\n",
        "        self.play(\n",
        "            Rotating(machine, 5 * TAU, RIGHT, ORIGIN, run_time=20),\n",
        "        )\n",
        "\n",
        "        # Yet another\n",
        "        machine3 = WaveMachine(width=14, delta_angle=2 * TAU / 200)\n",
        "        self.play(*(\n",
        "            Transform(arm1, arm3, path_arc=arm3.angle - arm2.angle, path_arc_axis=RIGHT)\n",
        "            for arm1, arm2, arm3 in zip(machine.arms, machine2.arms, machine3.arms)\n",
        "        ))\n",
        "\n",
        "        self.play(\n",
        "            Rotating(machine, 5 * TAU, RIGHT, ORIGIN, run_time=20),\n",
        "        )\n",
        "\n",
        "    def get_rotation_arrow_animations(self, x_value=6):\n",
        "        rot_arrows = VGroup(\n",
        "            Arrow(RIGHT, LEFT, path_arc=PI, stroke_width=8),\n",
        "            Arrow(LEFT, RIGHT, path_arc=PI, stroke_width=8),\n",
        "        )\n",
        "        rot_arrows.set_height(3)\n",
        "        rot_arrows.rotate(PI / 2, RIGHT)\n",
        "        rot_arrows.rotate(PI / 2, OUT)\n",
        "        rot_arrows.set_flat_stroke(True)\n",
        "        rot_arrows.set_x(-x_value)\n",
        "        rot_arrows.add(*rot_arrows.copy().set_x(x_value))\n",
        "\n",
        "        return (\n",
        "            Succession(\n",
        "                ShowCreation(arrow),\n",
        "                Animation(arrow),\n",
        "                arrow.animate.set_stroke(BLACK, opacity=0),\n",
        "                run_time=3,\n",
        "                remover=True\n",
        "            )\n",
        "            for arrow in rot_arrows\n",
        "        )\n",
        "        \n",
        "\n"
    ]
}