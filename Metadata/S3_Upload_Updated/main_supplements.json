{
    "topic": "* Demonstrate the Laplace transform.",
    "code": [
        "from manim_imports_ext import *\n",
        "from _2025.laplace.integration import get_complex_graph\n",
        "\n",
        "\n",
        "class WriteLaplace(InteractiveScene):\n",
        "    def construct(self):\n",
        "        title = Text(\"Laplace Transform\", font_size=72)\n",
        "        title.to_edge(UP)\n",
        "        self.play(Write(title))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class TwoLevels(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        words = VGroup(\n",
        "            Text(\"Solve equations\"),\n",
        "            Text(\"See what it\u2019s doing\"),\n",
        "        )\n",
        "        words.scale(1.5)\n",
        "        for word, y in zip(words, (2, -2)):\n",
        "            word.set_y(y)\n",
        "            word.to_edge(LEFT, buff=LARGE_BUFF)\n",
        "            self.play(Write(word))\n",
        "            self.wait()\n",
        "\n",
        "\n",
        "class TwoKeyIdeas(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        t2c = {\"{s}\": YELLOW, \"{s_n}\": YELLOW, \"{t}\": BLUE}\n",
        "        title = Text(\"Key ideas from the last chapter\", font_size=72)\n",
        "        title.to_edge(UP)\n",
        "        underline = Underline(title, buff=-0.05)\n",
        "\n",
        "        self.add(title, underline)\n",
        "\n",
        "        ideas = VGroup(\n",
        "            TexText(R\"1) How to think about $e^{{s}{t}}$\", t2c=t2c),\n",
        "            TexText(R\"2) Often, for functions in physics, $\\displaystyle f({t}) = \\sum_{n=1}^N c_n e^{{s_n} {t}}$\", t2c=t2c),\n",
        "        )\n",
        "        for idea in ideas:\n",
        "            idea[:2].scale(1.25, about_edge=RIGHT)\n",
        "        ideas[0][R\"$e^{{s}{t}}$\"].scale(1.5, about_edge=DL)\n",
        "        ideas.arrange(DOWN, aligned_edge=LEFT, buff=LARGE_BUFF)\n",
        "        ideas.to_edge(LEFT)\n",
        "\n",
        "        numbers = VGroup(idea[:2] for idea in ideas)\n",
        "        words = VGroup(idea[2:] for idea in ideas)\n",
        "\n",
        "        self.play(LaggedStartMap(FadeIn, numbers, shift=LEFT, lag_ratio=0.5))\n",
        "        self.wait()\n",
        "        for word in words:\n",
        "            self.play(Write(word))\n",
        "            self.wait()\n",
        "\n",
        "\n",
        "class LevelsOfUnderstanding(InteractiveScene):\n",
        "    def construct(self):\n",
        "        items = BulletedList(\n",
        "            \"1) Use\",\n",
        "            \"2) Dissect\",\n",
        "            \"3) Reinvent\",\n",
        "            font_size=72,\n",
        "            buff=2\n",
        "        )\n",
        "        numbers = VGroup()\n",
        "        words = VGroup()\n",
        "        for item in items:\n",
        "            item[0].scale(0).set_opacity(0)\n",
        "            numbers.add(item[1:3])\n",
        "            words.add(item[3:])\n",
        "        items.to_edge(LEFT)\n",
        "\n",
        "        self.play(LaggedStartMap(FadeIn, numbers, shift=DOWN, lag_ratio=0.35))\n",
        "        self.wait()\n",
        "        for word in words:\n",
        "            self.play(Write(word))\n",
        "            self.wait()\n",
        "\n",
        "\n",
        "class DrivingACar(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        car = Car()\n",
        "        car.move_to(4 * LEFT)\n",
        "        car[0][2].set_fill(BLUE).insert_n_curves(100)\n",
        "        self.add(car)\n",
        "        self.play(MoveCar(4 * RIGHT), run_time=10)\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class WhatIsItTryingToDo2(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "        for pi in self.pi_creatures:\n",
        "            pi.body.insert_n_curves(1000)\n",
        "\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\", look_at=3 * UP),\n",
        "            self.change_students(\"thinking\", \"confused\", \"pondering\", look_at=3 * UR)\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(LaggedStart(\n",
        "            stds[0].change(\"pondering\", morty.eyes),\n",
        "            stds[1].says(\"What does it\\nactually do?\", mode=\"raise_left_hand\", look_at=morty.eyes),\n",
        "            stds[2].change(\"hesitant\", morty.eyes),\n",
        "            morty.change(\"tease\"),\n",
        "            lag_ratio=0.3\n",
        "        ))\n",
        "        self.wait(4)\n",
        "\n",
        "        # Test2\n",
        "        self.play(\n",
        "            stds[0].change(\"pondering\", 3 * UP),\n",
        "            stds[1].debubble(look_at=3 * UP),\n",
        "            stds[2].change(\"pondering\", 3 * UP),\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class ReferenceComplexExponents(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        for pi in self.pi_creatures:\n",
        "            pi.body.insert_n_curves(500)\n",
        "\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            self.change_students('pondering', 'thinking', 'tease', look_at=self.screen)\n",
        "        )\n",
        "        self.wait(3)\n",
        "        self.play(self.change_students('tease', 'tease', 'confused', look_at=self.screen))\n",
        "        self.wait(2)\n",
        "        self.play(self.change_students('thinking', 'tease', 'erm', look_at=self.screen))\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            morty.change('hesitant', stds[2].eyes),\n",
        "            stds[2].says(\"Why?\", mode='maybe', bubble_direction=LEFT),\n",
        "        )\n",
        "        self.wait(3)\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            stds[2].debubble(mode=\"pondering\", look_at=3 * UR),\n",
        "            stds[0].change(\"pondering\", look_at=3 * UR),\n",
        "            stds[1].change(\"hesitant\", look_at=3 * UR),\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class ReferenceWorkedExample(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        rect = Rectangle(8, 1.5)\n",
        "        rect.next_to(morty, UP).to_edge(RIGHT).shift(UP)\n",
        "        rect.set_stroke(YELLOW, 2)\n",
        "        self.play(\n",
        "            morty.change(\"raise_left_hand\", rect),\n",
        "            self.change_students(\"pondering\", \"thinking\", \"erm\", look_at=rect),\n",
        "        )\n",
        "        self.play(ShowCreation(rect))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\", self.screen),\n",
        "            FadeOut(rect),\n",
        "            self.change_students(\"pondering\", \"pondering\", \"pondering\", look_at=self.screen)\n",
        "        )\n",
        "        self.wait(7)\n",
        "\n",
        "\n",
        "class ButWhatIsIt(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        self.play(\n",
        "            stds[0].change(\"erm\", self.screen),\n",
        "            stds[1].says(\"But, what is it?\", mode=\"maybe\", bubble_direction=LEFT),\n",
        "            stds[2].change(\"sassy\", self.screen),\n",
        "            morty.change(\"guilty\"),\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\", 2 * UR),\n",
        "            stds[0].change(\"pondering\", 2 * UR),\n",
        "            stds[1].debubble(mode=\"pondering\", look_at=2 * UR),\n",
        "            stds[2].change(\"pondering\", 2 * UR),\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class MoreInAMoment(InteractiveScene):\n",
        "    def construct(self):\n",
        "        morty = Mortimer()\n",
        "        morty.body.insert_n_curves(1000)\n",
        "        self.play(morty.says(\"Much, much more on\\nthis in a moment\"))\n",
        "        self.play(morty.change(\"tease\"))\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class YouAsAMathematician(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        randy = Randolph(height=2.5)\n",
        "        randy.flip()\n",
        "        randy.to_edge(DOWN, buff=MED_SMALL_BUFF)\n",
        "\n",
        "        you = Text(\"You\")\n",
        "        you.next_to(randy, UR, LARGE_BUFF)\n",
        "        mathematician = Text(\"(Mathematician)\")\n",
        "        mathematician.next_to(you, DOWN, aligned_edge=LEFT)\n",
        "        arrow = Arrow(you.get_corner(DL), randy.body.get_corner(UR) + 0.7 * LEFT, buff=0.1, thickness=5)\n",
        "\n",
        "        self.play(\n",
        "            randy.change('pondering', 3 * UL),\n",
        "            GrowArrow(arrow),\n",
        "            Write(you)\n",
        "        )\n",
        "        self.play(FadeIn(mathematician, 0.25 * DOWN))\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "\n",
        "        # Reference machine\n",
        "        label = VGroup(you, mathematician)\n",
        "        self.play(\n",
        "            randy.change(\"raise_left_hand\", 3 * UR),\n",
        "            label.animate.next_to(randy, RIGHT).set_opacity(0.5),\n",
        "            FadeOut(arrow, scale=0.5, shift=DL),\n",
        "        )\n",
        "        self.play(Blink(randy))\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            randy.change(\"hesitant\", 3 * UL)\n",
        "        )\n",
        "        for _ in range(2):\n",
        "            self.play(Blink(randy))\n",
        "            self.wait(2)\n",
        "        self.play(randy.change(\"pondering\", 3 * UL))\n",
        "        for _ in range(2):\n",
        "            self.play(Blink(randy))\n",
        "\n",
        "\n",
        "class FullCosInsideSum(InteractiveScene):\n",
        "    def construct(self):\n",
        "        tex = Tex(R\"\\frac{1}{2} \\left( e^{(i - {s}){t}} + e^{(\\minus i - {s}){t}} \\right)\", t2c={\"{t}\": BLUE, \"{s}\": YELLOW})\n",
        "        self.add(tex)\n",
        "\n",
        "\n",
        "class ReferenceTheIntegral(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        # React to the preview\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        self.play(\n",
        "            morty.change(\"guilty\"),\n",
        "            self.change_students(\"confused\", \"concentrating\", \"pleading\", look_at=self.screen)\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "        # Show expression\n",
        "        t2c = {\"{s}\": YELLOW, \"{t}\": BLUE}\n",
        "        lt_def = Tex(R\"F({s}) = \\int^\\infty_0 f({t}) e^{\\minus {s} {t}} d{t}\", t2c=t2c)\n",
        "        lt_def.move_to(self.hold_up_spot, DOWN)\n",
        "        lt_def.shift(0.5 * DOWN)\n",
        "\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\", look_at=lt_def),\n",
        "            FadeIn(lt_def, UP),\n",
        "            self.change_students(\"confused\", \"tease\", \"happy\", look_at=lt_def)\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        # Highlight integral\n",
        "        int_rect = SurroundingRectangle(lt_def[R\"\\int^\\infty_0\"])\n",
        "        body_rect = SurroundingRectangle(lt_def[R\"f({t}) e^{\\minus {s} {t}}\"])\n",
        "        VGroup(int_rect, body_rect).set_stroke(TEAL, 2)\n",
        "        arrow = Vector(0.75 * DOWN, thickness=6)\n",
        "        arrow.set_fill(TEAL)\n",
        "        arrow.next_to(int_rect, UP)\n",
        "\n",
        "        self.play(\n",
        "            morty.change(\"hesitant\", int_rect),\n",
        "            ShowCreation(int_rect),\n",
        "            GrowArrow(arrow),\n",
        "            self.change_students(\"pondering\", \"happy\", \"tease\"),\n",
        "        )\n",
        "        self.wait(2)\n",
        "\n",
        "        # Show complex plane\n",
        "        s_plane = ComplexPlane((-2, 2), (-2, 2))\n",
        "        s_plane.add_coordinate_labels(font_size=16)\n",
        "        s_plane.set_width(2.5)\n",
        "        s_plane.next_to(body_rect, UP, LARGE_BUFF)\n",
        "        s_plane.shift_onto_screen()\n",
        "        s_plane.to_edge(UP, SMALL_BUFF)\n",
        "\n",
        "        s = complex(-0.1, 1.5)\n",
        "        t_max = 20\n",
        "        func_path = ParametricCurve(\n",
        "            lambda t: s_plane.n2p(2 * math.cos(t) * np.exp(s * t)),\n",
        "            t_range=(1e-3, t_max, 0.1),\n",
        "        )\n",
        "        func_path.set_stroke(YELLOW, 2)\n",
        "        dot = GlowDot()\n",
        "        dot.move_to(func_path.get_start())\n",
        "        tail = TracedPath(dot.get_center, stroke_color=YELLOW, time_traced=5)\n",
        "        tail.add_updater(lambda m: m.set_stroke(YELLOW, width=(0, 3)))\n",
        "        for t in range(30):\n",
        "            tail.update(1 / 30)\n",
        "\n",
        "        self.play(\n",
        "            morty.change(\"raise_left_hand\", s_plane),\n",
        "            self.change_students(\"erm\", \"confused\", \"sassy\", s_plane),\n",
        "            arrow.animate.rotate(PI).scale(0.75).next_to(body_rect, UP).set_anim_args(path_arc=90 * DEG),\n",
        "            ReplacementTransform(int_rect, body_rect),\n",
        "        )\n",
        "        self.add(tail)\n",
        "        self.play(\n",
        "            FadeIn(s_plane),\n",
        "            MoveAlongPath(dot, func_path, run_time=10, rate_func=linear),\n",
        "        )\n",
        "\n",
        "        # Clear the board\n",
        "        self.play(\n",
        "            VFadeOut(tail),\n",
        "            FadeOut(body_rect),\n",
        "            FadeOut(arrow),\n",
        "            FadeOut(s_plane),\n",
        "            FadeOut(dot),\n",
        "            lt_def.animate.move_to(2 * UP),\n",
        "            morty.change(\"tease\", look_at=2 * UP),\n",
        "            self.change_students(\"pondering\", \"pondering\", \"pondering\", look_at=2 * UP)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Remove f(t)\n",
        "        lt_def.save_state()\n",
        "        ft = lt_def[R\"f({t})\"][0]\n",
        "        ft_rect = SurroundingRectangle(ft, buff=0.05)\n",
        "        ft_rect.set_stroke(RED, 2)\n",
        "        self.play(\n",
        "            ShowCreation(ft_rect)\n",
        "        )\n",
        "        self.play(\n",
        "            VGroup(ft_rect, ft).animate.to_corner(UL).set_stroke(width=0).fade(0.5),\n",
        "            lt_def[R\"e^{\\minus {s} {t}} d{t}\"].animate.align_to(ft, LEFT).shift(SMALL_BUFF * LEFT),\n",
        "            lt_def[\"F({s}) = \"].animate.set_fill(opacity=0),\n",
        "        )\n",
        "        self.wait(5)\n",
        "\n",
        "        # Bring back the definition\n",
        "        exp_int = VGroup(*lt_def[R\"\\int^\\infty_0\"][0], *lt_def[R\"e^{\\minus {s} {t}} d{t}\"]).copy()\n",
        "        exp_int_rhs = Tex(R\"= \\frac{1}{{s}}\", t2c=t2c)\n",
        "        exp_int_rhs.next_to(exp_int, RIGHT)\n",
        "        exp_int_rhs.save_state()\n",
        "        exp_int_rhs.move_to(morty.get_corner(UL)).set_fill(opacity=0)\n",
        "        morty.body.insert_n_curves(500)\n",
        "        exp_int.add(*exp_int_rhs)\n",
        "\n",
        "        ft2, arrow, fancy_L = new_def_lhs = VGroup(\n",
        "            Tex(R\"f({t})\", t2c=t2c),\n",
        "            Vector(1.5 * RIGHT),\n",
        "            Tex(R\"\\mathcal{L}\"),\n",
        "        )\n",
        "        arrow.next_to(lt_def[R\"\\int\"], LEFT)\n",
        "        fancy_L.next_to(arrow, UP, SMALL_BUFF)\n",
        "        ft2.next_to(arrow, LEFT)\n",
        "\n",
        "        lt_def.saved_state[:5].set_opacity(0)\n",
        "\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\", exp_int_rhs),\n",
        "            Restore(exp_int_rhs)\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            exp_int.animate.scale(0.5).fade(0.5).to_corner(UR),\n",
        "            Restore(lt_def),\n",
        "            self.change_students(\"confused\", \"erm\", \"sassy\", look_at=exp_int),\n",
        "            morty.change(\"guilty\", stds[2].eyes),\n",
        "            Write(new_def_lhs),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformFromCopy(ft2, ft, path_arc=PI / 2)\n",
        "        )\n",
        "        self.wait(3)\n",
        "\n",
        "        # Substitute in an exponential\n",
        "        exp1, exp2 = exp_examples = Tex(R\"e^{1.5{t}}\", t2c=t2c).replicate(2)\n",
        "        ft.refresh_bounding_box()\n",
        "        exp1.move_to(ft2)\n",
        "        exp2.move_to(ft)\n",
        "        exp_examples.align_to(lt_def[\"e\"], DOWN)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStart(\n",
        "                FadeOut(ft2, 0.5 * UP),\n",
        "                FadeIn(exp1, 0.5 * UP),\n",
        "                FadeOut(ft, 0.5 * UP),\n",
        "                FadeIn(exp2, 0.5 * UP),\n",
        "                lag_ratio=0.25\n",
        "            ),\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            self.change_students(\"pondering\", \"thinking\", \"tease\")\n",
        "        )\n",
        "        self.wait(4)\n",
        "\n",
        "        # Collapse the inside\n",
        "        lt_def[\"f({t})\"].set_fill(opacity=0)\n",
        "        new_int = Tex(R\"\\int^\\infty_0 e^{(1.5 - {s}){t}} d{t}\", t2c=t2c)\n",
        "        new_int.move_to(lt_def[R\"\\int\"], LEFT).shift(1.0 * DOWN)\n",
        "        new_int2 = Tex(R\"\\int^\\infty_0 e^{\\minus({s} - 1.5){t}} d{t}\", t2c=t2c)\n",
        "        new_int2.move_to(new_int)\n",
        "\n",
        "        self.play(\n",
        "            VGroup(exp_examples, arrow, fancy_L, lt_def).animate.to_edge(UP),\n",
        "            FadeIn(new_int, DOWN),\n",
        "            self.change_students(\"pondering\", \"pondering\", \"pondering\", new_int),\n",
        "            morty.change(\"tease\", new_int),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(TransformMatchingTex(new_int, new_int2, path_arc=90 * DEG))\n",
        "        self.wait()\n",
        "\n",
        "        # Show the answer\n",
        "        exp_int.target = exp_int.generate_target()\n",
        "        exp_int.target.scale(1.5, about_edge=UR)\n",
        "        exp_int.target.set_opacity(1)\n",
        "        exp_int_rect = SurroundingRectangle(exp_int.target, buff=MED_SMALL_BUFF)\n",
        "        exp_int_rect.set_stroke(YELLOW, 2)\n",
        "\n",
        "        example_rhs = Tex(R\"= {1 \\over {s} - 1.5}\", t2c=t2c)\n",
        "        example_rhs.next_to(new_int2[-1], RIGHT)\n",
        "\n",
        "        self.play(\n",
        "            morty.change('raise_left_hand', exp_int),\n",
        "            MoveToTarget(exp_int),\n",
        "            ShowCreation(exp_int_rect),\n",
        "            self.change_students(\"pondering\", \"thinking\", \"happy\", look_at=exp_int),\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformMatchingShapes(exp_int[-4:], example_rhs),\n",
        "            FadeOut(exp_int[:-4]),\n",
        "            exp_int_rect.animate.surround(example_rhs, buff=SMALL_BUFF),\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            run_time=1.5,\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Label it as pole\n",
        "        words = Text(\"Pole at 1.5\")\n",
        "        words.next_to(exp_int_rect, UP)\n",
        "        words.match_x(example_rhs[1:])\n",
        "        words.set_color(YELLOW)\n",
        "\n",
        "        self.play(\n",
        "            Write(words),\n",
        "            exp_int_rect.animate.surround(example_rhs[1:], buff=SMALL_BUFF),\n",
        "            morty.change(\"tease\", words),\n",
        "        )\n",
        "        self.wait(3)\n",
        "        self.play(\n",
        "            FadeOut(exp_int_rect),\n",
        "            FadeOut(words),\n",
        "        )\n",
        "\n",
        "        # Make it general\n",
        "        srcs = VGroup(exp1, exp2, new_int2, example_rhs)\n",
        "        trgs = VGroup(\n",
        "            Tex(R\"e^{a{t}}\", t2c=t2c),\n",
        "            Tex(R\"e^{a{t}}\", t2c=t2c),\n",
        "            Tex(R\"\\int^\\infty_0 e^{\\minus(s - a){t}} d{t}\", t2c=t2c),\n",
        "            Tex(R\"= {1 \\over {s} - a}\", t2c=t2c),\n",
        "        )\n",
        "        example_rects = VGroup(\n",
        "            SurroundingRectangle(src[\"1.5\"], buff=0.05)\n",
        "            for src in srcs\n",
        "        )\n",
        "        example_rects.set_stroke(TEAL, 2)\n",
        "        for src, trg in zip(srcs, trgs):\n",
        "            trg.move_to(src)\n",
        "\n",
        "        self.play(Write(example_rects))\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            FadeOut(example_rects),\n",
        "            LaggedStart(\n",
        "                (TransformMatchingTex(src, trg, key_map={\"1.5\": \"a\"})\n",
        "                for src, trg in zip(srcs, trgs)),\n",
        "                lag_ratio=0.2,\n",
        "                run_time=1.5,\n",
        "            )\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "        # Write conclusion\n",
        "        new_rhs = trgs[3]\n",
        "\n",
        "        self.play(\n",
        "            FadeOut(trgs[2]),\n",
        "            new_rhs.animate.next_to(lt_def, RIGHT),\n",
        "            self.change_students(\"thinking\", \"happy\", \"tease\", look_at=new_rhs),\n",
        "            morty.change(\"raise_right_hand\", new_rhs),\n",
        "        )\n",
        "\n",
        "        big_arrow = Arrow(trgs[0].get_bottom(), new_rhs.get_bottom(), path_arc=90 * DEG, thickness=5)\n",
        "        words = TexText(R\"Exponentials $\\longrightarrow$ Poles\")\n",
        "        words.next_to(big_arrow, DOWN)\n",
        "\n",
        "        self.play(\n",
        "            Write(big_arrow),\n",
        "            FadeIn(words, lag_ratio=0.1),\n",
        "        )\n",
        "        self.look_at(words)\n",
        "        self.wait(3)\n",
        "\n",
        "        # Clear\n",
        "        self.remove(self.background)\n",
        "        self.remove(self.pi_creatures)\n",
        "\n",
        "\n",
        "class TryADifferentInterpretation(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        morty = self.teacher\n",
        "        self.play(\n",
        "            morty.says(\"Let\u2019s try an\\nalternate\\ninterpretation\"),\n",
        "            self.change_students(\"pondering\", \"thinking\", \"pondering\", look_at=self.screen)\n",
        "        )\n",
        "        self.wait(2)\n",
        "        self.play(self.change_students(\"maybe\", \"pondering\", \"thinking\", look_at=self.screen))\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class AskAboutZero(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        randy = Randolph(height=2)\n",
        "        self.play(randy.says(Tex(R\"s = 0 ?\"), mode=\"erm\", look_at=3 * UP + 0.5 * RIGHT))\n",
        "        for _ in range(2):\n",
        "            self.play(Blink(randy))\n",
        "            self.wait(2)\n",
        "\n",
        "\n",
        "class SeemsDumbAndPointless(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        self.play(LaggedStart(\n",
        "            stds[0].says(\"Seems dumb\", mode=\"sassy\", look_at=self.screen),\n",
        "            Animation(Point()),\n",
        "            stds[2].animate.look_at(self.screen),\n",
        "            morty.change('guilty'),\n",
        "            stds[1].says(\n",
        "                \"And pointless!\",\n",
        "                mode=\"maybe\",\n",
        "                look_at=self.screen,\n",
        "                bubble_direction=LEFT,\n",
        "                bubble_creation_class=FadeIn\n",
        "            ),\n",
        "            # stds[1].animate.look_at(self.screen),\n",
        "            lag_ratio=0.25\n",
        "        ))\n",
        "        self.wait(7)\n",
        "\n",
        "        # Show Analytic Continuation\n",
        "        words = Text(\"Analytic\\nContinuation\", font_size=60)\n",
        "        words.next_to(morty, UP, LARGE_BUFF)\n",
        "        words.match_x(morty.get_left())\n",
        "\n",
        "        self.wait(2)\n",
        "        self.play(\n",
        "            stds[0].debubble(\"pondering\", look_at=words),\n",
        "            stds[1].debubble(\"pondering\", look_at=words),\n",
        "            stds[2].change(\"pondering\", words),\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            Write(words),\n",
        "        )\n",
        "        self.wait(7)\n",
        "\n",
        "\n",
        "class ReferenceAnalyticContinuation(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "        for pi in self.pi_creatures:\n",
        "            pi.body.insert_n_curves(1000)\n",
        "        words = Text(\"Analytic\\nContinuation\", font_size=60)\n",
        "        words.next_to(morty, UP, LARGE_BUFF)\n",
        "        words.match_x(morty.get_left())\n",
        "\n",
        "        self.play(\n",
        "            self.change_students(\"pondering\", \"pondering\", 'pondering', look_at=self.screen),\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            Write(words),\n",
        "        )\n",
        "        self.wait(4)\n",
        "        self.play(self.change_students(\"erm\", \"thinking\", \"pondering\", look_at=self.screen))\n",
        "        self.wait(4)\n",
        "        self.play(self.change_students(\"pondering\", \"tease\", \"thinking\", look_at=self.screen))\n",
        "        self.wait(4)\n",
        "\n",
        "\n",
        "class PreviewAnalyticContinuation(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        frame = self.frame\n",
        "        plane = ComplexPlane((-3, 3), (-3, 3))\n",
        "        plane.add_coordinate_labels(font_size=16)\n",
        "\n",
        "        pole_values = [1 - 2.0j, -1 - 2.0j, 2 + 1j, -2 + 1j, 2.5j]\n",
        "        graph = get_complex_graph(\n",
        "            plane,\n",
        "            lambda s: -1 * sum((np.divide(1, (s - p)) for p in pole_values))\n",
        "        )\n",
        "        graph.rotate(90 * DEG, about_point=plane.n2p(0))\n",
        "        graph.sort_faces_back_to_front(DOWN)\n",
        "        graph.set_opacity(0.8)\n",
        "\n",
        "        frame.reorient(-1, 75, 0, (0.35, 0.49, 1.27), 7.85)\n",
        "        self.add(plane, graph)\n",
        "        self.play(\n",
        "            ShowCreation(graph),\n",
        "            frame.animate.reorient(-24, 72, 0, (0.97, 0.24, 0.97), 9.65),\n",
        "            run_time=12\n",
        "        )\n",
        "\n",
        "\n",
        "class SimpleRect(InteractiveScene):\n",
        "    def construct(self):\n",
        "        rect = Rectangle(4.5, 2)\n",
        "        rect.set_stroke(YELLOW, 2)\n",
        "\n",
        "        self.play(ShowCreation(rect))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class ReactingToCosineMachine(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        randy = Randolph()\n",
        "        randy.flip()\n",
        "        randy.to_edge(RIGHT)\n",
        "        randy.shift(DOWN)\n",
        "\n",
        "        for mode in [\"erm\", \"confused\"]:\n",
        "            self.play(randy.change(mode))\n",
        "            self.play(Blink(randy))\n",
        "            self.wait(2)\n",
        "\n",
        "        # Consider expression\n",
        "        randy.body.insert_n_curves(500)\n",
        "        self.play(randy.change(\"thinking\", look_at=3 * UR))\n",
        "        self.play(Blink(randy))\n",
        "        self.wait()\n",
        "        self.play(randy.change(\"tease\", look_at=randy.get_top() + 2 * UP))\n",
        "        self.play(Blink(randy))\n",
        "        self.wait(5)\n",
        "\n",
        "\n",
        "class PonderingCosineMachine(InteractiveScene):\n",
        "    def construct(self):\n",
        "        morty = Mortimer(height=1.5)\n",
        "        morty.flip()\n",
        "        morty.to_corner(UL)\n",
        "\n",
        "        for mode in [\"tease\", \"pondering\"]:\n",
        "            self.play(morty.change(mode, look_at=ORIGIN))\n",
        "            self.play(Blink(morty))\n",
        "            self.wait(2)\n",
        "\n",
        "\n",
        "class LaplaceFourierContrast(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Titles and definitions\n",
        "        self.add(FullScreenRectangle())\n",
        "\n",
        "        titles = VGroup(\n",
        "            Text(\"Laplace Transform\"),\n",
        "            Text(\"Fourier Transform\"),\n",
        "        )\n",
        "        t2c = {\"{t}\": BLUE, \"{s}\": YELLOW, R\"\\xi\": RED}\n",
        "        formulas = VGroup(\n",
        "            Tex(R\"F({s}) = \\int^\\infty_0 f({t}) e^{\\minus {s}{t}} d{t}\", t2c=t2c),\n",
        "            Tex(R\"\\hat f(\\xi) = \\int^\\infty_{\\minus \\infty} f({t}) e^{\\minus 2\\pi i \\xi {t}} d{t}\", t2c=t2c),\n",
        "        )\n",
        "        formulas.scale(0.75)\n",
        "\n",
        "        for title, formula, sign in zip(titles, formulas, [-1, 1]):\n",
        "            for mob in [title, formula]:\n",
        "                mob.next_to(1.5 * UP, UP)\n",
        "                mob.set_x(sign * FRAME_WIDTH / 4)\n",
        "        titles[0].align_to(titles[1], UP)\n",
        "\n",
        "        self.play(\n",
        "            LaggedStartMap(FadeIn, titles, shift=0.5 * UP, lag_ratio=0.5)\n",
        "        )\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            titles.animate.to_edge(UP),\n",
        "            FadeIn(formulas, 0.5 * UP)\n",
        "        )\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class NotWhatYouWouldSee(InteractiveScene):\n",
        "    def construct(self):\n",
        "        morty = Mortimer().flip()\n",
        "        morty.to_corner(DL)\n",
        "        self.play(\n",
        "            morty.says(\"Not the\\nstandard form\", mode=\"hesitant\")\n",
        "        )\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "        self.play(morty.debubble(mode=\"pondering\", look_at=5 * UL))\n",
        "        self.play(Blink(morty))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class CosLTLogicReversal(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        self.add(FullScreenRectangle().set_fill(GREY_E, 0.5))\n",
        "        arrow = Tex(R\"\\rightarrow\", font_size=120)\n",
        "        cos_lt = Tex(\n",
        "            R\"\\frac{s}{s^2 + \\omega^2}\",\n",
        "            font_size=90,\n",
        "            t2c={\"s\": YELLOW, R\"\\omega\": PINK}\n",
        "        )\n",
        "        cos_lt.next_to(arrow, RIGHT, LARGE_BUFF)\n",
        "\n",
        "        self.add(arrow, cos_lt)\n",
        "        self.wait()\n",
        "        self.play(cos_lt.animate.next_to(arrow, LEFT, LARGE_BUFF).set_anim_args(path_arc=120 * DEG), run_time=3)\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class CosineEqualsWhat(InteractiveScene):\n",
        "    def construct(self):\n",
        "        self.add(FullScreenRectangle().set_fill(GREY_E, 0.5))\n",
        "        cos = Tex(R\"\\cos(t) = ???\", font_size=90, t2c={\"t\": BLUE})\n",
        "        q_marks = cos[\"???\"][0]\n",
        "        q_marks.scale(1.2, about_edge=UL)\n",
        "        q_marks.space_out_submobjects(1.1)\n",
        "        q_marks.shift(MED_SMALL_BUFF * RIGHT)\n",
        "        self.add(cos)\n",
        "        self.play(Write(q_marks))\n",
        "        self.wait()\n",
        "\n",
        "\n",
        "class OhLookAtTheTime(TeacherStudentsScene):\n",
        "    def construct(self):\n",
        "        morty = self.teacher\n",
        "        stds = self.students\n",
        "\n",
        "        morty.body.insert_n_curves(500)\n",
        "        # Test\n",
        "        self.play(\n",
        "            morty.change(\"raise_right_hand\"),\n",
        "            self.change_students(\"dejected\", \"tired\", \"pondering\", look_at=3 * UP)\n",
        "        )\n",
        "        self.wait(3)\n",
        "        self.play(\n",
        "            morty.change(\"hesitant\", 5 * UR),\n",
        "        )\n",
        "        self.play(self.change_students(\"tease\", \"well\", \"happy\"))\n",
        "        self.wait(3)\n",
        "        self.play(morty.change(\"raise_left_hand\", 5 * UR))\n",
        "        self.wait(3)\n",
        "\n",
        "\n",
        "class TimePassing(InteractiveScene):\n",
        "    def construct(self):\n",
        "        clock = Clock()\n",
        "        self.add(clock)\n",
        "        self.play(ClockPassesTime(clock, hours_passed=2, run_time=10))\n",
        "\n",
        "\n",
        "class DerivativeRule(InteractiveScene):\n",
        "    def construct(self):\n",
        "        # Test\n",
        "        t2c = {\"t\": BLUE, \"s\": YELLOW}\n",
        "        kw = dict(t2c=t2c, font_size=96)\n",
        "        in_texs = VGroup(\n",
        "            Tex(R\"x(t)\", **kw),\n",
        "            Tex(R\"x'(t)\", **kw),\n",
        "        )\n",
        "        out_texs = VGroup(\n",
        "            Tex(R\"X(s)\", **kw),\n",
        "            Tex(R\"s X(s) - x(0)\", **kw),\n",
        "        )\n",
        "        arrows = Vector(3 * RIGHT, thickness=7).replicate(2)\n",
        "\n",
        "        in_texs.arrange(DOWN, buff=2)\n",
        "        in_texs.to_edge(LEFT, buff=2)\n",
        "\n",
        "        for in_tex, arrow, output in zip(in_texs, arrows, out_texs):\n",
        "            arrow.next_to(in_tex, RIGHT)\n",
        "            output.next_to(arrow, RIGHT)\n",
        "            fancy_L = Tex(R\"\\mathcal{L}\")\n",
        "            fancy_L.next_to(arrow, UP, SMALL_BUFF)\n",
        "            arrow.add(fancy_L)\n",
        "\n",
        "        self.add(in_texs[0], arrows[0], out_texs[0])\n",
        "        self.wait()\n",
        "        self.play(\n",
        "            TransformMatchingTex(in_texs[0].copy(), in_texs[1]),\n",
        "            TransformMatchingTex(out_texs[0].copy(), out_texs[1]),\n",
        "            TransformFromCopy(*arrows),\n",
        "            run_time=1.5\n",
        "        )\n",
        "        self.wait()\n",
        "        SpeechBubble\n",
        "\n",
        "\n",
        "class EndScreen(SideScrollEndScreen):\n",
        "    pass"
    ]
}